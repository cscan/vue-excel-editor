(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vuedraggable"),require("xlsx"),require("moment")):"function"==typeof define&&define.amd?define(["exports","vuedraggable","xlsx","moment"],t):(e=e||self,t(e.VueExcelComponent={},e.vuedraggable,e.XLSX,e.moment))})(this,function(e,t,l,i){'use strict';var ye=Math.max,we=Math.abs,xe=Math.round,ke=Math.min,Ee=Math.floor;function a(e,t,l,i,a,o/* server only */,s,r,n,d){"boolean"!=typeof s&&(n=r,r=s,s=!1);// Vue.extend constructor export interop.
const c="function"==typeof l?l.options:l;// render functions
e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,a&&(c.functional=!0)),i&&(c._scopeId=i);let A;if(o?(A=function(e){e=e||// cached call
this.$vnode&&this.$vnode.ssrContext||// stateful
this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,n(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=A):t&&(A=s?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),A)if(c.functional){// register for functional component in vue file
const e=c.render;c.render=function(t,l){return A.call(l),e(t,l)}}else{// inject component registration as beforeCreate hook
const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,A):[A]}return l}function o(){return(e,t)=>s(e,t)}function s(e,t){const l=Be?t.media||"default":e,i=ze[l]||(ze[l]={ids:new Set,styles:[]});if(!i.ids.has(e)){i.ids.add(e);let l=t.source;if(t.map&&(l+="\n/*# sourceURL="+t.map.sources[0]+" */",l+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",t.media&&i.element.setAttribute("media",t.media),void 0===Te&&(Te=document.head||document.getElementsByTagName("head")[0]),Te.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(l),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{const e=i.ids.size-1,t=document.createTextNode(l),a=i.element.childNodes;a[e]&&i.element.removeChild(a[e]),a.length?i.element.insertBefore(t,a[e]):i.element.appendChild(t)}}}/* script */ /**
   * @name toDate
   * @category Common Helpers
   * @summary Convert the given argument to an instance of Date.
   *
   * @description
   * Convert the given argument to an instance of Date.
   *
   * If the argument is an instance of Date, the function returns its clone.
   *
   * If the argument is a number, it is treated as a timestamp.
   *
   * If the argument is none of the above, the function returns Invalid Date.
   *
   * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.
   *
   * @param {Date|Number} argument - the value to convert
   * @returns {Date} the parsed date in the local time zone
   * @throws {TypeError} 1 argument required
   *
   * @example
   * // Clone the date:
   * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))
   * //=> Tue Feb 11 2014 11:30:30
   *
   * @example
   * // Convert the timestamp to date:
   * const result = toDate(1392098430000)
   * //=> Tue Feb 11 2014 11:30:30
   */function r(e){if(1>arguments.length)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=Object.prototype.toString.call(e);// Clone the date
return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}function n(e){if(null===e||!0===e||!1===e)return NaN;var t=+e;return isNaN(t)?t:0>t?Math.ceil(t):Ee(t)}/**
   * @name startOfDay
   * @category Day Helpers
   * @summary Return the start of a day for the given date.
   *
   * @description
   * Return the start of a day for the given date.
   * The result will be in the local timezone.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the original date
   * @returns {Date} the start of a day
   * @throws {TypeError} 1 argument required
   *
   * @example
   * // The start of a day for 2 September 2014 11:55:00:
   * var result = startOfDay(new Date(2014, 8, 2, 11, 55, 0))
   * //=> Tue Sep 02 2014 00:00:00
   */function d(e){if(1>arguments.length)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=r(e);return t.setHours(0,0,0,0),t}/**
   * @name getDaysInMonth
   * @category Month Helpers
   * @summary Get the number of days in a month of the given date.
   *
   * @description
   * Get the number of days in a month of the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the given date
   * @returns {Number} the number of days in a month
   * @throws {TypeError} 1 argument required
   *
   * @example
   * // How many days are in February 2000?
   * var result = getDaysInMonth(new Date(2000, 1))
   * //=> 29
   */function c(e){if(1>arguments.length)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=r(e),l=t.getFullYear(),i=t.getMonth(),a=new Date(0);return a.setFullYear(l,i+1,0),a.setHours(0,0,0,0),a.getDate()}/**
   * @name addMonths
   * @category Month Helpers
   * @summary Add the specified number of months to the given date.
   *
   * @description
   * Add the specified number of months to the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the date to be changed
   * @param {Number} amount - the amount of months to be added
   * @returns {Date} the new date with the months added
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // Add 5 months to 1 September 2014:
   * var result = addMonths(new Date(2014, 8, 1), 5)
   * //=> Sun Feb 01 2015 00:00:00
   */function A(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=r(e),i=n(t),a=l.getMonth()+i,o=new Date(0);o.setFullYear(l.getFullYear(),a,1),o.setHours(0,0,0,0);var s=c(o);// Set the last day of the new month
// if the original date was the last day of the longer month
return l.setMonth(a,ke(s,l.getDate())),l}/**
   * @name addYears
   * @category Year Helpers
   * @summary Add the specified number of years to the given date.
   *
   * @description
   * Add the specified number of years to the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the date to be changed
   * @param {Number} amount - the amount of years to be added
   * @returns {Date} the new date with the years added
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // Add 5 years to 1 September 2014:
   * var result = addYears(new Date(2014, 8, 1), 5)
   * //=> Sun Sep 01 2019 00:00:00
   */function p(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=n(t);return A(e,12*l)}/**
   * @name differenceInCalendarMonths
   * @category Month Helpers
   * @summary Get the number of calendar months between the given dates.
   *
   * @description
   * Get the number of calendar months between the given dates.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} dateLeft - the later date
   * @param {Date|Number} dateRight - the earlier date
   * @returns {Number} the number of calendar months
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // How many calendar months are between 31 January 2014 and 1 September 2014?
   * var result = differenceInCalendarMonths(
   *   new Date(2014, 8, 1),
   *   new Date(2014, 0, 31)
   * )
   * //=> 8
   */function u(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=r(e),i=r(t),a=l.getFullYear()-i.getFullYear(),o=l.getMonth()-i.getMonth();return 12*a+o}/**
   * @name startOfMonth
   * @category Month Helpers
   * @summary Return the start of a month for the given date.
   *
   * @description
   * Return the start of a month for the given date.
   * The result will be in the local timezone.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the original date
   * @returns {Date} the start of a month
   * @throws {TypeError} 1 argument required
   *
   * @example
   * // The start of a month for 2 September 2014 11:55:00:
   * var result = startOfMonth(new Date(2014, 8, 2, 11, 55, 0))
   * //=> Mon Sep 01 2014 00:00:00
   */function h(e){if(1>arguments.length)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=r(e);return t.setDate(1),t.setHours(0,0,0,0),t}/**
   * @name startOfYear
   * @category Year Helpers
   * @summary Return the start of a year for the given date.
   *
   * @description
   * Return the start of a year for the given date.
   * The result will be in the local timezone.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the original date
   * @returns {Date} the start of a year
   * @throws {TypeError} 1 argument required
   *
   * @example
   * // The start of a year for 2 September 2014 11:55:00:
   * var result = startOfYear(new Date(2014, 8, 2, 11, 55, 00))
   * //=> Wed Jan 01 2014 00:00:00
   */function f(e){if(1>arguments.length)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=r(e),l=new Date(0);return l.setFullYear(t.getFullYear(),0,1),l.setHours(0,0,0,0),l}/**
   * @name setMonth
   * @category Month Helpers
   * @summary Set the month to the given date.
   *
   * @description
   * Set the month to the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the date to be changed
   * @param {Number} month - the month of the new date
   * @returns {Date} the new date with the month set
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // Set February to 1 September 2014:
   * var result = setMonth(new Date(2014, 8, 1), 1)
   * //=> Sat Feb 01 2014 00:00:00
   */function g(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=r(e),i=n(t),a=l.getFullYear(),o=l.getDate(),s=new Date(0);s.setFullYear(a,i,15),s.setHours(0,0,0,0);var d=c(s);// Set the last day of the new month
// if the original date was the last day of the longer month
return l.setMonth(i,ke(o,d)),l}/**
   * @name setYear
   * @category Year Helpers
   * @summary Set the year to the given date.
   *
   * @description
   * Set the year to the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the date to be changed
   * @param {Number} year - the year of the new date
   * @returns {Date} the new date with the year set
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // Set year 2013 to 1 September 2014:
   * var result = setYear(new Date(2014, 8, 1), 2013)
   * //=> Sun Sep 01 2013 00:00:00
   */function m(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=r(e),i=n(t);// Check if date is Invalid Date because Date.prototype.setFullYear ignores the value of Invalid Date
return isNaN(l)?new Date(NaN):(l.setFullYear(i),l)}/**
   * @name subMonths
   * @category Month Helpers
   * @summary Subtract the specified number of months from the given date.
   *
   * @description
   * Subtract the specified number of months from the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the date to be changed
   * @param {Number} amount - the amount of months to be subtracted
   * @returns {Date} the new date with the months subtracted
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // Subtract 5 months from 1 February 2015:
   * var result = subMonths(new Date(2015, 1, 1), 5)
   * //=> Mon Sep 01 2014 00:00:00
   */function v(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=n(t);return A(e,-l)}/**
   * @name subYears
   * @category Year Helpers
   * @summary Subtract the specified number of years from the given date.
   *
   * @description
   * Subtract the specified number of years from the given date.
   *
   * ### v2.0.0 breaking changes:
   *
   * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).
   *
   * @param {Date|Number} date - the date to be changed
   * @param {Number} amount - the amount of years to be subtracted
   * @returns {Date} the new date with the years subtracted
   * @throws {TypeError} 2 arguments required
   *
   * @example
   * // Subtract 5 years from 1 September 2014:
   * var result = subYears(new Date(2014, 8, 1), 5)
   * //=> Tue Sep 01 2009 00:00:00
   */function b(e,t){if(2>arguments.length)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var l=n(t);return p(e,-l)}function C(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function y(){return y=Object.assign||function(e){for(var t=1,l;t<arguments.length;t++)for(var a in l=arguments[t],l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);return e},y.apply(this,arguments)}function w(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,i)}return l}function x(e){for(var t=1,l;t<arguments.length;t++)l=null==arguments[t]?{}:arguments[t],t%2?w(l,!0).forEach(function(t){C(e,t,l[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):w(l).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))});return e}function k(e,t){return E(e)||S(e,t)||B()}function E(e){if(Array.isArray(e))return e}function S(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var l=[],i=!0,a=!1,o=void 0;try{for(var s=e[Symbol.iterator](),r;!(i=(r=s.next()).done)&&(l.push(r.value),!(t&&l.length===t));i=!0);}catch(e){a=!0,o=e}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw o}}return l}}function B(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function T(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function z(e){return T(e)?new Date(e.getTime()):null==e?new Date(NaN):new Date(e)}function P(e){return T(e)&&!isNaN(e.getTime())}function F(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!(0<=t&&6>=t))throw new RangeError("weekStartsOn must be between 0 and 6");var l=z(e),i=l.getDay();return l.setDate(l.getDate()-(i+7-t)%7),l.setHours(0,0,0,0),l}function L(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},l=t.firstDayOfWeek,a=void 0===l?0:l,o=t.firstWeekContainsDate,s=void 0===o?1:o;if(!(1<=s&&7>=s))throw new RangeError("firstWeekContainsDate must be between 1 and 7");for(var r=z(e),n=r.getFullYear(),d=new Date(0),c=n+1;c>=n-1&&(d.setFullYear(c,0,s),d.setHours(0,0,0,0),d=F(d,a),!(r.getTime()>=d.getTime()));c--);return d}function D(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},l=t.firstDayOfWeek,i=void 0===l?0:l,a=t.firstWeekContainsDate,o=void 0===a?1:a,s=z(e),r=F(s,i),n=L(s,{firstDayOfWeek:i,firstWeekContainsDate:o}),d=r.getTime()-n.getTime();return xe(d/604800000)+1}function M(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,l="".concat(we(e)),i=0>e?"-":"";l.length<t;)l="0".concat(l);return i+l}function R(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",l=0<e?"-":"+",i=we(e),a=Ee(i/60);return l+M(a,2)+t+M(i%60,2)}function V(e,t){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},i=t?t+"":"YYYY-MM-DDTHH:mm:ss.SSSZ",a=z(e);if(!P(a))return"Invalid Date";var o=l.locale||Oe;return i.replace(Ue,function(e,t){return t?t:"function"==typeof Ye[e]?"".concat(Ye[e](a,o)):e})}function $(e){return I(e)||H(e)||_()}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function H(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function I(e){if(Array.isArray(e)){for(var t=0,l=Array(e.length);t<e.length;t++)l[t]=e[t];return l}}function O(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,i)}return l}function U(e){for(var t=1,l;t<arguments.length;t++)l=null==arguments[t]?{}:arguments[t],t%2?O(l,!0).forEach(function(t){K(e,t,l[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):O(l).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))});return e}function W(e,t){return N(e)||q(e,t)||Y()}function Y(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function q(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var l=[],i=!0,a=!1,o=void 0;try{for(var s=e[Symbol.iterator](),r;!(i=(r=s.next()).done)&&(l.push(r.value),!(t&&l.length===t));i=!0);}catch(e){a=!0,o=e}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw o}}return l}}function N(e){if(Array.isArray(e))return e}function K(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function X(e){return"p"==="".concat(e).toLowerCase().charAt(0)}function j(e){var t=e.match(/([+-]|\d\d)/g)||["-","0","0"],l=W(t,3),i=l[0],a=l[1],o=l[2],s=60*parseInt(a,10)+parseInt(o,10);return 0===s?0:"+"===i?-s:+s}function Q(e,t){if(e!==void 0&&t!==void 0)if(t){if(12>e)return e+12;}else if(12===e)return 0;return e}function G(e){for(var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:new Date,l=[0,0,1,0,0,0,0],a=[t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()],o=!0,s=0;7>s;s++)void 0===e[s]?l[s]=o?a[s]:l[s]:(l[s]=e[s],o=!1);return l}function J(){for(var e=arguments.length,t=Array(e),l=0,i;l<e;l++)t[l]=arguments[l];var a=t[0];return 100>a&&0<=a?(t[0]+=400,i=new Date(Date.UTC.apply(Date,t)),isFinite(i.getUTCFullYear())&&i.setUTCFullYear(a)):i=new Date(Date.UTC.apply(Date,t)),i}function Z(e,t,l){var a=t.match(qe);if(!a)throw new Error;for(var o=a.length,s={},r=0;r<o;r+=1){var n=a[r],d=nt[n];if(!d){var c=n.replace(/^\[|\]$/g,"");if(0===e.indexOf(c))e=e.substr(c.length);else throw new Error("not match")}else{var A="function"==typeof d[0]?d[0](l):d[0],p=d[1],u=(A.exec(e)||[])[0],h=p(u,l);s=U({},s,{},h),e=e.replace(u,"")}}return s}function ee(e,t){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};try{var i=l.locale,a=void 0===i?Oe:i,o=l.backupDate,s=void 0===o?new Date:o,r=Z(e,t,a),n=r.year,d=r.month,c=r.day,A=r.hour,p=r.minute,u=r.second,h=r.millisecond,f=r.isPM,g=r.date,m=r.offset,v=r.weekday,b=r.week;if(g)return g;var C=[n,d,c,A,p,u,h];// check week
if(C[3]=Q(C[3],f),void 0!==b&&void 0===d&&void 0===c){// new Date(year, 3) make sure in current year
var y=L(void 0===n?s:new Date(n,3),{firstDayOfWeek:a.firstDayOfWeek,firstWeekContainsDate:a.firstWeekContainsDate});return new Date(y.getTime()+1e3*(3600*(24*(7*(b-1)))))}var w=J.apply(void 0,$(G(C,s))),x=1e3*(60*(void 0===m?w.getTimezoneOffset():m)),k=new Date(w.getTime()+x);// check weekday
return void 0!==v&&k.getDay()!==v?new Date(NaN):k}catch(t){return new Date(NaN)}}// new Date(10, 0, 1) The year from 0 to 99 will be incremented by 1900 automatically.
function te(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,r=new Date(e,t,l,i,a,o,s);return 100>e&&0<=e&&r.setFullYear(e),r}function le(e){return e instanceof Date&&!isNaN(e)}function ie(e){return Array.isArray(e)&&2===e.length&&e.every(le)&&e[0]<=e[1]}function ae(e){for(var t=new Date(e),l=arguments.length,i=Array(1<l?l-1:0),a=1;a<l;a++)i[a-1]=arguments[a];return le(t)?t:ae.apply(void 0,i)}function oe(e,t){var l=new Date(e),i=new Date(t);return l.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),l}/**
   * chunk the array
   * @param {Array} arr
   * @param {Number} size
   */function se(e,t){if(!Array.isArray(e))return[];var l=[],a=e.length,o=0;for(t=t||a;o<a;)l.push(e.slice(o,o+=t));return l}/**
   * isObject
   * @param {*} obj
   * @returns {Boolean}
   */function re(e){return"[object Object]"===Object.prototype.toString.call(e)}/**
   * pick object
   * @param {Object} obj
   * @param {Array|String} props
   */function ne(e,t){if(!re(e))return{};Array.isArray(t)||(t=[t]);var l={};return t.forEach(function(t){t in e&&(l[t]=e[t])}),l}/**
   * deep merge two object without merging array
   * @param {object} target
   * @param {object} source
   */function de(e,t){if(!re(e))return{};var l=e;return re(t)&&Object.keys(t).forEach(function(i){var a=t[i];re(a)&&re(e[i])&&(a=de(e[i],a)),l=x({},l,C({},i,a))}),l}function ce(e,t,i){if("string"!=typeof e)return ht[ut];var a=ut;return ht[e]&&(a=e),t&&(ht[e]=t,a=e),i||(ut=a),ht[e]||ht[ut]}/**
   * get locale object
   * @param {string} name lang
   */function Ae(e){return ce(e,null,!0)}/**
   * get locale field value
   * @param {string} field field eg: 'formatLocale.shortMonth'
   * @param {object} lang locale object
   */function pe(e,t){for(var l=(e||"").split("."),a=t||Ae(),o=0,s=l.length,r,n;o<s;o++){if(n=l[o],r=a[n],o==s-1)return r;if(!r)return null;a=r}return null}/* istanbul ignore file */function ue(e){var t=!1;return function(){for(var l=this,i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];t||(t=!0,requestAnimationFrame(function(){t=!1,e.apply(l,a)}))}}/**
   * get the hidden element width, height
   * @param {HTMLElement} element dom
   */function he(e){var t=e.style.display,l=e.style.visibility;e.style.display="block",e.style.visibility="hidden";var i=window.getComputedStyle(e),a=e.offsetWidth+parseInt(i.marginLeft,10)+parseInt(i.marginRight,10),o=e.offsetHeight+parseInt(i.marginTop,10)+parseInt(i.marginBottom,10);return e.style.display=t,e.style.visibility=l,{width:a,height:o}}/**
   * get the popup position
   * @param {HTMLElement} el relative element
   * @param {Number} targetWidth target element's width
   * @param {Number} targetHeight target element's height
   * @param {Boolean} fixed
   */function fe(e,t,l,i){var a=0,o=0,s=0,r=0,n=e.getBoundingClientRect(),d=document.documentElement.clientWidth,c=document.documentElement.clientHeight;return i&&(s=window.pageXOffset+n.left,r=window.pageYOffset+n.top),a=d-n.left<t&&n.right<t?s-n.left+1:n.left+n.width/2<=d/2?s:s+n.width-t,o=n.top<=l&&c-n.bottom<=l?r+c-n.top-l:n.top+n.height/2<=c/2?r+n.height:r-l,{left:"".concat(a,"px"),top:"".concat(o,"px")}}function ge(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:document;return e&&e!==t?e.scrollHeight>e.clientHeight?e:ge(e.parentNode,t):null}function me(e,t,l,i,a,o/* server only */,s,r,n,d){"boolean"!=typeof s&&(n=r,r=s,s=!1);// Vue.extend constructor export interop.
var c="function"==typeof l?l.options:l;// render functions
e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,a&&(c.functional=!0)),i&&(c._scopeId=i);var A;if(o?(A=function(e){e=e||// cached call
this.$vnode&&this.$vnode.ssrContext||// stateful
this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,n(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=A):t&&(A=s?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),A)if(c.functional){// register for functional component in vue file
var p=c.render;c.render=function(e,t){return A.call(t),p(e,t)}}else{// inject component registration as beforeCreate hook
var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,A):[A]}return l}function ve(){if("undefined"==typeof window)return 0;if(void 0!==Jt)return Jt;var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=document.createElement("div");return t.style.width="100%",e.appendChild(t),Jt=e.offsetWidth-t.offsetWidth,e.parentNode.removeChild(e),Jt}//
//
function be(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",t=e.split(":");if(2<=t.length){var l=parseInt(t[0],10),i=parseInt(t[1],10);return{hours:l,minutes:i}}return null}function Ce(){return Ce=Object.assign||function(e){for(var t=1,l;t<arguments.length;t++)for(var i in l=arguments[t],l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);return e},Ce.apply(this,arguments)}t=t&&t.hasOwnProperty("default")?t["default"]:t,l=l&&l.hasOwnProperty("default")?l["default"]:l,i=i&&i.hasOwnProperty("default")?i["default"]:i;//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
var Se={props:{value:{type:String,default:""},interactive:{type:Boolean,default:!1}},data(){return{uid:"",table:null,cell:null,row:null,colPos:0,rect:null}},computed:{listeners(){return{...this.$listeners,input:this.onInput}},err(){return this.validate?this.validate(this.value):""},filterRowTop(){return this.cell?{top:this.cell.offsetTop+"px"}:{}}},watch:{value(e){e!==this.$el.textContent&&(this.$refs.cell.textContent=e)}},mounted(){// remember the first value
// Convert the value into html
// Store the DOM neighbour
this.uid="uid"+this._uid,this.cell=this.$refs.cell,this.cell.textContent=this.value,this.row=this.cell.parentNode,this.thead=this.row.parentNode,this.colPos=Array.from(this.row.children).indexOf(this.cell)-1,this.colLabel=this.thead.children[0].children[this.colPos+1]},methods:{updateValue(t){const e=t.target.textContent;this.value!==e&&this.$emit("input",e)},onInput(t){this.interactive&&this.updateValue(t)},onFocus(){setTimeout(()=>{this.colLabel.classList.add("focus"),document.execCommand("selectAll",!1,null),this.$parent.currentColPos=this.colPos,this.$parent.currentRowPos=-1,this.$parent.labelTr.children[this.$parent.currentColPos+1].classList.add("focus")},0)},onBlur(t){this.updateValue(t),this.colLabel.classList.remove("focus"),t.target.classList.remove("edit")},keyWest(t){const e=document.getSelection();if(t.target.textContent===e.toString()||0===e.focusOffset){let e=t.target.previousSibling;return(e&&e.style&&"none"===e.style.display&&(e=e.previousSibling),!e)?e:(e.tagName||(e=e.previousSibling),e.focus&&e.focus(),e)}},keyEast(t){const e=document.getSelection();if(t.target.textContent===e.toString()||e.focusOffset>=t.target.textContent.length){let e=t.target.nextSibling;return(e&&e.style&&"none"===e.style.display&&(e=e.nextSibling),!e)?e:(e.tagName||(e=e.nextSibling),e.focus&&e.focus(),e)}return t.target},keyEnter(t){// if (!this.$parent.keyEast(e))
t.preventDefault(),document.execCommand("selectAll",!1,null),this.updateValue(t)},keyDelete(t){""===t.target.textContent&&setTimeout(this.updateValue(t),0)},mouseMove(t){this.cell.style.cursor=15>this.cell.offsetWidth-t.offsetX?"pointer":"text"},mouseDown(t){0===t.button&&15>this.cell.offsetWidth-t.offsetX&&(t.preventDefault(),setTimeout(()=>{// this.$parent.showFilterPanel(this)
this.$parent.$refs.panelFilter.showPanel(this)},0))}}};const Be="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());let Te;const ze={};/* template */var Pe=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("td",e._g({ref:"cell",staticClass:"cell column-filter",style:e.filterRowTop,attrs:{id:e.uid,contenteditable:"",ondragenter:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",ondragover:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},on:{focus:e.onFocus,blur:e.onBlur,keydown:[function(t){return t.type.indexOf("key")||37===t.keyCode?t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyWest(t):null},function(t){return t.type.indexOf("key")||39===t.keyCode?t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyEast(t):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyEnter(t)}],keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyDelete(t)},mousemove:e.mouseMove,mousedown:e.mouseDown}},e.listeners))};Pe._withStripped=!0;/* style */const Fe=a({render:Pe,staticRenderFns:[]},function(e){e&&e("data-v-5c277c28_0",{source:"\n.column-filter[data-v-5c277c28] {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAABuCAMAAAAwApxlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE4UExURQAAAAAAAICAgFVVVUBAQICAgGZmZoCAgJKSko6OjmZmZoCAgHZ2doCAgIiIiHh4eIeHh4CAgHl5eXl5eYaGhoWFhYCAgIWFhXt7e4SEhIODg4CAgICAgH19fYKCgoCAgISEhIKCgn19fX19fYKCgoCAgH5+foGBgX5+foCAgHx8fH19fYCAgH5+foCAgHx8fH5+fn5+foGBgYCAgH5+fn5+foCAgIODg4CAgIGBgYODg3x8fICAgIGBgYCAgICAgH9/f39/f4CAgH9/f4CAgICAgH9/f4CAgIGBgYSEhIODg39/f4CAgH9/f4CAgICAgICAgH9/f4CAgH5+fn9/f35+foCAgIKCgoSEhIODg39/f4CAgIKCgoSEhH9/f4GBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiW6rGxQAAABedFJOUwABAgMEBAUGBwkKCg0ODxEREhMVFRcYGRsfJSowMTE0NDU7Pz9CQ0VNUFReXl9gZ2ttb3BxdXh5fH19f4CAgoWLkZqbnqChoaSkqqurra28wsXFydXW1tbq7u/x+fuJeTf3AAAACXBIWXMAABbqAAAW6gHljkMQAAABFUlEQVRoQ+3X11LCUBSF4RAEVFCwYEXFgr0g9gLYexcbahLDOcn7v4HArGfYmWHWd7X/q3O39xyDiIiIiIiIiIgoKOHORLwNs7DuhVK5tDyEkrX45Svv9wAla8e3LEvd9CElmXu6/nbtIY0WtaEcx9EXHUhRmdv3t8rjPEpYOjc3O4yZqFWlxrOZILZa3cjx88vTySRKVl65f653GkVKihS95j4fQEsy95t37K4fLWrpR9eUexRCihosXJ6dH46ihMWSval2zEQtyhzLb65PhVGyZl6r39XKKkrWlmfbtneVQEqKFBt/A/c+iFsS2m3cMX3dhRaV+/C1/7mGkhWfWNkuTPegxEVjGIiIiIiIiIiIiIJlGP8KtCi1NMvKyQAAAABJRU5ErkJggg==');\n  background-repeat: no-repeat;\n  background-size: 36px;\n  background-position: right -12px top -1px;\n}\n\n",map:{version:3,sources:["/Users/can/vuejs/hello-world/plugins/VueExcelEditor/src/VueExcelFilter.vue"],names:[],mappings:";AAkJA;EACA,+mCAAA;EACA,4BAAA;EACA,qBAAA;EACA,yCAAA;AACA",file:"VueExcelFilter.vue",sourcesContent:["<template>\n  <td\n    :id=\"uid\"\n    ref=\"cell\"\n    contenteditable\n    ondragenter=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\n    ondragover=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\n    class=\"cell column-filter\"\n    :style=\"filterRowTop\"\n    autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\n    v-on=\"listeners\"\n    @focus=\"onFocus\"\n    @blur=\"onBlur\"\n    @keydown.exact.37=\"keyWest\"\n    @keydown.exact.39=\"keyEast\"\n    @keydown.exact.enter=\"keyEnter\"\n    @keyup.exact.delete=\"keyDelete\"\n    @mousemove=\"mouseMove\"\n    @mousedown=\"mouseDown\" />\n</template>\n\n<script>\nexport default {\n  props: {\n    value: {type: String, default: ''},\n    interactive: {type: Boolean, default: false}\n  },\n  data () {\n    return {\n      uid: '',\n      table: null,\n      cell: null,\n      row: null,\n      colPos: 0,\n      rect: null\n    }\n  },\n  computed: {\n    listeners () {\n      return {\n        ...this.$listeners, input: this.onInput\n      }\n    },\n    err () {\n      if (this.validate)\n        return this.validate(this.value)\n      return ''\n    },\n    filterRowTop () {\n      if (this.cell) return {top: this.cell.offsetTop + 'px'}\n      else return {}\n    },\n  },\n  watch: {\n    value (newVal) {\n      if (newVal !== this.$el.textContent)\n        this.$refs.cell.textContent = newVal\n    }\n  },\n  mounted () {\n    this.uid = 'uid' + this._uid\n    // remember the first value\n\n    // Convert the value into html\n    this.cell = this.$refs.cell\n    this.cell.textContent = this.value\n\n    // Store the DOM neighbour\n    this.row = this.cell.parentNode\n    this.thead = this.row.parentNode\n    this.colPos = Array.from(this.row.children).indexOf(this.cell) - 1\n    this.colLabel = this.thead.children[0].children[this.colPos + 1]\n  },\n  methods: {\n    updateValue (e) {\n      const content = e.target.textContent\n      if (this.value !== content)\n        this.$emit('input', content)\n    },\n    onInput (e) {\n      if (this.interactive)\n        this.updateValue(e)\n    },\n    onFocus () {\n      setTimeout(() => {\n        this.colLabel.classList.add('focus')\n        document.execCommand('selectAll', false, null)\n        this.$parent.currentColPos = this.colPos\n        this.$parent.currentRowPos = -1\n        this.$parent.labelTr.children[this.$parent.currentColPos + 1].classList.add('focus')\n      }, 0)\n    },\n    onBlur (e) {\n      this.updateValue(e)\n      this.colLabel.classList.remove('focus')\n      e.target.classList.remove('edit')\n    },\n    keyWest (e) {\n      const sel = document.getSelection()\n      if (e.target.textContent === sel.toString() || sel.focusOffset === 0) {\n        let td = e.target.previousSibling\n        if (td && td.style && td.style.display === 'none') td = td.previousSibling\n        if (!td) return td\n        if (!td.tagName) td = td.previousSibling\n        if (td.focus) td.focus()\n        return td\n      }\n    },\n    keyEast (e) {\n      const sel = document.getSelection()\n      if (e.target.textContent === sel.toString() || sel.focusOffset >= e.target.textContent.length) {\n        let td = e.target.nextSibling\n        if (td && td.style && td.style.display === 'none') td = td.nextSibling\n        if (!td) return td\n        if (!td.tagName) td = td.nextSibling\n        if (td.focus) td.focus()\n        return td\n      }\n      return e.target\n    },\n    keyEnter (e) {\n      e.preventDefault()\n      document.execCommand('selectAll', false, null)\n      // if (!this.$parent.keyEast(e))\n      this.updateValue(e)\n    },\n    keyDelete (e) {\n      if (e.target.textContent === '')\n        setTimeout(this.updateValue(e), 0)\n    },\n    mouseMove (e) {\n      this.cell.style.cursor = this.cell.offsetWidth - e.offsetX < 15 ? 'pointer' : 'text'\n    },\n    mouseDown (e) {\n      if (e.button === 0 && this.cell.offsetWidth - e.offsetX < 15) {\n        e.preventDefault()\n        setTimeout(() => {\n          // this.$parent.showFilterPanel(this)\n          this.$parent.$refs.panelFilter.showPanel(this)\n        }, 0)\n      }\n    }\n  }\n}\n</script>\n<style scoped>\n.column-filter {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAABuCAMAAAAwApxlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE4UExURQAAAAAAAICAgFVVVUBAQICAgGZmZoCAgJKSko6OjmZmZoCAgHZ2doCAgIiIiHh4eIeHh4CAgHl5eXl5eYaGhoWFhYCAgIWFhXt7e4SEhIODg4CAgICAgH19fYKCgoCAgISEhIKCgn19fX19fYKCgoCAgH5+foGBgX5+foCAgHx8fH19fYCAgH5+foCAgHx8fH5+fn5+foGBgYCAgH5+fn5+foCAgIODg4CAgIGBgYODg3x8fICAgIGBgYCAgICAgH9/f39/f4CAgH9/f4CAgICAgH9/f4CAgIGBgYSEhIODg39/f4CAgH9/f4CAgICAgICAgH9/f4CAgH5+fn9/f35+foCAgIKCgoSEhIODg39/f4CAgIKCgoSEhH9/f4GBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiW6rGxQAAABedFJOUwABAgMEBAUGBwkKCg0ODxEREhMVFRcYGRsfJSowMTE0NDU7Pz9CQ0VNUFReXl9gZ2ttb3BxdXh5fH19f4CAgoWLkZqbnqChoaSkqqurra28wsXFydXW1tbq7u/x+fuJeTf3AAAACXBIWXMAABbqAAAW6gHljkMQAAABFUlEQVRoQ+3X11LCUBSF4RAEVFCwYEXFgr0g9gLYexcbahLDOcn7v4HArGfYmWHWd7X/q3O39xyDiIiIiIiIiIgoKOHORLwNs7DuhVK5tDyEkrX45Svv9wAla8e3LEvd9CElmXu6/nbtIY0WtaEcx9EXHUhRmdv3t8rjPEpYOjc3O4yZqFWlxrOZILZa3cjx88vTySRKVl65f653GkVKihS95j4fQEsy95t37K4fLWrpR9eUexRCihosXJ6dH46ihMWSval2zEQtyhzLb65PhVGyZl6r39XKKkrWlmfbtneVQEqKFBt/A/c+iFsS2m3cMX3dhRaV+/C1/7mGkhWfWNkuTPegxEVjGIiIiIiIiIiIiIJlGP8KtCi1NMvKyQAAAABJRU5ErkJggg==');\n  background-repeat: no-repeat;\n  background-size: 36px;\n  background-position: right -12px top -1px;\n}\n\n</style>\n"]},media:void 0})},Se,"data-v-5c277c28",!1,void 0,!1,o,void 0,void 0);/* scoped */ //
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
var Le={props:{nFilterCount:{type:Number,default:200},// show top n values in filter dialog
localizedLabel:{type:Object,default(){return{sortingAndFiltering:"Sorting And Filtering",sortAscending:"Sort Ascending",sortDescending:"Sort Descending",near:"\u2252 Near",exactMatch:"= Exact Match",greaterThan:"&gt; Greater Than",greaterThanOrEqualTo:"\u2265 Greater Than or Equal To",lessThan:"&lt; Less Than",lessThanOrEqualTo:"\u2264 Less Than Or Equal To",regularExpression:"~ Regular Expression",customFilter:"Custom Filter",listFirstNValuesOnly:e=>`List first ${e} values only`,apply:"Apply"}}}},data(){return{show:!1,showDropdown:!1,processing:!1,columnFilterRef:null,inputFilter:"",inputFilterCondition:"",sortedUniqueValueList:[]}},computed:{filteredSortedUniqueValueList(){const e=this.inputFilter.toUpperCase();return this.sortedUniqueValueList.filter(t=>t.toUpperCase().startsWith(e))},symbol(){switch(this.inputFilterCondition){case"":return"\u2252";case"<=":return"\u2264";case">=":return"\u2265";default:return this.inputFilterCondition;}}},methods:{clickOutside(t){"panelModal"===t.target.id&&this.hidePanel()},sort(e){this.hidePanel(),this.$parent.sort(e,this.columnFilterRef.colPos)},setFilterCondition(e){this.showDropdown=!1,this.inputFilterCondition=e,this.$refs.inputFilter.focus()},freezePanelSizeAfterShown(){const e=this.$refs.panelList,t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},removePanelSizeAfterHide(){const e=this.$refs.panelList;e.removeAttribute("style")},doInputFilter(){window.delay&&clearTimeout(window.delay),window.delay=setTimeout(()=>{this.inputFilter=this.$refs.inputFilter.value},200)},doFilter(){const e=this.inputFilterCondition+this.$refs.inputFilter.value;this.columnFilterRef.$el.textContent=e,this.columnFilterRef.$emit("input",e),this.hidePanel()},filterPanelSelect(e){// this.columnFilter[this.columnFilterRef.colPos] = el  // Cannot use this, dunno why
this.columnFilterRef.$el.textContent="="+e,this.columnFilterRef.$emit("input","="+e),this.hidePanel()},showPanel(e){this.columnFilterRef=e,this.inputFilter="",this.inputFilterCondition="",this.sortedUniqueValueList=[],this.$refs.inputFilter.value="",this.show=!0,this.columnFilterRef.$el.textContent="",this.columnFilterRef.$emit("input",""),setTimeout(()=>this.$refs.inputFilter.focus());const t={},l=this.$parent.fields[e.colPos].name;this.$parent.table.forEach(e=>t[e[l]]=!0);const i=Object.keys(t);i.sort(),0<i.length&&""===i[0]&&(i[0]=" "),this.sortedUniqueValueList=i,setTimeout(()=>this.freezePanelSizeAfterShown())},hidePanel(){this.show=!1,this.removePanelSizeAfterHide(),setTimeout(()=>{this.sortedUniqueValueList=[]},0)}}};/* script */ /* template */var De=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"panel-modal",attrs:{id:"panelModal"},on:{click:e.clickOutside,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.hidePanel(t)}}},[l("div",{ref:"panelFilter",staticClass:"panel-body"},[l("div",{staticClass:"panel-title"},[l("svg",{staticClass:"svg-inline--fa fa-sort-amount-down fa-w-16 fa-1x",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-amount-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M304 416h-64a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-128-64h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.37 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm256-192H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h192a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-64 128H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM496 32H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h256a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.sortingAndFiltering)}})]),e._v(" "),l("div",{staticClass:"panel-content"},[l("div",{staticClass:"panel-action"},[l("button",{staticClass:"panel-button float-left",on:{click:function(){return e.sort(1)}}},[l("svg",{staticClass:"svg-inline--fa fa-sort-alpha-down fa-w-14",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-alpha-down",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.sortAscending)}})]),e._v(" "),l("button",{staticClass:"panel-button float-right",on:{click:function(){return e.sort(-1)}}},[l("svg",{staticClass:"svg-inline--fa fa-sort-alpha-up-alt fa-w-14",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sort-alpha-up-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M16 160h48v304a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V160h48c14.21 0 21.38-17.24 11.31-27.31l-80-96a16 16 0 0 0-22.62 0l-80 96C-5.35 142.74 1.78 160 16 160zm272 64h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 65.63V48a16 16 0 0 0-16-16H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 190.37V208a16 16 0 0 0 16 16zm159.06 234.62l-59.27-160A16 16 0 0 0 372.72 288h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 480h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 480H432a16 16 0 0 0 15.06-21.38zM335.61 400L352 352l16.39 48z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.sortDescending)}})])]),e._v(" "),l("div",{staticClass:"panel-action"},[l("div",[l("button",{staticClass:"panel-input-button",on:{click:function(){e.showDropdown=!e.showDropdown}}},[e._v(e._s(e.symbol))]),e._v(" "),l("div",{staticClass:"panel-dropdown",class:{show:e.showDropdown}},[l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.near)}})]),e._v(" "),l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("=")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.exactMatch)}})]),e._v(" "),l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition(">")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.greaterThan)}})]),e._v(" "),l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition(">=")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.greaterThanOrEqualTo)}})]),e._v(" "),l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("<")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.lessThan)}})]),e._v(" "),l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("<=")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.lessThanOrEqualTo)}})]),e._v(" "),l("div",{staticClass:"panel-dropdown-item",on:{click:function(t){return t.preventDefault(),e.setFilterCondition("~")}}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.regularExpression)}})])]),e._v(" "),l("span",{staticClass:"panel-input-b"},[l("input",{ref:"inputFilter",staticClass:"panel-input",attrs:{type:"text",placeholder:e.localizedLabel.customFilter,trim:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},on:{keyup:e.doInputFilter,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.doFilter(t)}}})])])]),e._v(" "),l("div",[l("div",{ref:"panelList",staticClass:"panel-list"},e._l(e.filteredSortedUniqueValueList.slice(0,e.nFilterCount),function(t,i){return l("div",{key:i,staticClass:"panel-list-item",on:{click:function(l){return l.preventDefault(),e.filterPanelSelect(t)}}},[l("input",{staticClass:"panel-checkbox",attrs:{type:"checkbox"}}),e._v(" "),l("span",[e._v(e._s(t))])])}),0),e._v(" "),500<e.filteredSortedUniqueValueList.length?l("div",{staticClass:"normal-text",staticStyle:{float:"right"}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.listFirstNValuesOnly(e.nFilterCount))}})]):e._e()])]),e._v(" "),l("div",{staticClass:"panel-footer"},[l("button",{staticClass:"panel-button",on:{click:e.doFilter}},[l("svg",{staticClass:"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"sign-in-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.apply)}})])])])])};De._withStripped=!0;/* style */const Me=a({render:De,staticRenderFns:[]},function(e){e&&e("data-v-36364a03_0",{source:"\ninput[data-v-36364a03]:focus, button[data-v-36364a03]:focus {\n  outline: none !important;\n  box-shadow: none !important;\n}\n.panel-modal[data-v-36364a03] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #0007;\n  z-index: 999;\n  font-weight: 400;\n  font-size: 1rem;\n  text-shadow: none;\n}\n.panel-body[data-v-36364a03] {\n  background-color: white;\n  position: fixed;\n  border-radius: 5px;\n  padding: 0;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 28rem;\n  max-width: 75vh;\n  height: fit-content;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n}\n.panel-title[data-v-36364a03] {\n  padding: 1rem;\n  display: flex;\n  color: dimgray;\n  font-size: 1.25rem;\n  line-height: 1.5rem;\n  align-items: center;\n  justify-content: flex-start;\n  border-bottom: 1px solid lightgray;\n}\ndiv.panel-title span[data-v-36364a03], button.panel-button span[data-v-36364a03] {\n  margin-left: 6px;\n}\n.panel-content[data-v-36364a03] {\n  padding: 1rem;\n  text-align: left;\n  overflow-y: scroll;\n}\n.panel-content .panel-button[data-v-36364a03] {\n  width: 48%;\n  background-color: #17a2b8;\n}\n.panel-action[data-v-36364a03] {\n  display: inline-block;\n  margin-bottom: 0.5rem;\n  width: 100%;\n  position: relative;\n  white-space: nowrap;\n}\n.panel-input-b[data-v-36364a03] {\n  display: inline-block;\n  border-top-right-radius: 4px;\n  border-bottom-right-radius: 4px;\n  width: calc(100% - 2.2rem);\n  border: 1px solid lightgray;\n  border-left: 0;\n  margin-left: -4px;\n  height: 2.3rem;\n}\n.panel-input[data-v-36364a03] {\n  border: 0;\n  box-shadow: none;\n  padding: 0.6rem;\n  width: calc(100% - 2.2rem);\n  font-size: 0.88rem;\n  background-color: transparent;\n}\n.panel-input-button[data-v-36364a03] {\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n  color: white;\n  background-color: #28a745;\n  border: 1px solid #28a745;\n  font-size: 1.3rem;\n  width: 2.2rem;\n  height: 2.35rem;\n  vertical-align: -2px;\n  cursor: pointer;\n}\n.panel-dropdown[data-v-36364a03] {\n  z-index: 50;\n  position: absolute;\n  left: 0;\n  top: 2.4rem;\n  display: inline-block;\n  background-color: white;\n  border: 1px solid gray;\n  margin-top: -1px;\n  display: none;\n}\n.panel-dropdown.show[data-v-36364a03] {\n  display: inline-block;\n}\n.panel-dropdown-item[data-v-36364a03] {\n  padding: 0.35rem 0.65rem;\n  cursor: pointer;\n}\n.panel-dropdown-item[data-v-36364a03]:hover {\n  background-color: lightskyblue;\n}\n.panel-dropdown-item span[data-v-36364a03] {\n  margin-right: 6px;\n  color: gray;\n}\n.panel-dropdown-item[data-v-36364a03]:not(:last-child) {\n  border-bottom: 1px solid lightgray;\n}\n.panel-footer[data-v-36364a03] {\n  display: flex;\n  padding: 1rem;\n  align-items: center;\n  justify-content: flex-end;\n  border-top: 1px solid lightgray;\n}\n.panel-button[data-v-36364a03] {\n  width: 120px;\n  font-size: 0.88rem;\n  border-radius: 5px;\n  border: 0;\n  background-color: #007bff;\n  color: white;\n  padding: 0.6rem;\n  cursor: pointer;\n}\n.float-left[data-v-36364a03] {\n  float: left !important;\n}\n.float-right[data-v-36364a03] {\n  float: right !important;\n}\n.panel-list[data-v-36364a03] {\n  overflow-y: scroll;\n  max-height: 20rem;\n  border: 1px solid #ced4da;\n  border-radius: 0.25rem;\n  display: flex;\n  flex-direction: column;\n}\n.panel-checkbox[data-v-36364a03] {\n  vertical-align: 2px;\n}\n.panel-list span[data-v-36364a03] {\n  margin-left: 10px;\n  color: gray;\n}\n.panel-list-item[data-v-36364a03] {\n  padding: 10px 10px;\n  font-size: 0.88rem;\n  cursor: pointer;\n}\n.panel-list-item[data-v-36364a03]:hover {\n  background-color: lightskyblue;\n}\n.panel-list-item[data-v-36364a03]:not(:last-child) {\n  border-bottom: 1px solid lightgray;\n}\n.normal-text[data-v-36364a03] {\n  font-size: 0.88rem;\n  color: gray;\n}\n.fa-spin[data-v-36364a03] {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-36364a03] {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-36364a03] {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-36364a03] {\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-36364a03] {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-36364a03] {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs[data-v-36364a03] {\n  font-size: 0.75em;\n}\n.fa-sm[data-v-36364a03] {\n  font-size: 0.875em;\n}\n.fa-1x[data-v-36364a03] {\n  font-size: 1em;\n}\n.fa-2x[data-v-36364a03] {\n  font-size: 2em;\n}\n.fa-3x[data-v-36364a03] {\n  font-size: 3em;\n}\n",map:{version:3,sources:["/Users/can/vuejs/hello-world/plugins/VueExcelEditor/src/PanelFilter.vue"],names:[],mappings:";AAgNA;EACA,wBAAA;EACA,2BAAA;AACA;AAEA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,YAAA;EACA,aAAA;EACA,gBAAA;EACA,uBAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,SAAA;EACA,gCAAA;EACA,YAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,cAAA;EACA,kBAAA;EACA,mBAAA;EACA,mBAAA;EACA,2BAAA;EACA,kCAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,aAAA;EACA,gBAAA;EACA,kBAAA;AACA;AAEA;EACA,UAAA;EACA,yBAAA;AACA;AAEA;EACA,qBAAA;EACA,qBAAA;EACA,WAAA;EACA,kBAAA;EACA,mBAAA;AACA;AAEA;EACA,qBAAA;EACA,4BAAA;EACA,+BAAA;EACA,0BAAA;EACA,2BAAA;EACA,cAAA;EACA,iBAAA;EACA,cAAA;AACA;AACA;EACA,SAAA;EACA,gBAAA;EACA,eAAA;EACA,0BAAA;EACA,kBAAA;EACA,6BAAA;AACA;AACA;EACA,2BAAA;EACA,8BAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,iBAAA;EACA,aAAA;EACA,eAAA;EACA,oBAAA;EACA,eAAA;AACA;AAEA;EACA,WAAA;EACA,kBAAA;EACA,OAAA;EACA,WAAA;EACA,qBAAA;EACA,uBAAA;EACA,sBAAA;EACA,gBAAA;EACA,aAAA;AACA;AAEA;EACA,qBAAA;AACA;AACA;EACA,wBAAA;EACA,eAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,iBAAA;EACA,WAAA;AACA;AACA;EACA,kCAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,mBAAA;EACA,yBAAA;EACA,+BAAA;AACA;AAEA;EACA,YAAA;EACA,kBAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;EACA,YAAA;EACA,eAAA;EACA,eAAA;AACA;AAEA;EACA,sBAAA;AACA;AAEA;EACA,uBAAA;AACA;AAEA;EACA,kBAAA;EACA,iBAAA;EACA,yBAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;EACA,iBAAA;EACA,WAAA;AACA;AACA;EACA,kBAAA;EACA,kBAAA;EACA,eAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,kCAAA;AACA;AACA;EACA,kBAAA;EACA,WAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA",file:"PanelFilter.vue",sourcesContent:["<template>\n  <div id=\"panelModal\" v-show=\"show\" class=\"panel-modal\" @click=\"clickOutside\" @keydown.exact.esc=\"hidePanel\">\n    <div ref=\"panelFilter\"\n         class=\"panel-body\">\n      <div class=\"panel-title\">\n        <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sort-amount-down\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-sort-amount-down fa-w-16 fa-1x\"><path fill=\"currentColor\" d=\"M304 416h-64a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-128-64h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.37 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm256-192H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h192a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm-64 128H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM496 32H240a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h256a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z\" class=\"\"></path></svg>        \n        <span v-html=\"localizedLabel.sortingAndFiltering\" />\n      </div>\n      <div class=\"panel-content\">\n        <div class=\"panel-action\">\n          <button class=\"panel-button float-left\" @click=\"sort(1)\">\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sort-alpha-down\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-sort-alpha-down fa-w-14\"><path fill=\"currentColor\" d=\"M176 352h-48V48a16 16 0 0 0-16-16H80a16 16 0 0 0-16 16v304H16c-14.19 0-21.36 17.24-11.29 27.31l80 96a16 16 0 0 0 22.62 0l80-96C197.35 369.26 190.22 352 176 352zm240-64H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 446.37V464a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 321.63V304a16 16 0 0 0-16-16zm31.06-85.38l-59.27-160A16 16 0 0 0 372.72 32h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 224h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 224H432a16 16 0 0 0 15.06-21.38zM335.61 144L352 96l16.39 48z\" class=\"\"></path></svg>\n            <span v-html=\"localizedLabel.sortAscending\" />\n          </button>\n          <button class=\"panel-button float-right\" @click=\"sort(-1)\">\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sort-alpha-up-alt\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-sort-alpha-up-alt fa-w-14\"><path fill=\"currentColor\" d=\"M16 160h48v304a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16V160h48c14.21 0 21.38-17.24 11.31-27.31l-80-96a16 16 0 0 0-22.62 0l-80 96C-5.35 142.74 1.78 160 16 160zm272 64h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-56l61.26-70.45A32 32 0 0 0 432 65.63V48a16 16 0 0 0-16-16H288a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h56l-61.26 70.45A32 32 0 0 0 272 190.37V208a16 16 0 0 0 16 16zm159.06 234.62l-59.27-160A16 16 0 0 0 372.72 288h-41.44a16 16 0 0 0-15.07 10.62l-59.27 160A16 16 0 0 0 272 480h24.83a16 16 0 0 0 15.23-11.08l4.42-12.92h71l4.41 12.92A16 16 0 0 0 407.16 480H432a16 16 0 0 0 15.06-21.38zM335.61 400L352 352l16.39 48z\" class=\"\"></path></svg>\n            <span v-html=\"localizedLabel.sortDescending\" />\n          </button>\n        </div>\n        <div class=\"panel-action\">\n          <div>\n            <button class=\"panel-input-button\" @click=\"showDropdown = !showDropdown\">{{ symbol }}</button>\n            <div :class=\"{show: showDropdown}\" class=\"panel-dropdown\">\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('')\">\n                <span v-html=\"localizedLabel.near\" />\n              </div>\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('=')\">\n                <span v-html=\"localizedLabel.exactMatch\" />\n              </div>\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('>')\">\n                <span v-html=\"localizedLabel.greaterThan\" />\n              </div>\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('>=')\">\n                <span v-html=\"localizedLabel.greaterThanOrEqualTo\" />\n              </div>\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('<')\">\n                <span v-html=\"localizedLabel.lessThan\" />\n              </div>\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('<=')\">\n                <span v-html=\"localizedLabel.lessThanOrEqualTo\" />\n              </div>\n              <div class=\"panel-dropdown-item\" @click.prevent=\"setFilterCondition('~')\">\n                <span v-html=\"localizedLabel.regularExpression\" />\n              </div>\n            </div>\n            <span class=\"panel-input-b\">\n              <input type=\"text\"\n                     ref=\"inputFilter\"\n                     class=\"panel-input\"\n                     :placeholder=\"localizedLabel.customFilter\"\n                     trim autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\n                     @keyup=\"doInputFilter\"\n                     @keydown.exact.enter=\"doFilter\" />\n            </span>\n          </div>\n        </div>\n        <div>\n          <div ref=\"panelList\" class=\"panel-list\">\n            <div v-for=\"(item, k) in filteredSortedUniqueValueList.slice(0, nFilterCount)\" :key=\"k\"\n                 class=\"panel-list-item\"\n                 @click.prevent=\"filterPanelSelect(item)\">\n              <input type=\"checkbox\" class=\"panel-checkbox\" />\n              <span>{{ item }}</span>\n            </div>\n          </div>\n          <div v-if=\"filteredSortedUniqueValueList.length>500\" class=\"normal-text\" style=\"float:right\">\n            <span v-html=\"localizedLabel.listFirstNValuesOnly(nFilterCount)\" />\n          </div>\n        </div>\n      </div>\n\n      <div class=\"panel-footer\">\n        <button class=\"panel-button\" @click=\"doFilter\">\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"sign-in-alt\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-sign-in-alt fa-w-16 fa-fw fa-sm\"><path fill=\"currentColor\" d=\"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z\" class=\"\"></path></svg>\n          <span v-html=\"localizedLabel.apply\" />\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    nFilterCount: {type: Number, default: 200},     // show top n values in filter dialog\n    localizedLabel: {\n      type: Object,\n      default () {\n        return {\n          sortingAndFiltering: 'Sorting And Filtering',\n          sortAscending: 'Sort Ascending',\n          sortDescending: 'Sort Descending',\n          near: '\u2252 Near',\n          exactMatch: '= Exact Match',\n          greaterThan: '&gt; Greater Than',\n          greaterThanOrEqualTo: '\u2265 Greater Than or Equal To',\n          lessThan: '&lt; Less Than',\n          lessThanOrEqualTo: '\u2264 Less Than Or Equal To',\n          regularExpression: '~ Regular Expression',\n          customFilter: 'Custom Filter',\n          listFirstNValuesOnly: n => `List first ${n} values only`,\n          apply: 'Apply'\n        }\n      }\n    }\n  },\n  data () {\n    return {\n      show: false,\n      showDropdown: false,\n      processing: false,\n      columnFilterRef: null,\n      inputFilter: '',\n      inputFilterCondition: '',\n      sortedUniqueValueList: []\n    }\n  },\n  computed: {\n    filteredSortedUniqueValueList () {\n      const filter = this.inputFilter.toUpperCase()\n      return this.sortedUniqueValueList.filter(item => item.toUpperCase().startsWith(filter))\n    },\n    symbol () {\n      switch(this.inputFilterCondition) {\n        case '':\n          return '\u2252'\n        case '<=':\n          return '\u2264'\n        case '>=':\n          return '\u2265'\n        default:\n          return this.inputFilterCondition\n      }\n    },\n  },\n  methods: {\n    clickOutside (e) {\n      if (e.target.id === 'panelModal') this.hidePanel()\n    },\n    sort (direction) {\n      this.hidePanel()\n      this.$parent.sort(direction, this.columnFilterRef.colPos)\n    },\n    setFilterCondition(choice) {\n      this.showDropdown = false\n      this.inputFilterCondition = choice\n      this.$refs.inputFilter.focus()\n    },\n    freezePanelSizeAfterShown () {\n      const target = this.$refs.panelList\n      const rect = target.getBoundingClientRect()\n      target.setAttribute('style', `width:${rect.width}px; height:${rect.height}px;`)\n    },\n    removePanelSizeAfterHide () {\n      const target = this.$refs.panelList\n      target.removeAttribute('style')\n    },\n    doInputFilter () {\n      if (window.delay) clearTimeout(window.delay)\n      window.delay = setTimeout(() => {\n        this.inputFilter = this.$refs.inputFilter.value\n      }, 200)\n    },\n    doFilter () {\n      const opt = this.inputFilterCondition + this.$refs.inputFilter.value\n      this.columnFilterRef.$el.textContent = opt\n      this.columnFilterRef.$emit('input', opt)\n      this.hidePanel()\n    },\n    filterPanelSelect (opt) {\n      // this.columnFilter[this.columnFilterRef.colPos] = el  // Cannot use this, dunno why\n      this.columnFilterRef.$el.textContent = '=' + opt\n      this.columnFilterRef.$emit('input', '=' + opt)\n      this.hidePanel()\n    },\n    showPanel (ref) {\n      this.columnFilterRef = ref\n      this.inputFilter = ''\n      this.inputFilterCondition = ''\n      this.sortedUniqueValueList = []\n      this.$refs.inputFilter.value = ''\n      this.show = true\n      this.columnFilterRef.$el.textContent = ''\n      this.columnFilterRef.$emit('input', '')\n      setTimeout(() => (this.$refs.inputFilter.focus()))\n\n      const hash = {}\n      const fieldName = this.$parent.fields[ref.colPos].name\n      this.$parent.table.forEach(record => (hash[record[fieldName]] = true))\n      const keys = Object.keys(hash)\n      keys.sort()\n      if (keys.length > 0 && keys[0] === '') keys[0] = ' '\n      this.sortedUniqueValueList = keys\n      setTimeout(() => this.freezePanelSizeAfterShown())\n    },\n    hidePanel () {\n      this.show = false\n      this.removePanelSizeAfterHide()\n      setTimeout(() => {\n        this.sortedUniqueValueList = []\n      }, 0)\n    }\n  }\n}\n</script>\n\n<style scoped>\n\ninput:focus, button:focus {\n  outline: none !important;\n  box-shadow: none !important;\n}\n\n.panel-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #0007;\n  z-index: 999;\n  font-weight: 400;\n  font-size: 1rem;\n  text-shadow: none;\n}\n\n.panel-body {\n  background-color: white;\n  position: fixed;\n  border-radius: 5px;\n  padding: 0;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 28rem;\n  max-width: 75vh;\n  height: fit-content;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n}\n\n.panel-title {\n  padding: 1rem;\n  display: flex;\n  color: dimgray;\n  font-size: 1.25rem;\n  line-height: 1.5rem;\n  align-items: center;\n  justify-content: flex-start;\n  border-bottom: 1px solid lightgray;\n}\n\ndiv.panel-title span, button.panel-button span {\n  margin-left: 6px;\n}\n\n.panel-content {\n  padding: 1rem;\n  text-align: left;\n  overflow-y: scroll;\n}\n\n.panel-content .panel-button {\n  width: 48%;\n  background-color: #17a2b8;\n}\n\n.panel-action {\n  display: inline-block;\n  margin-bottom: 0.5rem;\n  width: 100%;\n  position: relative;\n  white-space: nowrap;\n}\n\n.panel-input-b {\n  display: inline-block;\n  border-top-right-radius: 4px;\n  border-bottom-right-radius: 4px;\n  width: calc(100% - 2.2rem);\n  border: 1px solid lightgray;\n  border-left: 0;\n  margin-left: -4px;\n  height: 2.3rem;\n}\n.panel-input {\n  border: 0;\n  box-shadow: none;\n  padding: 0.6rem;\n  width: calc(100% - 2.2rem);\n  font-size: 0.88rem;\n  background-color: transparent;\n}\n.panel-input-button {\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n  color: white;\n  background-color: #28a745;\n  border: 1px solid #28a745;\n  font-size: 1.3rem;\n  width: 2.2rem;\n  height: 2.35rem;\n  vertical-align: -2px;\n  cursor: pointer;\n}\n\n.panel-dropdown {\n  z-index: 50;\n  position: absolute;\n  left: 0;\n  top: 2.4rem;\n  display: inline-block;\n  background-color: white;\n  border: 1px solid gray;\n  margin-top: -1px;\n  display: none;\n}\n\n.panel-dropdown.show {\n  display: inline-block;\n}\n.panel-dropdown-item {\n  padding: 0.35rem 0.65rem;\n  cursor: pointer;\n}\n.panel-dropdown-item:hover {\n  background-color: lightskyblue;\n}\n.panel-dropdown-item span {\n  margin-right: 6px;\n  color: gray;\n}\n.panel-dropdown-item:not(:last-child) {\n  border-bottom: 1px solid lightgray;\n}\n\n.panel-footer {\n  display: flex;\n  padding: 1rem;\n  align-items: center;\n  justify-content: flex-end;\n  border-top: 1px solid lightgray;\n}\n\n.panel-button {\n  width: 120px;\n  font-size: 0.88rem;\n  border-radius: 5px;\n  border: 0;\n  background-color: #007bff;\n  color: white;\n  padding: 0.6rem;\n  cursor: pointer;\n}\n\n.float-left {\n  float: left !important;\n}\n\n.float-right {\n  float: right !important;\n}\n\n.panel-list {\n  overflow-y: scroll;\n  max-height: 20rem;\n  border: 1px solid #ced4da;\n  border-radius: 0.25rem;\n  display: flex;\n  flex-direction: column;\n}\n.panel-checkbox {\n  vertical-align: 2px;\n}\n.panel-list span {\n  margin-left: 10px;\n  color: gray;\n}\n.panel-list-item {\n  padding: 10px 10px;\n  font-size: 0.88rem;\n  cursor: pointer;\n}\n.panel-list-item:hover {\n  background-color: lightskyblue;\n}\n.panel-list-item:not(:last-child) {\n  border-bottom: 1px solid lightgray;\n}\n.normal-text {\n  font-size: 0.88rem;\n  color: gray;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs {\n  font-size: 0.75em;\n}\n.fa-sm {\n  font-size: 0.875em;\n}\n.fa-1x {\n  font-size: 1em;\n}\n.fa-2x {\n  font-size: 2em;\n}\n.fa-3x {\n  font-size: 3em;\n}\n</style>\n"]},media:void 0})},Le,"data-v-36364a03",!1,void 0,!1,o,void 0,void 0);/* scoped */ //
var Re={components:{draggable:t},props:{value:Array,localizedLabel:{type:Object,default(){return{tableSetting:"Table Setting",exportExcel:"Export Excel",importExcel:"Import Excel",back:"Back"}}}},data(){return{show:!1,processing:!1}},computed:{fields:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{clickOutside(t){"panelModal"===t.target.id&&this.hidePanel()},columnLabelClick(e){e.invisible=!e.invisible,setTimeout(this.$parent.calStickyLeft)},freezePanelSizeAfterShown(){const e=this.$refs.panelList,t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},removePanelSizeAfterHide(){const e=this.$refs.panelList;e.removeAttribute("style")},exportTable(e){this.hidePanel(),this.$parent.exportTable(e)},importTable(){this.hidePanel(),this.$parent.importTable()},showPanel(){this.show=!0,setTimeout(()=>this.$refs.button.focus()),setTimeout(()=>this.freezePanelSizeAfterShown())},hidePanel(){this.show=!1,this.removePanelSizeAfterHide()}}};/* script */ /* template */var Ve=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"panel-modal",attrs:{id:"panelModal"},on:{click:e.clickOutside,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.hidePanel(t)}}},[l("div",{ref:"panelSetting",staticClass:"panel-body"},[l("div",{staticClass:"panel-title"},[l("svg",{staticClass:"svg-inline--fa fa-bars fa-w-14 fa-1x",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"bars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.tableSetting)}})]),e._v(" "),l("div",{staticClass:"panel-content"},[l("div",{staticClass:"panel-action"},[l("button",{staticClass:"panel-button float-left",on:{click:function(){return e.exportTable("excel")}}},[l("svg",{staticClass:"svg-inline--fa fa-file-excel fa-w-12",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"file-excel",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"}},[l("path",{attrs:{fill:"currentColor",d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.exportExcel)}})]),e._v(" "),l("button",{staticClass:"panel-button float-right",on:{click:e.importTable}},[l("svg",{staticClass:"svg-inline--fa fa-file-csv fa-w-12",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"file-csv",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"}},[l("path",{attrs:{fill:"currentColor",d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-96 144c0 4.42-3.58 8-8 8h-8c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h8c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-8c-26.51 0-48-21.49-48-48v-32c0-26.51 21.49-48 48-48h8c4.42 0 8 3.58 8 8v16zm44.27 104H160c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h12.27c5.95 0 10.41-3.5 10.41-6.62 0-1.3-.75-2.66-2.12-3.84l-21.89-18.77c-8.47-7.22-13.33-17.48-13.33-28.14 0-21.3 19.02-38.62 42.41-38.62H200c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-12.27c-5.95 0-10.41 3.5-10.41 6.62 0 1.3.75 2.66 2.12 3.84l21.89 18.77c8.47 7.22 13.33 17.48 13.33 28.14.01 21.29-19 38.62-42.39 38.62zM256 264v20.8c0 20.27 5.7 40.17 16 56.88 10.3-16.7 16-36.61 16-56.88V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v20.8c0 35.48-12.88 68.89-36.28 94.09-3.02 3.25-7.27 5.11-11.72 5.11s-8.7-1.86-11.72-5.11c-23.4-25.2-36.28-58.61-36.28-94.09V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8zm121-159L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.importExcel)}})])]),e._v(" "),l("div",[l("div",{ref:"panelList",staticClass:"panel-list"},[l("draggable",{attrs:{draggable:".panel-list-item"},model:{value:e.fields,callback:function(t){e.fields=t},expression:"fields"}},e._l(e.fields,function(t,i){return l("div",{key:i,staticClass:"panel-list-item",on:{click:function(l){return l.preventDefault(),e.columnLabelClick(t)}}},[l("input",{staticClass:"panel-checkbox",attrs:{type:"checkbox"},domProps:{checked:!t.invisible}}),e._v(" "),l("span",[e._v(e._s(t.label))])])}),0)],1)])]),e._v(" "),l("div",{staticClass:"panel-footer"},[l("button",{ref:"button",staticClass:"panel-button",on:{click:e.hidePanel}},[l("svg",{staticClass:"svg-inline--fa fa-save fa-w-14 fa-fw fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"save",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}})]),e._v(" "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.back)}})])])])])};Ve._withStripped=!0;/* style */const $e=a({render:Ve,staticRenderFns:[]},function(e){e&&e("data-v-fdfb3e9c_0",{source:"\ninput[data-v-fdfb3e9c]:focus, button[data-v-fdfb3e9c]:focus {\n  outline: none !important;\n  box-shadow: inset 0 -1px 0 #ddd !important;\n}\n.panel-modal[data-v-fdfb3e9c] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #0007;\n  z-index: 999;\n  font-weight: 400;\n  font-size: 1rem;\n  text-shadow: none;\n}\n.panel-body[data-v-fdfb3e9c] {\n  background-color: white;\n  position: fixed;\n  border-radius: 5px;\n  padding: 0;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 28rem;\n  max-width: 75vh;\n  height: fit-content;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n}\n.panel-title[data-v-fdfb3e9c] {\n  padding: 1rem;\n  display: flex;\n  color: dimgray;\n  font-size: 1.25rem;\n  line-height: 1.5rem;\n  align-items: center;\n  justify-content: flex-start;\n  border-bottom: 1px solid lightgray;\n}\ndiv.panel-title span[data-v-fdfb3e9c], button.panel-button span[data-v-fdfb3e9c] {\n  margin-left: 6px;\n}\n.panel-content[data-v-fdfb3e9c] {\n  padding: 1rem;\n  text-align: left;\n  overflow-y: scroll;\n}\n.panel-content .panel-button[data-v-fdfb3e9c] {\n  width: 48%;\n  background-color: #17a2b8;\n}\n.panel-action[data-v-fdfb3e9c] {\n  display: inline-block;\n  margin-bottom: 0.5rem;\n  width: 100%;\n  position: relative;\n  white-space: nowrap;\n}\n.panel-footer[data-v-fdfb3e9c] {\n  display: flex;\n  padding: 1rem;\n  align-items: center;\n  justify-content: flex-end;\n  border-top: 1px solid lightgray;\n}\n.panel-button[data-v-fdfb3e9c] {\n  width: 120px;\n  font-size: 0.88rem;\n  border-radius: 5px;\n  border: 0;\n  background-color: #007bff;\n  color: white;\n  padding: 0.6rem;\n  cursor: pointer;\n}\n.float-left[data-v-fdfb3e9c] {\n  float: left !important;\n}\n.float-right[data-v-fdfb3e9c] {\n  float: right !important;\n}\n.panel-list[data-v-fdfb3e9c] {\n  overflow-y: scroll;\n  max-height: 20rem;\n  border: 1px solid #ced4da;\n  border-radius: 0.25rem;\n  display: flex;\n  flex-direction: column;\n}\n.panel-checkbox[data-v-fdfb3e9c] {\n  vertical-align: 2px;\n}\n.panel-list span[data-v-fdfb3e9c] {\n  margin-left: 10px;\n  color: gray;\n}\n.panel-list-item[data-v-fdfb3e9c] {\n  padding: 10px 10px;\n  font-size: 0.88rem;\n  cursor: pointer;\n}\n.panel-list-item[data-v-fdfb3e9c]:hover {\n  background-color: lightskyblue;\n}\n.panel-list-item[data-v-fdfb3e9c]:not(:last-child) {\n  border-bottom: 1px solid lightgray;\n}\n.fa-spin[data-v-fdfb3e9c] {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-fdfb3e9c] {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-fdfb3e9c] {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-fdfb3e9c] {\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-fdfb3e9c] {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-fdfb3e9c] {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs[data-v-fdfb3e9c] {\n  font-size: 0.75em;\n}\n.fa-sm[data-v-fdfb3e9c] {\n  font-size: 0.875em;\n}\n.fa-1x[data-v-fdfb3e9c] {\n  font-size: 1em;\n}\n.fa-2x[data-v-fdfb3e9c] {\n  font-size: 2em;\n}\n.fa-3x[data-v-fdfb3e9c] {\n  font-size: 3em;\n}\n",map:{version:3,sources:["/Users/can/vuejs/hello-world/plugins/VueExcelEditor/src/PanelSetting.vue"],names:[],mappings:";AAwHA;EACA,wBAAA;EACA,0CAAA;AACA;AAEA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,YAAA;EACA,aAAA;EACA,gBAAA;EACA,uBAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,SAAA;EACA,gCAAA;EACA,YAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,cAAA;EACA,kBAAA;EACA,mBAAA;EACA,mBAAA;EACA,2BAAA;EACA,kCAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,aAAA;EACA,gBAAA;EACA,kBAAA;AACA;AAEA;EACA,UAAA;EACA,yBAAA;AACA;AAEA;EACA,qBAAA;EACA,qBAAA;EACA,WAAA;EACA,kBAAA;EACA,mBAAA;AACA;AAEA;EACA,aAAA;EACA,aAAA;EACA,mBAAA;EACA,yBAAA;EACA,+BAAA;AACA;AAEA;EACA,YAAA;EACA,kBAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;EACA,YAAA;EACA,eAAA;EACA,eAAA;AACA;AAEA;EACA,sBAAA;AACA;AAEA;EACA,uBAAA;AACA;AAEA;EACA,kBAAA;EACA,iBAAA;EACA,yBAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;EACA,iBAAA;EACA,WAAA;AACA;AACA;EACA,kBAAA;EACA,kBAAA;EACA,eAAA;AACA;AACA;EACA,8BAAA;AACA;AACA;EACA,kCAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA",file:"PanelSetting.vue",sourcesContent:["<template>\n  <div id=\"panelModal\" v-show=\"show\" class=\"panel-modal\" @click=\"clickOutside\" @keydown.exact.esc=\"hidePanel\">\n    <div ref=\"panelSetting\"\n         class=\"panel-body\">\n      <div class=\"panel-title\">\n        <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"bars\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-bars fa-w-14 fa-1x\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\" class=\"\"></path></svg>\n        <span v-html=\"localizedLabel.tableSetting\" />\n      </div>\n      <div class=\"panel-content\">\n        <div class=\"panel-action\">\n          <button class=\"panel-button float-left\" @click=\"exportTable('excel')\">\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"file-excel\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" class=\"svg-inline--fa fa-file-excel fa-w-12\"><path fill=\"currentColor\" d=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z\" class=\"\"></path></svg>\n            <span v-html=\"localizedLabel.exportExcel\" />\n          </button>\n          <button class=\"panel-button float-right\" @click=\"importTable\">\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"file-csv\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\" class=\"svg-inline--fa fa-file-csv fa-w-12\"><path fill=\"currentColor\" d=\"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-96 144c0 4.42-3.58 8-8 8h-8c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h8c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-8c-26.51 0-48-21.49-48-48v-32c0-26.51 21.49-48 48-48h8c4.42 0 8 3.58 8 8v16zm44.27 104H160c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h12.27c5.95 0 10.41-3.5 10.41-6.62 0-1.3-.75-2.66-2.12-3.84l-21.89-18.77c-8.47-7.22-13.33-17.48-13.33-28.14 0-21.3 19.02-38.62 42.41-38.62H200c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8h-12.27c-5.95 0-10.41 3.5-10.41 6.62 0 1.3.75 2.66 2.12 3.84l21.89 18.77c8.47 7.22 13.33 17.48 13.33 28.14.01 21.29-19 38.62-42.39 38.62zM256 264v20.8c0 20.27 5.7 40.17 16 56.88 10.3-16.7 16-36.61 16-56.88V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v20.8c0 35.48-12.88 68.89-36.28 94.09-3.02 3.25-7.27 5.11-11.72 5.11s-8.7-1.86-11.72-5.11c-23.4-25.2-36.28-58.61-36.28-94.09V264c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8zm121-159L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z\" class=\"\"></path></svg>\n            <span v-html=\"localizedLabel.importExcel\" />\n          </button>\n        </div>\n        <div>\n          <div ref=\"panelList\" class=\"panel-list\">\n            <draggable v-model=\"fields\" draggable=\".panel-list-item\">\n              <div v-for=\"(item, k) in fields\" :key=\"k\"\n                   class=\"panel-list-item\"\n                   @click.prevent=\"columnLabelClick(item)\">\n                <input type=\"checkbox\" :checked=\"!item.invisible\" class=\"panel-checkbox\">\n                <span>{{ item.label }}</span>\n              </div>\n            </draggable>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"panel-footer\">\n        <button ref=\"button\" class=\"panel-button\" @click=\"hidePanel\">\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"save\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-save fa-w-14 fa-fw fa-sm\"><path fill=\"currentColor\" d=\"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z\" class=\"\"></path></svg>\n          <span v-html=\"localizedLabel.back\" />\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport draggable from 'vuedraggable'\n\nexport default {\n  components: {\n    'draggable': draggable\n  },\n  props: {\n    value: Array,\n    localizedLabel: {\n      type: Object,\n      default () {\n        return {\n          tableSetting: 'Table Setting',\n          exportExcel: 'Export Excel',\n          importExcel: 'Import Excel',\n          back: 'Back'\n        }\n      }\n    }\n  },\n  data () {\n    return {\n      show: false,\n      processing: false\n    }\n  },\n  computed: {\n    fields: {\n      get: function () {\n        return this.value\n      },\n      set: function (newVal) {\n        this.$emit('input', newVal)\n      }\n    }\n  },\n  methods: {\n    clickOutside (e) {\n      if (e.target.id === 'panelModal') this.hidePanel()\n    },\n    columnLabelClick (item) {\n      item.invisible = !item.invisible\n      setTimeout(this.$parent.calStickyLeft)\n    },\n    freezePanelSizeAfterShown () {\n      const target = this.$refs.panelList\n      const rect = target.getBoundingClientRect()\n      target.setAttribute('style', `width:${rect.width}px; height:${rect.height}px;`)\n    },\n    removePanelSizeAfterHide () {\n      const target = this.$refs.panelList\n      target.removeAttribute('style')\n    },\n    exportTable (format) {\n      this.hidePanel()\n      this.$parent.exportTable(format)\n    },\n    importTable () {\n      this.hidePanel()\n      this.$parent.importTable()\n    },\n    showPanel () {\n      this.show = true\n      setTimeout(() => (this.$refs.button.focus()))\n      setTimeout(() => this.freezePanelSizeAfterShown())\n    },\n    hidePanel () {\n      this.show = false\n      this.removePanelSizeAfterHide()\n    }\n  }\n}\n</script>\n\n<style scoped>\n\ninput:focus, button:focus {\n  outline: none !important;\n  box-shadow: inset 0 -1px 0 #ddd !important;\n}\n\n.panel-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #0007;\n  z-index: 999;\n  font-weight: 400;\n  font-size: 1rem;\n  text-shadow: none;\n}\n\n.panel-body {\n  background-color: white;\n  position: fixed;\n  border-radius: 5px;\n  padding: 0;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 28rem;\n  max-width: 75vh;\n  height: fit-content;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n}\n\n.panel-title {\n  padding: 1rem;\n  display: flex;\n  color: dimgray;\n  font-size: 1.25rem;\n  line-height: 1.5rem;\n  align-items: center;\n  justify-content: flex-start;\n  border-bottom: 1px solid lightgray;\n}\n\ndiv.panel-title span, button.panel-button span {\n  margin-left: 6px;\n}\n\n.panel-content {\n  padding: 1rem;\n  text-align: left;\n  overflow-y: scroll;\n}\n\n.panel-content .panel-button {\n  width: 48%;\n  background-color: #17a2b8;\n}\n\n.panel-action {\n  display: inline-block;\n  margin-bottom: 0.5rem;\n  width: 100%;\n  position: relative;\n  white-space: nowrap;\n}\n\n.panel-footer {\n  display: flex;\n  padding: 1rem;\n  align-items: center;\n  justify-content: flex-end;\n  border-top: 1px solid lightgray;\n}\n\n.panel-button {\n  width: 120px;\n  font-size: 0.88rem;\n  border-radius: 5px;\n  border: 0;\n  background-color: #007bff;\n  color: white;\n  padding: 0.6rem;\n  cursor: pointer;\n}\n\n.float-left {\n  float: left !important;\n}\n\n.float-right {\n  float: right !important;\n}\n\n.panel-list {\n  overflow-y: scroll;\n  max-height: 20rem;\n  border: 1px solid #ced4da;\n  border-radius: 0.25rem;\n  display: flex;\n  flex-direction: column;\n}\n.panel-checkbox {\n  vertical-align: 2px;\n}\n.panel-list span {\n  margin-left: 10px;\n  color: gray;\n}\n.panel-list-item {\n  padding: 10px 10px;\n  font-size: 0.88rem;\n  cursor: pointer;\n}\n.panel-list-item:hover {\n  background-color: lightskyblue;\n}\n.panel-list-item:not(:last-child) {\n  border-bottom: 1px solid lightgray;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs {\n  font-size: 0.75em;\n}\n.fa-sm {\n  font-size: 0.875em;\n}\n.fa-1x {\n  font-size: 1em;\n}\n.fa-2x {\n  font-size: 2em;\n}\n.fa-3x {\n  font-size: 3em;\n}\n</style>\n"]},media:void 0})},Re,"data-v-fdfb3e9c",!1,void 0,!1,o,void 0,void 0);/* scoped */ //
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
var _e={props:{localizedLabel:{type:Object,default(){return{}}}},data(){return{show:!1,processing:!1,inputFind:""}},methods:{clickOutside(t){"panelModal"===t.target.id&&this.hidePanel()},doFind(t,l){l&&l.preventDefault(),this.hidePanel(),this.$parent.doFind(this.inputFind)},showPanel(){this.show=!0,setTimeout(()=>this.$refs.inputFind.focus())},hidePanel(){this.show=!1}}};/* script */ /* template */var He=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"panel-modal",attrs:{id:"panelModal"},on:{click:e.clickOutside,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.hidePanel(t)}}},[l("div",{ref:"panelFind",staticClass:"panel-body"},[l("div",[l("span",{staticClass:"panel-input-b"},[l("input",{directives:[{name:"model",rawName:"v-model",value:e.inputFind,expression:"inputFind"}],ref:"inputFind",staticClass:"panel-input",attrs:{type:"text",trim:"",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},domProps:{value:e.inputFind},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.doFind(e.inputFind,t)},input:function(t){t.target.composing||(e.inputFind=t.target.value)}}})]),e._v(" "),l("button",{staticClass:"panel-input-button",on:{click:function(){return e.doFind(e.inputFind)}}},[l("svg",{staticClass:"svg-inline--fa fa-search fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"search",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"}})])])])])])};He._withStripped=!0;/* style */const Ie=a({render:He,staticRenderFns:[]},function(e){e&&e("data-v-0584bada_0",{source:"\ninput[data-v-0584bada]:focus, button[data-v-0584bada]:focus {\n  outline: none !important;\n  box-shadow: none !important;\n}\n.panel-modal[data-v-0584bada] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #0007;\n  z-index: 999;\n  font-weight: 400;\n  font-size: 1rem;\n  text-shadow: none;\n}\n.panel-body[data-v-0584bada] {\n  background-color: white;\n  position: fixed;\n  border-radius: 5px;\n  padding: 1rem;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 28rem;\n  max-width: 75vh;\n  height: fit-content;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n  white-space: nowrap;\n}\n.panel-input-b[data-v-0584bada] {\n  display: inline-block;\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n  width: calc(100% - 2.2rem);\n  border: 1px solid lightgray;\n  border-right: 0;\n  margin-right: -4px;\n  height: 2.3rem;\n}\n.panel-input[data-v-0584bada] {\n  border: 0;\n  box-shadow: none;\n  padding: 0.6rem;\n  width: calc(100% - 2.2rem);\n  font-size: 0.88rem;\n  background-color: transparent;\n}\n.panel-input-button[data-v-0584bada] {\n  border-top-right-radius: 4px;\n  border-bottom-right-radius: 4px;\n  color: white;\n  background-color: #28a745;\n  border: 1px solid #28a745;\n  font-size: 1.3rem;\n  width: 2.2rem;\n  height: 2.35rem;\n  vertical-align: -2px;\n  cursor: pointer;\n}\n.fa-spin[data-v-0584bada] {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-0584bada] {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-0584bada] {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-0584bada] {\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-0584bada] {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-0584bada] {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs[data-v-0584bada] {\n  font-size: 0.75em;\n}\n.fa-sm[data-v-0584bada] {\n  font-size: 0.875em;\n}\n.fa-1x[data-v-0584bada] {\n  font-size: 1em;\n}\n.fa-2x[data-v-0584bada] {\n  font-size: 2em;\n}\n.fa-3x[data-v-0584bada] {\n  font-size: 3em;\n}\n",map:{version:3,sources:["/Users/can/vuejs/hello-world/plugins/VueExcelEditor/src/PanelFind.vue"],names:[],mappings:";AA4DA;EACA,wBAAA;EACA,2BAAA;AACA;AAEA;EACA,eAAA;EACA,MAAA;EACA,OAAA;EACA,YAAA;EACA,aAAA;EACA,gBAAA;EACA,uBAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,eAAA;EACA,kBAAA;EACA,aAAA;EACA,QAAA;EACA,SAAA;EACA,gCAAA;EACA,YAAA;EACA,eAAA;EACA,mBAAA;EACA,gBAAA;EACA,aAAA;EACA,sBAAA;EACA,mBAAA;AACA;AAEA;EACA,qBAAA;EACA,2BAAA;EACA,8BAAA;EACA,0BAAA;EACA,2BAAA;EACA,eAAA;EACA,kBAAA;EACA,cAAA;AACA;AACA;EACA,SAAA;EACA,gBAAA;EACA,eAAA;EACA,0BAAA;EACA,kBAAA;EACA,6BAAA;AACA;AACA;EACA,4BAAA;EACA,+BAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,iBAAA;EACA,aAAA;EACA,eAAA;EACA,oBAAA;EACA,eAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,cAAA;AACA",file:"PanelFind.vue",sourcesContent:["<template>\n  <div id=\"panelModal\" v-show=\"show\" class=\"panel-modal\" @click=\"clickOutside\" @keydown.exact.esc=\"hidePanel\">\n    <div ref=\"panelFind\" class=\"panel-body\">\n      <div>\n        <span class=\"panel-input-b\">\n          <input type=\"text\"\n                 ref=\"inputFind\"\n                 v-model=\"inputFind\"\n                 class=\"panel-input\"\n                 trim autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\n                 @keydown.exact.enter=\"doFind(inputFind, $event)\" />\n        </span>\n        <button class=\"panel-input-button\" @click=\"doFind(inputFind)\">\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"search\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-search fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z\" class=\"\"></path></svg>\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    localizedLabel: {\n      type: Object,\n      default () {\n        return {\n        }\n      }\n    }\n  },\n  data () {\n    return {\n      show: false,\n      processing: false,\n      inputFind: ''\n    }\n  },\n  methods: {\n    clickOutside (e) {\n      if (e.target.id === 'panelModal') this.hidePanel()\n    },\n    doFind(s, e) {\n      if (e) e.preventDefault()\n      this.hidePanel()\n      this.$parent.doFind(this.inputFind)\n    },\n    showPanel () {\n      this.show = true\n      setTimeout(() => (this.$refs.inputFind.focus()))\n    },\n    hidePanel () {\n      this.show = false\n    }\n  }\n}\n</script>\n\n<style scoped>\n\ninput:focus, button:focus {\n  outline: none !important;\n  box-shadow: none !important;\n}\n\n.panel-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #0007;\n  z-index: 999;\n  font-weight: 400;\n  font-size: 1rem;\n  text-shadow: none;\n}\n\n.panel-body {\n  background-color: white;\n  position: fixed;\n  border-radius: 5px;\n  padding: 1rem;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 28rem;\n  max-width: 75vh;\n  height: fit-content;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n  white-space: nowrap;\n}\n\n.panel-input-b {\n  display: inline-block;\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n  width: calc(100% - 2.2rem);\n  border: 1px solid lightgray;\n  border-right: 0;\n  margin-right: -4px;\n  height: 2.3rem;\n}\n.panel-input {\n  border: 0;\n  box-shadow: none;\n  padding: 0.6rem;\n  width: calc(100% - 2.2rem);\n  font-size: 0.88rem;\n  background-color: transparent;\n}\n.panel-input-button {\n  border-top-right-radius: 4px;\n  border-bottom-right-radius: 4px;\n  color: white;\n  background-color: #28a745;\n  border: 1px solid #28a745;\n  font-size: 1.3rem;\n  width: 2.2rem;\n  height: 2.35rem;\n  vertical-align: -2px;\n  cursor: pointer;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs {\n  font-size: 0.75em;\n}\n.fa-sm {\n  font-size: 0.875em;\n}\n.fa-1x {\n  font-size: 1em;\n}\n.fa-2x {\n  font-size: 2em;\n}\n.fa-3x {\n  font-size: 3em;\n}\n</style>\n"]},media:void 0})},_e,"data-v-0584bada",!1,void 0,!1,o,void 0,void 0);/* scoped */var Oe={months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],firstDayOfWeek:0,firstWeekContainsDate:1},Ue=/\[([^\]]+)]|YYYY|YY?|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|m{1,2}|s{1,2}|Z{1,2}|S{1,3}|w{1,2}|x|X|a|A/g,We=function(e,t,l){var i=12>e?"AM":"PM";return l?i.toLocaleLowerCase():i},Ye={Y:function(e){var t=e.getFullYear();return 9999>=t?"".concat(t):"+".concat(t)},// Year: 00, 01, ..., 99
YY:function(e){return M(e.getFullYear(),4).substr(2)},// Year: 1900, 1901, ..., 2099
YYYY:function(e){return M(e.getFullYear(),4)},// Month: 1, 2, ..., 12
M:function(e){return e.getMonth()+1},// Month: 01, 02, ..., 12
MM:function(e){return M(e.getMonth()+1,2)},MMM:function(e,t){return t.monthsShort[e.getMonth()]},MMMM:function(e,t){return t.months[e.getMonth()]},// Day of month: 1, 2, ..., 31
D:function(e){return e.getDate()},// Day of month: 01, 02, ..., 31
DD:function(e){return M(e.getDate(),2)},// Hour: 0, 1, ... 23
H:function(e){return e.getHours()},// Hour: 00, 01, ..., 23
HH:function(e){return M(e.getHours(),2)},// Hour: 1, 2, ..., 12
h:function(e){var t=e.getHours();return 0===t?12:12<t?t%12:t},// Hour: 01, 02, ..., 12
hh:function(){var e=Ye.h.apply(Ye,arguments);return M(e,2)},// Minute: 0, 1, ..., 59
m:function(e){return e.getMinutes()},// Minute: 00, 01, ..., 59
mm:function(e){return M(e.getMinutes(),2)},// Second: 0, 1, ..., 59
s:function(e){return e.getSeconds()},// Second: 00, 01, ..., 59
ss:function(e){return M(e.getSeconds(),2)},// 1/10 of second: 0, 1, ..., 9
S:function(e){return Ee(e.getMilliseconds()/100)},// 1/100 of second: 00, 01, ..., 99
SS:function(e){return M(Ee(e.getMilliseconds()/10),2)},// Millisecond: 000, 001, ..., 999
SSS:function(e){return M(e.getMilliseconds(),3)},// Day of week: 0, 1, ..., 6
d:function(e){return e.getDay()},// Day of week: 'Su', 'Mo', ..., 'Sa'
dd:function(e,t){return t.weekdaysMin[e.getDay()]},// Day of week: 'Sun', 'Mon',..., 'Sat'
ddd:function(e,t){return t.weekdaysShort[e.getDay()]},// Day of week: 'Sunday', 'Monday', ...,'Saturday'
dddd:function(e,t){return t.weekdays[e.getDay()]},// AM, PM
A:function(e,t){var l=t.meridiem||We;return l(e.getHours(),e.getMinutes(),!1)},// am, pm
a:function(e,t){var l=t.meridiem||We;return l(e.getHours(),e.getMinutes(),!0)},// Timezone: -01:00, +00:00, ... +12:00
Z:function(e){return R(e.getTimezoneOffset(),":")},// Timezone: -0100, +0000, ... +1200
ZZ:function(e){return R(e.getTimezoneOffset())},// Seconds timestamp: 512969520
X:function(e){return Ee(e.getTime()/1e3)},// Milliseconds timestamp: 512969520900
x:function(e){return e.getTime()},w:function(e,t){return D(e,{firstDayOfWeek:t.firstDayOfWeek,firstWeekContainsDate:t.firstWeekContainsDate})},ww:function(e,t){return M(Ye.w(e,t),2)}},qe=/(\[[^\[]*\])|(MM?M?M?|Do|DD?|ddd?d?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|S{1,3}|x|X|ZZ?|.)/g,Ne=/\d/,Ke=/\d\d/,Xe=/\d{3}/,je=/\d{4}/,Qe=/\d\d?/,Ge=/[+-]\d\d:?\d\d/,Je=/[+-]?\d+/,Ze=/[+-]?\d+(\.\d{1,3})?/,et=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,tt="year",lt="month",it="day",at="hour",ot="minute",st="second",rt="millisecond",nt={},dt=function(e,t,l){var i=Array.isArray(e)?e:[e],a;a="string"==typeof l?function(e){var t=parseInt(e,10);return K({},l,t)}:l,i.forEach(function(e){nt[e]=[t,a]})},ct=function(e,t){return function(l,i){var a=i[e];if(!Array.isArray(a))throw new Error("Locale[".concat(e,"] need an array"));var o=a.indexOf(l);if(0>o)throw new Error("Invalid Word");return K({},t,o)}};dt("Y",Je,tt),dt("YY",Ke,function(e){var t=new Date().getFullYear(),l=Ee(t/100),i=parseInt(e,10);return i=100*(68<i?l-1:l)+i,K({},tt,i)}),dt("YYYY",je,tt),dt("M",Qe,function(e){return K({},lt,parseInt(e,10)-1)}),dt("MM",Ke,function(e){return K({},lt,parseInt(e,10)-1)}),dt("MMM",et,ct("monthsShort",lt)),dt("MMMM",et,ct("months",lt)),dt("D",Qe,it),dt("DD",Ke,it),dt(["H","h"],Qe,at),dt(["HH","hh"],Ke,at),dt("m",Qe,ot),dt("mm",Ke,ot),dt("s",Qe,st),dt("ss",Ke,st),dt("S",Ne,function(e){return K({},rt,100*parseInt(e,10))}),dt("SS",Ke,function(e){return K({},rt,10*parseInt(e,10))}),dt("SSS",Xe,rt),dt(["A","a"],function(e){return e.meridiemParse||/[ap]\.?m?\.?/i},function(e,t){var l="function"==typeof t.isPM?t.isPM(e):X(e);return{isPM:l}}),dt(["Z","ZZ"],Ge,function(e){return{offset:j(e)}}),dt("x",Je,function(e){return{date:new Date(parseInt(e,10))}}),dt("X",Ze,function(e){return{date:new Date(1e3*parseFloat(e))}}),dt("d",Ne,"weekday"),dt("dd",et,ct("weekdaysMin","weekday")),dt("ddd",et,ct("weekdaysShort","weekday")),dt("dddd",et,ct("weekdays","weekday")),dt("w",Qe,"week"),dt("ww",Ke,"week");var At=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;t["default"]={months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],firstDayOfWeek:0,firstWeekContainsDate:1},e.exports=t.default}),pt=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}(At),ut="en",ht={};ht[ut]={formatLocale:pt,yearFormat:"YYYY",monthFormat:"MMM",monthBeforeYear:!0};var ft={name:"Popup",inject:{prefixClass:{default:"mx"}},props:{visible:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!0},inline:{type:Boolean,default:!1}},data:function(){return{top:"",left:""}},watch:{visible:{immediate:!0,handler:function(e){var t=this;this.$nextTick(function(){e&&t.displayPopup()})}}},mounted:function(){var e=this;if(!this.inline){this.appendToBody&&document.body.appendChild(this.$el),this._clickoutEvent="ontouchend"in document?"touchstart":"mousedown",document.addEventListener(this._clickoutEvent,this.handleClickOutside);// change the popup position when resize or scroll
var t=this.$parent.$el;this._displayPopup=ue(function(){return e.displayPopup()}),this._scrollParent=ge(t)||window,this._scrollParent.addEventListener("scroll",this._displayPopup),window.addEventListener("resize",this._displayPopup)}},beforeDestroy:function(){this.inline||(this.appendToBody&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el),document.removeEventListener(this._clickoutEvent,this.handleClickOutside),this._scrollParent.removeEventListener("scroll",this._displayPopup),window.removeEventListener("resize",this._displayPopup))},methods:{handleClickOutside:function(e){if(this.visible){var t=e.target,l=this.$el;l&&!l.contains(t)&&this.$emit("clickoutside",e)}},displayPopup:function(){if(!this.inline&&this.visible){var e=this.$el,t=this.$parent.$el,l=this.appendToBody;this._popupRect||(this._popupRect=he(e));var i=this._popupRect,a=i.width,o=i.height,s=fe(t,a,o,l),r=s.left,n=s.top;this.left=r,this.top=n}}},render:function(){var e=arguments[0],t=this.prefixClass;return this.inline?e("div",{class:"".concat(t,"-datepicker-main")},[this.$slots.default]):e("transition",{attrs:{name:"".concat(t,"-zoom-in-down")}},[this.visible&&e("div",{class:"".concat(t,"-datepicker-main ").concat(t,"-datepicker-popup"),style:{top:this.top,left:this.left,position:"absolute"}},[this.$slots.default])])}},gt="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase()),mt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"}},[l("path",{attrs:{d:"M940.218182 107.054545h-209.454546V46.545455h-65.163636v60.50909H363.054545V46.545455H297.890909v60.50909H83.781818c-18.618182 0-32.581818 13.963636-32.581818 32.581819v805.236363c0 18.618182 13.963636 32.581818 32.581818 32.581818h861.090909c18.618182 0 32.581818-13.963636 32.581818-32.581818V139.636364c-4.654545-18.618182-18.618182-32.581818-37.236363-32.581819zM297.890909 172.218182V232.727273h65.163636V172.218182h307.2V232.727273h65.163637V172.218182h176.872727v204.8H116.363636V172.218182h181.527273zM116.363636 912.290909V442.181818h795.927273v470.109091H116.363636z"}})])},staticRenderFns:[]},void 0,{},void 0,!1,void 0,!1,void 0,void 0,void 0),vt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"}},[l("path",{attrs:{d:"M810.005333 274.005333l-237.994667 237.994667 237.994667 237.994667-60.010667 60.010667-237.994667-237.994667-237.994667 237.994667-60.010667-60.010667 237.994667-237.994667-237.994667-237.994667 60.010667-60.010667 237.994667 237.994667 237.994667-237.994667z"}})])},staticRenderFns:[]},void 0,{},void 0,!1,void 0,!1,void 0,void 0,void 0),bt={name:"TableDate",inject:{t:{default:function(){return pe}},getWeek:{default:function(){return D}},prefixClass:{default:"mx"}},props:{calendarYear:{type:Number,default:function(){return new Date().getFullYear()}},calendarMonth:{type:Number,default:function(){return new Date().getMonth()}},showWeekNumber:{type:Boolean,default:!1},titleFormat:{type:String,default:"YYYY-MM-DD"},getRowClasses:{type:Function,default:function(){return[]}},getCellClasses:{type:Function,default:function(){return[]}}},computed:{firstDayOfWeek:function(){return this.t("formatLocale.firstDayOfWeek")||0},days:function e(){var e=this.t("days")||this.t("formatLocale.weekdaysMin");return e.concat(e).slice(this.firstDayOfWeek,this.firstDayOfWeek+7)},dates:function(){for(var e=[],t=this.firstDayOfWeek,l=this.calendarYear,a=this.calendarMonth,o=te(l,a,0),s=o.getDate(),r=s-(o.getDay()+7-t)%7,n=r,d;n<=s;n++)d=n-s,e.push({day:d,text:n});// change to the last day of the current month
o.setMonth(a+1,0);for(var c=o.getDate(),A=1;A<=c;A++)e.push({day:A,text:A});for(var p=1;p<=42-(s-r+1)-c;p++)e.push({day:c+p,text:p});return se(e,7)}},methods:{formatDate:function(e,t){return V(e,t,{locale:this.t("formatLocale")})},handleCellClick:function(e){var t=e.target;"DIV"===t.tagName&&(t=t.parentNode);var l=t.getAttribute("data-day");l&&this.$emit("select",parseInt(l,10))},getCellTitle:function(e){var t=this.calendarYear,l=this.calendarMonth,i=this.titleFormat,a=te(t,l,e);return this.formatDate(a,i)},getWeekNumber:function(e){var t=this.calendarYear,l=this.calendarMonth,i=te(t,l,e);return this.getWeek(i,this.t("formatLocale"))}}},Ct=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("table",{class:e.prefixClass+"-table "+e.prefixClass+"-table-date"},[l("thead",[l("tr",[e.showWeekNumber?l("th",{class:e.prefixClass+"-week-number-header"}):e._e(),e._v(" "),e._l(e.days,function(t){return l("th",{key:t},[e._v(e._s(t))])})],2)]),e._v(" "),l("tbody",{on:{click:e.handleCellClick}},e._l(e.dates,function(t,a){return l("tr",{key:a,class:[e.prefixClass+"-date-row",e.getRowClasses(t)]},[e.showWeekNumber?l("td",{class:e.prefixClass+"-week-number"},[e._v("\n        "+e._s(e.getWeekNumber(t[0].day))+"\n      ")]):e._e(),e._v(" "),e._l(t,function(t,i){return l("td",{key:i,staticClass:"cell",class:e.getCellClasses(t.day),attrs:{"data-day":t.day,title:e.getCellTitle(t.day)}},[l("div",[e._v(e._s(t.text))])])})],2)}),0)])},staticRenderFns:[]},void 0,bt,void 0,!1,void 0,!1,void 0,void 0,void 0),yt={name:"TableMonth",inject:{t:{default:function(){return pe}},prefixClass:{default:"mx"}},props:{getCellClasses:{type:Function,default:function(){return[]}}},computed:{months:function e(){var t=this.t("months")||this.t("formatLocale.monthsShort"),e=t.map(function(e,t){return{text:e,month:t}});return se(e,3)}},methods:{handleClick:function(e){var t=e.target;"DIV"===t.tagName&&(t=t.parentNode);var l=t.getAttribute("data-month");l&&this.$emit("select",parseInt(l,10))}}},wt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("table",{class:e.prefixClass+"-table "+e.prefixClass+"-table-month",on:{click:e.handleClick}},e._l(e.months,function(t,a){return l("tr",{key:a},e._l(t,function(t,i){return l("td",{key:i,staticClass:"cell",class:e.getCellClasses(t.month),attrs:{"data-month":t.month}},[l("div",[e._v(e._s(t.text))])])}),0)}),0)},staticRenderFns:[]},void 0,yt,void 0,!1,void 0,!1,void 0,void 0,void 0),xt={name:"TableYear",inject:{prefixClass:{default:"mx"}},props:{decade:Number,getCellClasses:{type:Function,default:function(){return[]}}},computed:{years:function e(){for(var t=this.decade,e=[],l=0;10>l;l++)e.push(t+l);return se(e,2)}},methods:{handleClick:function(e){var t=e.target;"DIV"===t.tagName&&(t=t.parentNode);var l=t.getAttribute("data-year");l&&this.$emit("select",parseInt(l,10))}}},kt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("table",{class:e.prefixClass+"-table "+e.prefixClass+"-table-year",on:{click:e.handleClick}},e._l(e.years,function(t,a){return l("tr",{key:a},e._l(t,function(t,i){return l("td",{key:i,staticClass:"cell",class:e.getCellClasses(t),attrs:{"data-year":t}},[l("div",[e._v(e._s(t))])])}),0)}),0)},staticRenderFns:[]},void 0,xt,void 0,!1,void 0,!1,void 0,void 0,void 0),Et={name:"CalendarPanel",components:{TableDate:Ct,TableMonth:wt,TableYear:kt},inject:{t:{default:function(){return pe}},prefixClass:{default:"mx"}},props:{value:{},defaultValue:{default:function(){var e=new Date;return e.setHours(0,0,0,0),e}},defaultPanel:{type:String},disabledDate:{type:Function,default:function(){return!1}},type:{type:String,default:"date"},getClasses:{type:Function,default:function(){return[]}},showWeekNumber:{type:Boolean,default:void 0},titleFormat:{type:String,default:"YYYY-MM-DD"},calendar:Date,// update date when select year or month
partialUpdate:{type:Boolean,default:!1}},data:function(){var e=["date","month","year"],t=ye(e.indexOf(this.type),e.indexOf(this.defaultPanel)),l=-1===t?"date":e[t];return{panel:l,innerCalendar:null}},computed:{innerValue:function(){var e=Array.isArray(this.value)?this.value:[this.value],t={year:f,month:h,date:d},l=t[this.type]||t.date;return e.filter(le).map(function(e){return l(e)})},calendarYear:function(){return this.innerCalendar.getFullYear()},calendarMonth:function(){return this.innerCalendar.getMonth()},calendarDecade:function(){return 10*Ee(this.calendarYear/10)},showIconDoubleArrow:function(){return"date"===this.panel||"month"===this.panel||"year"===this.panel},showIconArrow:function(){return"date"===this.panel},dateHeader:function(){var e=this.t("monthBeforeYear"),t=this.t("yearFormat"),l=this.t("monthFormat")||"MMM",i={panel:"year",label:this.formatDate(this.innerCalendar,t)},a={panel:"month",label:this.formatDate(this.innerCalendar,l)};return e?[a,i]:[i,a]}},watch:{value:{immediate:!0,handler:"initCalendar"},calendar:{handler:"initCalendar"},defaultValue:{handler:"initCalendar"}},methods:{formatDate:function(e,t){return V(e,t,{locale:this.t("formatLocale")})},initCalendar:function(){var e=this.calendar;le(e)||(e=ae(this.innerValue[0],this.defaultValue)),this.innerCalendar=e},isDisabled:function(e){return this.disabledDate(new Date(e),this.innerValue)},emitDate:function(e,t){this.isDisabled(e)||this.$emit("select",e,t)},updateCalendar:function(e){this.innerCalendar=e,this.$emit("update:calendar",e)},handelPanelChange:function(e){this.panel=e},handleIconLeftClick:function(){var e=v(this.innerCalendar,1);this.updateCalendar(e)},handleIconRightClick:function(){var e=A(this.innerCalendar,1);this.updateCalendar(e)},handleIconDoubleLeftClick:function(){var e=b(this.innerCalendar,"year"===this.panel?10:1);this.updateCalendar(e)},handleIconDoubleRightClick:function(){var e=p(this.innerCalendar,"year"===this.panel?10:1);this.updateCalendar(e)},handleSelectYear:function(e){if("year"===this.type){var t=this.getCellDate(e,"year");this.emitDate(t,"year")}else{var l=m(this.innerCalendar,e);if(this.updateCalendar(l),this.handelPanelChange("month"),this.partialUpdate&&this.innerValue[0]){var i=m(this.innerValue[0],e);this.emitDate(i,"year")}}},handleSelectMonth:function(e){if("month"===this.type){var t=this.getCellDate(e,"month");this.emitDate(t,"month")}else{var l=g(this.innerCalendar,e);if(this.updateCalendar(l),this.handelPanelChange("date"),this.partialUpdate&&this.innerValue[0]){var i=g(m(this.innerValue[0],this.calendarYear),e);this.emitDate(i,"month")}}},handleSelectDate:function(e){var t=this.getCellDate(e,"date");this.emitDate(t,"week"===this.type?"week":"date")},getCellDate:function(e,t){return"year"===t?te(e,0):"month"===t?te(this.calendarYear,e):te(this.calendarYear,this.calendarMonth,e)},getDateClasses:function(e){var t=this.getCellDate(e,"date"),l=t.getMonth()!==this.calendarMonth,i=[];t.getTime()===new Date().setHours(0,0,0,0)&&i.push("today"),l&&i.push("not-current-month");var a=this.getStateClass(t);return"active"===a&&l||i.push(a),i.concat(this.getClasses(t,this.innerValue,i.join(" ")))},getMonthClasses:function(e){if("month"!==this.type)return this.calendarMonth===e?"active":"";var t=[],l=this.getCellDate(e,"month");return t.push(this.getStateClass(l)),t.concat(this.getClasses(l,this.innerValue,t.join(" ")))},getYearClasses:function(e){if("year"!==this.type)return this.calendarYear===e?"active":"";var t=[],l=this.getCellDate(e,"year");return t.push(this.getStateClass(l)),t.concat(this.getClasses(l,this.innerValue,t.join(" ")))},getStateClass:function(e){return this.isDisabled(e)?"disabled":this.innerValue.some(function(t){return t.getTime()===e.getTime()})?"active":""},getWeekState:function(e){if("week"!==this.type)return"";var t=this.getCellDate(e[0].day,"date").getTime(),l=this.getCellDate(e[6].day,"date").getTime(),i=this.innerValue.some(function(e){var i=e.getTime();return i>=t&&i<=l});return i?"".concat(this.prefixClass,"-active-week"):""}}},St=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t,i;return l("div",{class:[e.prefixClass+"-calendar",e.prefixClass+"-calendar-panel-"+e.panel,(i={},i[e.prefixClass+"-calendar-week-mode"]="week"===e.type,i)]},[l("div",{class:e.prefixClass+"-calendar-header"},[l("button",{directives:[{name:"show",rawName:"v-show",value:e.showIconDoubleArrow,expression:"showIconDoubleArrow"}],class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-icon-double-left",attrs:{type:"button"},on:{click:e.handleIconDoubleLeftClick}},[l("i",{class:e.prefixClass+"-icon-double-left"})]),e._v(" "),l("button",{directives:[{name:"show",rawName:"v-show",value:e.showIconArrow,expression:"showIconArrow"}],class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-icon-left",attrs:{type:"button"},on:{click:e.handleIconLeftClick}},[l("i",{class:e.prefixClass+"-icon-left"})]),e._v(" "),l("button",{directives:[{name:"show",rawName:"v-show",value:e.showIconDoubleArrow,expression:"showIconDoubleArrow"}],class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-icon-double-right",attrs:{type:"button"},on:{click:e.handleIconDoubleRightClick}},[l("i",{class:e.prefixClass+"-icon-double-right"})]),e._v(" "),l("button",{directives:[{name:"show",rawName:"v-show",value:e.showIconArrow,expression:"showIconArrow"}],class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-icon-right",attrs:{type:"button"},on:{click:e.handleIconRightClick}},[l("i",{class:e.prefixClass+"-icon-right"})]),e._v(" "),l("span",{class:e.prefixClass+"-calendar-header-label"},["year"===e.panel?[l("span",[e._v(e._s(e.calendarDecade))]),e._v(" "),l("span",{class:e.prefixClass+"-calendar-decade-separator"}),e._v(" "),l("span",[e._v(e._s(e.calendarDecade+9))])]:"month"===e.panel?l("button",{class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text",attrs:{type:"button"},on:{click:function(){return e.handelPanelChange("year")}}},[e._v("\n        "+e._s(e.calendarYear)+"\n      ")]):"date"===e.panel?e._l(e.dateHeader,function(t){return l("button",{key:t.panel,class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-current-"+t.panel,attrs:{type:"button"},on:{click:function(){return e.handelPanelChange(t.panel)}}},[e._v("\n          "+e._s(t.label)+"\n        ")])}):e._e()],2)]),e._v(" "),l("div",{class:e.prefixClass+"-calendar-content"},[l("table-year",{directives:[{name:"show",rawName:"v-show",value:"year"===e.panel,expression:"panel === 'year'"}],attrs:{decade:e.calendarDecade,"get-cell-classes":e.getYearClasses},on:{select:e.handleSelectYear}}),e._v(" "),"year"===e.type?e._e():l("table-month",{directives:[{name:"show",rawName:"v-show",value:"month"===e.panel,expression:"panel === 'month'"}],attrs:{"get-cell-classes":e.getMonthClasses},on:{select:e.handleSelectMonth}}),e._v(" "),"year"!==e.type&&"month"!==e.type?l("table-date",{directives:[{name:"show",rawName:"v-show",value:"date"===e.panel,expression:"panel === 'date'"}],attrs:{"calendar-year":e.calendarYear,"calendar-month":e.calendarMonth,"title-format":e.titleFormat,"show-week-number":"boolean"==typeof e.showWeekNumber?e.showWeekNumber:"week"===e.type,"get-cell-classes":e.getDateClasses,"get-row-classes":e.getWeekState},on:{select:e.handleSelectDate}}):e._e()],1)])},staticRenderFns:[]},void 0,Et,void 0,!1,void 0,!1,void 0,void 0,void 0),Bt={name:"CalendarRange",components:{CalendarPanel:St},inject:{prefixClass:{default:"mx"}},props:x({},St.props),data:function(){return{innerValue:[],calendars:[]}},computed:{// Minimum difference between start and end calendars
calendarMinDiff:function(){var e={date:1,// type:date  min 1 month
month:12,// type:month min 1 year
year:120// type:year  min 10 year
};return e[this.type]||e.date},calendarMaxDiff:function(){return 1/0},defaultValues:function(){return Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue,this.defaultValue]}},watch:{value:{immediate:!0,handler:function(){var e=this;this.innerValue=ie(this.value)?this.value:[new Date(NaN),new Date(NaN)],this.calendars=this.innerValue.map(function(t,l){return ae(t,e.defaultValues[l])}),this.validateCalendars(1)}}},methods:{handleSelect:function(e,t){var l=k(this.innerValue,2),i=l[0],a=l[1];le(i)&&!le(a)?(this.innerValue=i.getTime()>e.getTime()?[e,i]:[i,e],this.emitDate(this.innerValue,t)):this.innerValue=[e,new Date(NaN)]},emitDate:function(e,t){this.$emit("select",e,t)},updateStartCalendar:function(e){this.calendars.splice(0,1,e),this.validateCalendars(1)},updateEndCalendar:function(e){this.calendars.splice(1,1,e),this.validateCalendars(0)},validateCalendars:function(e){var t=this.getCalendarGap();if(t){var l=this.calendars[e];l=0===e?v(l,t):A(l,t),this.calendars.splice(e,1,l)}},getCalendarGap:function(){var e=u(this.calendars[1],this.calendars[0]),t=this.calendarMinDiff,l=this.calendarMaxDiff;return e<t?t-e:e>l?l-e:0},getRangeClasses:function(e,t,l){var i=[].concat(this.getClasses(e,t,l));return!/disabled|active|not-current-month/.test(l)&&2===t.length&&e.getTime()>t[0].getTime()&&e.getTime()<t[1].getTime()&&i.push("in-range"),i}},render:function(){var e=this,t=arguments[0],l=this.calendars.map(function(l,i){var a=x({},e.$props,{calendar:l,value:e.innerValue,defaultValue:e.defaultValues[i],getClasses:e.getRangeClasses,// don't update when range is true
partialUpdate:!1}),o={select:e.handleSelect,"update:calendar":0===i?e.updateStartCalendar:e.updateEndCalendar};return t("calendar-panel",{props:x({},a),on:x({},o)})}),i=this.prefixClass;return t("div",{class:"".concat(i,"-range-wrapper")},[l])}},Tt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{class:e.prefixClass+"-scrollbar",style:{position:"relative",overflow:"hidden"}},[l("div",{ref:"wrap",class:e.prefixClass+"-scrollbar-wrap",style:{marginRight:"-"+e.scrollbarWidth+"px"},on:{scroll:e.handleScroll}},[e._t("default")],2),e._v(" "),l("div",{class:e.prefixClass+"-scrollbar-track"},[l("div",{ref:"thumb",class:e.prefixClass+"-scrollbar-thumb",style:{height:e.thumbHeight,top:e.thumbTop},on:{mousedown:e.handleDragstart}})])])},staticRenderFns:[]},void 0,{inject:{prefixClass:{default:"mx"}},data:function(){return{scrollbarWidth:0,thumbTop:"",thumbHeight:""}},created:function(){this.scrollbarWidth=ve(),document.addEventListener("mouseup",this.handleDragend)},beforeDestroy:function(){document.addEventListener("mouseup",this.handleDragend)},mounted:function(){this.$nextTick(this.getThumbSize)},methods:{getThumbSize:function(){var e=this.$refs.wrap;if(e){var t=100*e.clientHeight/e.scrollHeight;this.thumbHeight=100>t?"".concat(t,"%"):""}},handleScroll:function(e){var t=e.currentTarget,l=t.scrollHeight,i=t.scrollTop;this.thumbTop="".concat(100*i/l,"%")},handleDragstart:function(e){e.stopImmediatePropagation(),this._draggable=!0;var t=this.$refs.thumb.offsetTop;this._prevY=e.clientY-t,document.addEventListener("mousemove",this.handleDraging)},handleDraging:function(e){if(this._draggable){var t=e.clientY,l=this.$refs.wrap,i=l.scrollHeight,a=l.clientHeight,o=t-this._prevY;l.scrollTop=o*i/a}},handleDragend:function(){this._draggable&&(this._draggable=!1,document.removeEventListener("mousemove",this.handleDraging))}}},void 0,!1,void 0,!1,void 0,void 0,void 0),zt=function(e){return e=parseInt(e,10),10>e?"0".concat(e):"".concat(e)},Pt=function(e,t,l){if(Array.isArray(l))return l.filter(function(t){return 0<=t&&t<e});0>=t&&(t=1);for(var a=[],o=0;o<e;o+=t)a.push(o);return a},Ft=function e(t,l){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;// jump to target if duration zero
if(0>=i)return void requestAnimationFrame(function(){t.scrollTop=l});var a=l-t.scrollTop;requestAnimationFrame(function(){var o=t.scrollTop+10*(a/i);return o>=l?void(t.scrollTop=l):void(t.scrollTop=o,e(t,l,i-10))})},Lt={name:"ListColumns",components:{ScrollbarVertical:Tt},inject:{prefixClass:{default:"mx"}},props:{date:Date,getClasses:{type:Function,default:function(){return[]}},hourOptions:Array,minuteOptions:Array,secondOptions:Array,showHour:{type:Boolean,default:!0},showMinute:{type:Boolean,default:!0},showSecond:{type:Boolean,default:!0},hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},secondStep:{type:Number,default:1},use12h:{type:Boolean,default:!1}},computed:{columns:function(){var e=[];return this.showHour&&e.push({type:"hour",list:this.getHoursList()}),this.showMinute&&e.push({type:"minute",list:this.getMinutesList()}),this.showSecond&&e.push({type:"second",list:this.getSecondsList()}),this.use12h&&e.push({type:"ampm",list:this.getAMPMList()}),e.filter(function(e){return 0<e.list.length})}},watch:{date:{handler:function(){var e=this;this.$nextTick(function(){e.scrollToSelected(100)})}}},mounted:function(){this.scrollToSelected(0)},methods:{getHoursList:function(){var e=this;return Pt(this.use12h?12:24,this.hourStep,this.hourOptions).map(function(t){var l=new Date(e.date),i=zt(t);e.use12h&&(0===t&&(i="12"),12<=l.getHours()&&(t+=12));var a=l.setHours(t);return{value:a,text:i}})},getMinutesList:function(){var e=this;return Pt(60,this.minuteStep,this.minuteOptions).map(function(t){var l=new Date(e.date).setMinutes(t);return{value:l,text:zt(t)}})},getSecondsList:function(){var e=this;return Pt(60,this.secondStep,this.secondOptions).map(function(t){var l=new Date(e.date).setSeconds(t);return{value:l,text:zt(t)}})},getAMPMList:function(){var e=this;return["AM","PM"].map(function(t,l){var i=new Date(e.date),a=i.setHours(i.getHours()%12+12*l);return{text:t,value:a}})},scrollToSelected:function(e){for(var t=this.$el.querySelectorAll(".active"),l=0;l<t.length;l++){var a=t[l],o=ge(a,this.$el);if(o){var s=a.offsetTop;Ft(o,s,e)}}},handleSelect:function(e){var t=e.target,l=e.currentTarget;if("LI"===t.tagName.toUpperCase()){var i=l.getAttribute("data-type"),a=parseInt(l.getAttribute("data-index"),10),o=parseInt(t.getAttribute("data-index"),10),s=this.columns[a].list[o].value;this.$emit("select",s,i)}}}},Dt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{class:e.prefixClass+"-time-columns"},e._l(e.columns,function(t,a){return l("scrollbar-vertical",{key:a,class:e.prefixClass+"-time-column"},[l("ul",{class:e.prefixClass+"-time-list",attrs:{"data-type":t.type,"data-index":a},on:{click:e.handleSelect}},e._l(t.list,function(t,i){return l("li",{key:t.value,class:[e.prefixClass+"-time-item",e.getClasses(t.value)],attrs:{"data-index":i}},[e._v("\n        "+e._s(t.text)+"\n      ")])}),0)])}),1)},staticRenderFns:[]},void 0,Lt,void 0,!1,void 0,!1,void 0,void 0,void 0),Mt=function(e,t){e&&(e.scrollTop=t)},Rt={name:"ListOptions",components:{ScrollbarVertical:Tt},inject:{t:{default:function(){return pe}},prefixClass:{default:"mx"}},props:{date:Date,options:{type:[Object,Function],default:function(){return[]}},format:{type:String,default:"HH:mm:ss"},getClasses:{type:Function,default:function(){return[]}}},computed:{list:function(){var e=[],t=this.options;if("function"==typeof t)return t()||[];var l=be(t.start),a=be(t.end),o=be(t.step),s=t.format||this.format;if(l&&a&&o)for(var r=l.minutes+60*l.hours,n=a.minutes+60*a.hours,d=o.minutes+60*o.hours,c=Ee((n-r)/d),A=0;A<=c;A++){var p=r+A*d,u=Ee(p/60),h=new Date(this.date).setHours(u,p%60,0);e.push({value:h,text:this.formatDate(h,s)})}return e}},mounted:function(){this.scrollToSelected()},methods:{formatDate:function(e,t){return V(e,t,{locale:this.t("formatLocale")})},scrollToSelected:function(){var e=this.$el.querySelector(".active");if(e){var t=ge(e,this.$el);if(t){var l=e.offsetTop;Mt(t,l)}}},handleSelect:function(e){this.$emit("select",e,"time")}}},Vt=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("scrollbar-vertical",e._l(e.list,function(t){return l("div",{key:t.value,class:[e.prefixClass+"-time-option",e.getClasses(t.value)],on:{click:function(){return e.handleSelect(t.value)}}},[e._v("\n    "+e._s(t.text)+"\n  ")])}),0)},staticRenderFns:[]},void 0,Rt,void 0,!1,void 0,!1,void 0,void 0,void 0),$t={name:"TimePanel",components:{ListColumns:Dt,ListOptions:Vt},inject:{t:{default:function(){return pe}},prefixClass:{default:"mx"}},props:{value:{},defaultValue:{default:function(){var e=new Date;return e.setHours(0,0,0,0),e}},format:{default:"HH:mm:ss"},timeTitleFormat:{type:String,default:"YYYY-MM-DD"},showTimeHeader:{type:Boolean,default:!1},disabledTime:{type:Function,default:function(){return!1}},timePickerOptions:{type:[Object,Function],default:function(){return null}},hourOptions:Array,minuteOptions:Array,secondOptions:Array,hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},secondStep:{type:Number,default:1},showHour:{type:Boolean,default:void 0},showMinute:{type:Boolean,default:void 0},showSecond:{type:Boolean,default:void 0},use12h:{type:Boolean,default:void 0}},computed:{innerValue:function(){return ae(this.value,this.defaultValue)},title:function(){var e=this.timeTitleFormat,t=new Date(this.innerValue);return this.formatDate(t,e)},innerForamt:function(){return"string"==typeof this.format?this.format:"HH:mm:ss"},ShowHourMinuteSecondAMPM:function(){var e=this,t=this.innerForamt,l={showHour:/[HhKk]/.test(t),showMinute:/m/.test(t),showSecond:/s/.test(t),use12h:/a/i.test(t)},i={};return Object.keys(l).forEach(function(t){i[t]="boolean"==typeof e[t]?e[t]:l[t]}),i}},methods:{formatDate:function(e,t){return V(e,t,{locale:this.t("formatLocale")})},isDisabled:function(e){return this.disabledTime(new Date(e))},handleSelect:function(e,t){var l=new Date(e);this.isDisabled(e)||this.$emit("select",l,t)},handleClickTitle:function(){this.$emit("title-click")},getClasses:function(e){var t=new Date(e);return this.isDisabled(e)?"disabled":t.getTime()===this.innerValue.getTime()?"active":""}}},_t=me({render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{class:e.prefixClass+"-time"},[e.showTimeHeader?l("div",{class:e.prefixClass+"-time-header"},[l("button",{class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-time-header-title",attrs:{type:"button"},on:{click:e.handleClickTitle}},[e._v("\n      "+e._s(e.title)+"\n    ")])]):e._e(),e._v(" "),l("div",{class:e.prefixClass+"-time-content"},[e.timePickerOptions?l("list-options",{attrs:{date:e.innerValue,"get-classes":e.getClasses,options:e.timePickerOptions,format:e.innerForamt},on:{select:e.handleSelect}}):l("list-columns",e._b({attrs:{date:e.innerValue,"get-classes":e.getClasses,"hour-options":e.hourOptions,"minute-options":e.minuteOptions,"second-options":e.secondOptions,"hour-step":e.hourStep,"minute-step":e.minuteStep,"second-step":e.secondStep},on:{select:e.handleSelect}},"list-columns",e.ShowHourMinuteSecondAMPM,!1))],1)])},staticRenderFns:[]},void 0,$t,void 0,!1,void 0,!1,void 0,void 0,void 0),Ht={name:"TimeRange",inject:{prefixClass:{default:"mx"}},props:x({},_t.props),data:function(){return{startValue:new Date(NaN),endValue:new Date(NaN)}},watch:{value:{immediate:!0,handler:function(){if(ie(this.value)){var e=k(this.value,2),t=e[0],l=e[1];this.startValue=t,this.endValue=l}else this.startValue=new Date(NaN),this.endValue=new Date(NaN)}}},methods:{emitChange:function(e,t){var l=[this.startValue,this.endValue];this.$emit("select",l,e,t)},handleSelectStart:function(e,t){this.startValue=e,this.endValue.getTime()>=e.getTime()||(this.endValue=e),this.emitChange(t,0)},handleSelectEnd:function(e,t){// check the NaN
this.endValue=e,this.startValue.getTime()<=e.getTime()||(this.startValue=e),this.emitChange(t,1)},disabledStartTime:function(e){return this.disabledTime(e,0)},disabledEndTime:function(e){return e.getTime()<this.startValue.getTime()||this.disabledTime(e,1)}},render:function(){var e=arguments[0],t=Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue,this.defaultValue],l=this.prefixClass;return e("div",{class:"".concat(l,"-range-wrapper")},[e(_t,{props:x({},x({},this.$props,{value:this.startValue,defaultValue:t[0],disabledTime:this.disabledStartTime})),on:x({},x({},this.$listeners,{select:this.handleSelectStart}))}),e(_t,{props:x({},x({},this.$props,{value:this.endValue,defaultValue:t[1],disabledTime:this.disabledEndTime})),on:x({},x({},this.$listeners,{select:this.handleSelectEnd}))})])}},It=["attrs","props","domProps"],Ot=["class","style","directives"],Ut=["on","nativeOn"],Wt=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},Yt=function(e){return e.reduce(function(t,l){for(var a in l)if(!t[a])t[a]=l[a];else if(-1!==It.indexOf(a))t[a]=Ce({},t[a],l[a]);else if(-1!==Ot.indexOf(a)){var o=t[a]instanceof Array?t[a]:[t[a]],s=l[a]instanceof Array?l[a]:[l[a]];t[a]=o.concat(s)}else if(-1!==Ut.indexOf(a)){for(var e in l[a])if(t[a][e]){var r=t[a][e]instanceof Array?t[a][e]:[t[a][e]],n=l[a][e]instanceof Array?l[a][e]:[l[a][e]];t[a][e]=r.concat(n)}else t[a][e]=l[a][e];}else if("hook"==a)for(var d in l[a])t[a][d]=t[a][d]?Wt(t[a][d],l[a][d]):l[a][d];else t[a]=l[a];return t},{})},qt={name:"DatetimePanel",inject:{prefixClass:{default:"mx"}},props:x({},St.props,{},_t.props,{showTimePanel:{type:Boolean,default:void 0}}),data:function(){return{defaultTimeVisible:!1,currentValue:this.value}},computed:{timeVisible:function(){return"boolean"==typeof this.showTimePanel?this.showTimePanel:this.defaultTimeVisible}},watch:{value:function(e){this.currentValue=e}},methods:{closeTimePanel:function(){this.defaultTimeVisible=!1},openTimePanel:function(){this.defaultTimeVisible=!0},emitDate:function(e,t){this.$emit("select",e,t)},handleSelect:function(e,t){"date"===t&&this.openTimePanel();var l=oe(e,ae(this.value,this.defaultValue));return this.disabledTime(new Date(l))&&(l=oe(e,this.defaultValue),this.disabledTime(new Date(l)))?void(this.currentValue=l):void this.emitDate(l,t)}},render:function(){var e=arguments[0],t={props:x({},ne(this,Object.keys(St.props)),{type:"date",value:this.currentValue}),on:{select:this.handleSelect}},l={props:x({},ne(this,Object.keys(_t.props)),{showTimeHeader:!0,value:this.currentValue}),on:{select:this.emitDate,"title-click":this.closeTimePanel}},i=this.prefixClass;return e("div",[e(St,Yt([{},t])),this.timeVisible&&e(_t,Yt([{class:"".concat(i,"-calendar-time")},l]))])}},Nt={name:"DatetimeRange",inject:{prefixClass:{default:"mx"}},props:x({},Bt.props,{},Ht.props,{showTimePanel:{type:Boolean,default:void 0}}),data:function(){return{defaultTimeVisible:!1,currentValue:this.value}},computed:{timeVisible:function(){return"boolean"==typeof this.showTimePanel?this.showTimePanel:this.defaultTimeVisible}},watch:{value:function(e){this.currentValue=e}},methods:{closeTimePanel:function(){this.defaultTimeVisible=!1},openTimePanel:function(){this.defaultTimeVisible=!0},emitDate:function(e,t){this.$emit("select",e,t)},handleSelect:function(e,t){var l=this;"date"===t&&this.openTimePanel();var a=Array.isArray(this.defaultValue)?this.defaultValue:[this.defaultValue,this.defaultValue],o=e.map(function(e,t){var i=ie(l.value)?l.value[t]:a[t];return oe(e,i)});return o[1].getTime()<o[0].getTime()&&(o=[o[0],o[0]]),o.some(this.disabledTime)&&(o=e.map(function(e,t){return oe(e,a[t])}),o.some(this.disabledTime))?void(this.currentValue=o):void this.emitDate(o,t)}},render:function(){var e=arguments[0],t={props:x({},ne(this,Object.keys(Bt.props)),{type:"date",value:this.currentValue}),on:{select:this.handleSelect}},l={props:x({},ne(this,Object.keys(Ht.props)),{value:this.currentValue,showTimeHeader:!0}),on:{select:this.emitDate,"title-click":this.closeTimePanel}},i=this.prefixClass;return e("div",[e(Bt,Yt([{},t])),this.timeVisible&&e(Ht,Yt([{class:"".concat(i,"-calendar-time")},l]))])}},Kt={default:St,time:_t,datetime:qt},Xt={default:Bt,time:Ht,datetime:Nt},jt={name:"DatePicker",components:{IconCalendar:mt,IconClose:vt,Popup:ft},provide:function(){return{t:this.getLocaleFieldValue,getWeek:this.getWeek,prefixClass:this.prefixClass}},props:x({},qt.props,{value:{},valueType:{type:String,default:"date"// date, format, timestamp, or token like 'YYYY-MM-DD'
},type:{type:String,// ['date', 'datetime', 'time', 'year', 'month', 'week']
default:"date"},format:{type:[String,Object],default:function(){var e={date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss",year:"YYYY",month:"YYYY-MM",time:"HH:mm:ss",week:"w"};return e[this.type]||e.date}},range:{type:Boolean,default:!1},rangeSeparator:{type:String,default:" ~ "},lang:{type:[String,Object]},placeholder:{type:String,default:""},editable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},prefixClass:{type:String,default:"mx"},inputClass:{default:function(){return"".concat(this.prefixClass,"-input")}},inputAttr:{type:Object,default:function(){return{}}},appendToBody:{type:Boolean,default:!0},open:{type:Boolean,default:void 0},popupClass:{},popupStyle:{type:Object,default:function(){return{}}},inline:{type:Boolean,default:!1},confirm:{type:Boolean,default:!1},confirmText:{type:String,default:"OK"},shortcuts:{type:Array,validator:function(e){return Array.isArray(e)&&e.every(function(e){return re(e)&&"string"==typeof e.text&&"function"==typeof e.onClick})},default:function(){return[]}}}),data:function(){return{// cache the innervalue, wait to confirm
currentValue:null,userInput:null,defaultOpen:!1}},computed:{currentComponent:function(){var e=this.range?Xt:Kt;return e[this.type]||e.default},currentComponentProps:function(){var e=x({},ne(this,Object.keys(this.currentComponent.props)),{value:this.currentValue});return e},popupVisible:function(){return!this.disabled&&("boolean"==typeof this.open?this.open:this.defaultOpen)},innerValue:function(){var e=this.value;return this.range?(e=Array.isArray(e)?e.slice(0,2):[null,null],e.map(this.value2date)):this.value2date(this.value)},text:function(){var e=this;if(null!==this.userInput)return this.userInput;if(!this.isValidValue(this.innerValue))return"";var t=this.format;return Array.isArray(this.innerValue)?this.innerValue.map(function(l){return e.formatDate(l,t)}).join(this.rangeSeparator):this.formatDate(this.innerValue,t)},showClearIcon:function(){return!this.disabled&&this.clearable&&this.text},locale:function(){return re(this.lang)?de(Ae(),this.lang):Ae(this.lang)}},watch:{innerValue:{immediate:!0,handler:function(e){this.currentValue=e}}},methods:{handleClickOutSide:function(e){var t=e.target;this.$el.contains(t)||this.closePopup()},getWeek:function(e,t){return re(this.format)&&"function"==typeof this.format.getWeek?this.format.getWeek(e,t):D(e,t)},parseDate:function(e,t){if(re(this.format)&&"function"==typeof this.format.parse)return this.format.parse(e,t);var l=new Date;return ee(e,t,{locale:this.locale.formatLocale,backupDate:l})},formatDate:function(e,t){return re(this.format)&&"function"==typeof this.format.stringify?this.format.stringify(e,t):V(e,t,{locale:this.locale.formatLocale})},// transform the outer value to inner date
value2date:function(e){switch(this.valueType){case"date":return e instanceof Date?new Date(e.getTime()):new Date(NaN);case"timestamp":return"number"==typeof e?new Date(e):new Date(NaN);case"format":return"string"==typeof e?this.parseDate(e,this.format):new Date(NaN);default:return"string"==typeof e?this.parseDate(e,this.valueType):new Date(NaN);}},// transform the inner date to outer value
date2value:function(e){if(!le(e))return null;switch(this.valueType){case"date":return e;case"timestamp":return e.getTime();case"format":return this.formatDate(e,this.format);default:return this.formatDate(e,this.valueType);}},emitValue:function(e,t){this.userInput=null;var l=Array.isArray(e)?e.map(this.date2value):this.date2value(e);return this.$emit("input",l),this.$emit("change",l,t),this.afterEmitValue(t),l},afterEmitValue:function(e){e&&e!==this.type&&"time"!==e||this.closePopup()},isValidValue:function(e){var t=this.range?ie:le;return t(e)},handleSelectDate:function(e,t){this.confirm?this.currentValue=e:this.emitValue(e,t)},handleClear:function(){this.emitValue(this.range?[null,null]:null),this.$emit("clear")},handleConfirmDate:function(){var e=this.emitValue(this.currentValue);this.$emit("confirm",e)},handleSelectShortcut:function(e){if(re(e)&&"function"==typeof e.onClick){var t=e.onClick(this);t&&this.emitValue(t)}},openPopup:function(){this.defaultOpen=!0,this.$emit("open"),this.$emit("update:open",!0)},closePopup:function(){this.defaultOpen=!1,this.$emit("close"),this.$emit("update:open",!1)},blur:function(){this.$refs.input.blur()},focus:function(){this.$refs.input.focus()},handleInputChange:function(){var e=this;if(this.editable&&null!==this.userInput){var t=this.userInput;if(this.userInput=null,""===t)return void this.handleClear();var l=this.range?t.split(this.rangeSeparator).map(function(t){return e.parseDate(t,e.format)}):this.parseDate(t,this.format);this.isValidValue(l)?(this.emitValue(l),this.blur()):this.$emit("input-error",t)}},handleInputInput:function(e){this.userInput=e.target.value},handleInputKeydown:function(e){var t=e.keyCode;// Tab 9 or Enter 13
9===t?this.closePopup():13===t&&this.handleInputChange()},handleInputBlur:function(e){// tab close
this.$emit("blur",e)},handleInputFocus:function(e){this.openPopup(),this.$emit("focus",e)},hasSlot:function(e){return!!(this.$slots[e]||this.$scopedSlots[e])},getLocaleFieldValue:function(e){return pe(e,this.locale)}}},Qt=function(){var e=this,t=e.$createElement,l=e._self._c||t,i;return l("div",{class:(i={},i[e.prefixClass+"-datepicker"]=!0,i[e.prefixClass+"-datepicker-range"]=e.range,i[e.prefixClass+"-datepicker-inline"]=e.inline,i.disabled=e.disabled,i)},[e.inline?e._e():l("div",{class:e.prefixClass+"-input-wrapper",on:{mousedown:e.openPopup,touchstart:e.openPopup}},[e._t("input",[l("input",e._b({ref:"input",class:e.inputClass,attrs:{disabled:e.disabled,readonly:!e.editable,placeholder:e.placeholder},on:{keydown:e.handleInputKeydown,focus:e.handleInputFocus,blur:e.handleInputBlur,input:e.handleInputInput,change:e.handleInputChange}},"input",y({},{name:"date",type:"text",autocomplete:"off",value:e.text},e.inputAttr),!1))]),e._v(" "),e.showClearIcon?l("i",{class:e.prefixClass+"-icon-clear",on:{mousedown:function(t){return t.stopPropagation(),e.handleClear(t)}}},[e._t("icon-clear",[l("icon-close")])],2):e._e(),e._v(" "),l("i",{class:e.prefixClass+"-icon-calendar"},[e._t("icon-calendar",[l("icon-calendar")])],2)],2),e._v(" "),l("Popup",{ref:"popup",class:e.popupClass,style:e.popupStyle,attrs:{inline:e.inline,visible:e.popupVisible,"append-to-body":e.appendToBody},on:{clickoutside:e.handleClickOutSide}},[e.hasSlot("sidebar")||e.shortcuts.length?l("div",{class:e.prefixClass+"-datepicker-sidebar"},[e._t("sidebar",null,{value:e.currentValue,emit:e.emitValue}),e._v(" "),e._l(e.shortcuts,function(t,a){return l("button",{key:a,class:e.prefixClass+"-btn "+e.prefixClass+"-btn-text "+e.prefixClass+"-btn-shortcut",attrs:{type:"button"},on:{click:function(){return e.handleSelectShortcut(t)}}},[e._v("\n        "+e._s(t.text)+"\n      ")])})],2):e._e(),e._v(" "),l("div",{class:e.prefixClass+"-datepicker-content"},[e.hasSlot("header")?l("div",{class:e.prefixClass+"-datepicker-header"},[e._t("header",null,{value:e.currentValue,emit:e.emitValue})],2):e._e(),e._v(" "),l("div",{class:e.prefixClass+"-datepicker-body"},[e._t("content",[l(e.currentComponent,e._b({ref:"picker",tag:"component",on:{select:e.handleSelectDate}},"component",e.currentComponentProps,!1))],{value:e.currentValue,emit:e.emitValue})],2),e._v(" "),e.hasSlot("footer")||e.confirm?l("div",{class:e.prefixClass+"-datepicker-footer"},[e._t("footer",null,{value:e.currentValue,emit:e.emitValue}),e._v(" "),e.confirm?l("button",{class:e.prefixClass+"-btn "+e.prefixClass+"-datepicker-btn-confirm",attrs:{type:"button"},on:{click:e.handleConfirmDate}},[e._v("\n          "+e._s(e.confirmText)+"\n        ")]):e._e()],2):e._e()])])],1)},Gt=me({render:Qt,staticRenderFns:[]},void 0,jt,void 0,!1,void 0,!1,void 0,void 0,void 0),Jt;Gt.locale=ce,Gt.install=function(e){e.component(Gt.name,Gt)},"undefined"!=typeof window&&window.Vue&&Gt.install(window.Vue),y(Gt,{CalendarPanel:St,CalendarRange:Bt,TimePanel:_t,TimeRange:Ht,DatetimePanel:qt,DatetimeRange:Nt});//
var Zt={components:{"vue-excel-filter":Fe,"panel-filter":Me,"panel-setting":$e,"panel-find":Ie,"date-picker":Gt},props:{value:{type:Array,default(){return[]}},rowStyle:{type:Function,default(){return{}}},cellStyle:{type:Function,default(){return{}}},headerLabel:{type:Function,default(e){return e}},recordLabel:{// return the row header
type:Function,default(e){return e}},noFinding:{type:Boolean,default:!1},noFindingNext:{type:Boolean,default:!1},filterRow:{type:Boolean,default:!1},freeSelect:{type:Boolean,default:!1},noFooter:{type:Boolean,default:!1},noPaging:{type:Boolean,default:!1},noNumCol:{type:Boolean,default:!1},page:{type:Number,default:0},// prefer page size, auto-cal if not provided
newRecord:{type:Function,default:null},// return the new record from caller if provided
nFilterCount:{type:Number,default:200},// show top n values in filter dialog
height:{type:String,default:""},width:{type:String,default:"100%"},autocomplete:{type:Boolean,default:!1},// Default autocomplete of all columns
readonly:{type:Boolean,default:!1},readonlyStyle:{type:Object,default(){return{}}},remember:{type:Boolean,default:!1},localizedLabel:{type:Object,default(){return{footerLeft:(e,t,l)=>`Record ${e} to ${t} of ${l}`,first:"First",previous:"Previous",next:"Next",last:"Last",footerRight:{selected:"Selected:",filtered:"Filtered:",loaded:"Loaded:"},processing:"Processing",tableSetting:"Table Setting",exportExcel:"Export Excel",importExcel:"Import Excel",back:"Back",sortingAndFiltering:"Sorting And Filtering",sortAscending:"Sort Ascending",sortDescending:"Sort Descending",near:"\u2252 Near",exactMatch:"= Exact Match",greaterThan:"&gt; Greater Than",greaterThanOrEqualTo:"\u2265 Greater Than or Equal To",lessThan:"&lt; Less Than",lessThanOrEqualTo:"\u2264 Less Than Or Equal To",regularExpression:"~ Regular Expression",customFilter:"Custom Filter",listFirstNValuesOnly:e=>`List first ${e} values only`,apply:"Apply",noRecordIsRead:"No record is read",readonlyColumnDetected:"Readonly column detected",columnHasValidationError:(e,t)=>`Column ${e} has validation error: ${t}`,noMatchedColumnName:"No matched column name",invalidInputValue:"Invalid input value",missingKeyColumn:"Missing key column"}}}},data(){const e=this.noPaging?999999:20;return{// selTarget: null,
// selSquare: null,
// selx: 0,
// sely: 0,
tableContent:null,// Table parent
systable:null,// TABLE dom node
colgroupTr:null,// colgroup TR dom node
labelTr:null,// THEAD label dom node
filterTr:null,// THEAD filter dom node
recordBody:null,// TBODY dom node
footer:null,// TFOOTER dom node
pageSize:e,pageTop:0,// Current page top pos of [table] array
selected:{},// selected storage in hash, key is the pos of [table] array
selectedCount:0,// selected row count
prevSelect:-1,// previous select pos of [table] array
processing:!1,// current general-purpose processing status
rowIndex:{},// index of the record key to pos of [table] array
currentRecord:null,// focusing TR dom node
currentRowPos:0,// focusing array pos of [table] array
currentColPos:0,// focusing pos of column/field
currentField:null,// focusing field object
currentCell:null,inputBox:null,inputBoxShow:0,inputSquare:null,autocompleteInputs:[],autocompleteSelect:-1,errmsg:{},tip:"",fields:[],focused:!1,mousein:!1,inputBoxChanged:!1,columnFilter:{},// set filter storage in hash, key is the column pos
inputFind:"",calCellLeft:0,calCellTop:0,calCellTop2:29,frontdrop:null,// frontdrop dom node
sortPos:0,// Sort column position
sortDir:0,// Sort direction, 1=Ascending, -1=Descending
redo:[],// redo log
lazyTimeout:{},lazyBuffer:{},hScroller:{},vScroller:{},leftMost:0,showDatePicker:!1,inputDateTime:"",table:[],summaryRow:!1,showFilteredOnly:!0,showSelectedOnly:!1}},computed:{token(){const e=Array.from(document.querySelectorAll(".vue-excel-editor")).indexOf(this.$el);return`vue-excel-editor-${e}`},columnFilterString(){return Object.keys(this.columnFilter).forEach(e=>{""===this.columnFilter[e].trim()&&delete this.columnFilter[e]}),JSON.stringify(this.columnFilter)},pagingTable(){return this.table.slice(this.pageTop,this.pageTop+this.pageSize)},pageBottom(){return 0===this.value.length?0:this.pageTop+this.pageSize>this.table.length?this.table.length:this.pageTop+this.pageSize},setting:{get(){return null},set(e){if(e.fields){// ignore if fields counts are different
if(e.fields.length!==this.fields.length)return;let t=!0;const l=e.fields.map(e=>{const l=this.fields.find(t=>t.name===e.name);return l||(t=!1),Object.assign(l,{invisible:e.invisible,width:e.width})});t&&(this.fields=l,this.$forceUpdate())}}}},watch:{value(){// detect a loading process, refresh something
// this.redo = []
// this.errmsg = {}
this.lazy(this.refresh)},columnFilterString(){this.processing=!0,setTimeout(()=>{this.refresh(),this.processing=!1},0)},fields:{handler(){this.lazy(()=>{const e=this.getSetting();this.remember&&(localStorage[window.location.pathname+"."+this.token]=JSON.stringify(e)),this.$emit("setting",e)})},deep:!0},processing(e){if(e){const e=this.$el.children[0].getBoundingClientRect();this.frontdrop.style.top=e.top+"px",this.frontdrop.style.left=e.left+"px",this.frontdrop.style.height=e.height+"px",this.frontdrop.style.width=e.width+"px"}}},beforeDestroy(){window.removeEventListener("resize",this.winResize),window.removeEventListener("paste",this.winPaste),window.removeEventListener("keydown",this.winKeydown),window.removeEventListener("scroll",this.winScroll)},mounted(){this.tableContent=this.$refs.tableContent,this.systable=this.$refs.systable,this.colgroupTr=this.systable.children[0],this.labelTr=this.systable.children[1].children[0],this.filterTr=this.systable.children[1].children[1],this.recordBody=this.systable.children[2],this.footer=this.$refs.footer,this.inputSquare=this.$refs.inputSquare,this.inputBox=this.$refs.inputBox,this.frontdrop=this.$refs.frontdrop,this.height&&(this.systable.parentNode.style.height=this.height),this.reset(),this.lazy(()=>{this.labelTr.children[0].style.height=this.labelTr.offsetHeight+"px",this.calCellTop2=this.labelTr.offsetHeight,this.refreshPageSize(),this.calStickyLeft()},200),window.addEventListener("resize",this.winResize),window.addEventListener("paste",this.winPaste),window.addEventListener("keydown",this.winKeydown),window.addEventListener("scroll",this.winScroll),this.remember&&localStorage[window.location.pathname+"."+this.token]&&(this.setting=JSON.parse(localStorage[window.location.pathname+"."+this.token]))},methods:{getSetting(){const e=Array.from(this.colgroupTr.children).map(e=>e.style.width),t=this.fields.map((t,l)=>({name:t.name,invisible:t.invisible,width:e[l+1]}));return{fields:t}},calVScroll(){let e=this.labelTr.getBoundingClientRect().height;this.filterRow&&(e+=29),this.vScroller.top=e,this.noFooter||(e+=25),this.summaryRow&&(e+=27);const t=this.$el.getBoundingClientRect().height;this.vScroller.height=t-e;const l=this.vScroller.height/(24*this.table.length);this.vScroller.buttonHeight=ye(24,this.vScroller.height*l);const i=(this.tableContent.scrollTop+24*this.pageTop)/(24*this.table.length-this.vScroller.height);this.vScroller.buttonTop=(this.vScroller.height-this.vScroller.buttonHeight)*i,this.$forceUpdate()},reset(){this.errmsg={},this.redo=[],this.showFilteredOnly=!0,this.showSelectedOnly=!1,this.columnFilter={},this.sortPos=0,this.sortDir=0,this.inputFind="",this.pageTop=0,this.selected={},this.selectedCount=0,this.prevSelect=-1,this.processing=!1,this.rowIndex={},this.refresh()},toggleSelectView(t){return t&&t.stopPropagation(),this.showSelectedOnly=!this.showSelectedOnly,this.refresh()},toggleFilterView(t){return t&&t.stopPropagation(),this.showFilteredOnly=!this.showFilteredOnly,this.refresh()},summary(e){if(!e.summary)return"";const t=e.name;let l="";switch(e.summary){case"sum":l=this.table.reduce((e,l)=>e+ +l[t],0),l=+(xe(l+"e+5")+"e-5");// solve the infinite .9 issue of javascript
break;case"avg":l=this.table.reduce((e,l)=>e+ +l[t],0)/this.table.length,l=+(xe(l+"e+5")+"e-5");// solve the infinite .9 issue of javascript
break;case"max":l=this.table.reduce((e,l)=>e>l[t]?e:l[t],Number.MIN_VALUE);break;case"min":l=this.table.reduce((e,l)=>e<l[t]?e:l[t],Number.MAX_VALUE);}return e.toText(l)},calTable(){// add unique key to each row if no key is provided
let e=new Date().getTime()-1578101e6;if(this.value.forEach((t,l)=>{t.$id||(t.$id=e+"-"+l)}),!1===this.showFilteredOnly)this.table=this.value;else{const e=Object.keys(this.columnFilter),t={};e.forEach(e=>{switch(!0){case this.columnFilter[e].startsWith("<="):t[e]={type:1,value:this.columnFilter[e].slice(2).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith("<"):t[e]={type:2,value:this.columnFilter[e].slice(1).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith(">="):t[e]={type:3,value:this.columnFilter[e].slice(2).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith(">"):t[e]={type:4,value:this.columnFilter[e].slice(1).trim().toUpperCase()},"number"===this.fields[e].type&&(t[e].value=+t[e].value);break;case this.columnFilter[e].startsWith("="):t[e]={type:0,value:this.columnFilter[e].slice(1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("*")&&this.columnFilter[e].endsWith("*"):t[e]={type:5,value:this.columnFilter[e].slice(1).slice(0,-1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("*")&&!this.columnFilter[e].slice(1).includes("*"):t[e]={type:6,value:this.columnFilter[e].slice(1).trim().toUpperCase()};break;case this.columnFilter[e].endsWith("*")&&!this.columnFilter[e].slice(0,-1).includes("*"):t[e]={type:7,value:this.columnFilter[e].slice(0,-1).trim().toUpperCase()};break;case this.columnFilter[e].startsWith("~"):t[e]={type:8,value:this.columnFilter[e].slice(1).trim()};break;case this.columnFilter[e].includes("*")||this.columnFilter[e].includes("?"):t[e]={type:8,value:"^"+this.columnFilter[e].replace(/\*/g,".*").replace(/\?/g,".").trim()+"$"};break;default:t[e]={type:5,value:this.columnFilter[e].trim().toUpperCase()};}}),this.table=this.value.filter(l=>{const i={};e.forEach(e=>{const t=l[this.fields[e].name];i[e]="undefined"==typeof t?"":(t+"").toUpperCase()});for(let a=0;a<e.length;a++){const l=e[a];switch(t[l].type){case 0:if(`${t[l].value}`!=`${i[l]}`)return!1;break;case 1:if("number"===this.fields[l].type&&(i[l]=+i[l]),t[l].value<i[l])return!1;break;case 2:if("number"===this.fields[l].type&&(i[l]=+i[l]),t[l].value<=i[l])return!1;break;case 3:if("number"===this.fields[l].type&&(i[l]=+i[l]),t[l].value>i[l])return!1;break;case 4:if("number"===this.fields[l].type&&(i[l]=+i[l]),t[l].value>=i[l])return!1;break;case 5:if(!i[l].includes(t[l].value))return!1;break;case 6:if(!i[l].endsWith(t[l].value))return!1;break;case 7:if(!i[l].startsWith(t[l].value))return!1;break;case 8:if(!new RegExp(t[l].value,"i").test(i[l]))return!1;}}return!0})}this.reviseSelectedAfterTableChange(),this.showSelectedOnly&&(this.table=this.table.filter((e,t)=>this.selected[t]),this.reviseSelectedAfterTableChange())},getKeys(e){e||(e=this.currentRecord);const t=this.fields.filter(e=>e.keyField).map(t=>e[t.name]);return t.length&&""!==t.join()?t:[e.$id]},showDatePickerDiv(){const e=this.currentCell.getBoundingClientRect();this.$refs.dpContainer.style.left=e.left+"px",this.$refs.dpContainer.style.top=e.bottom+"px",this.inputDateTime=this.currentCell.textContent,this.showDatePicker=!0,this.lazy(()=>{const t=this.$refs.dpContainer.getBoundingClientRect();t.bottom>window.innerHeight&&(this.$refs.dpContainer.style.top=e.top-t.height+"px"),t.right>window.innerWidth&&(this.$refs.dpContainer.style.top=window.innerWidth-t.width+"px")})},dpClick(){this.inputBox.value=this.inputDateTime,this.inputBoxShow=0,this.inputCellWrite(this.inputDateTime),this.showDatePicker=!1,this.focused=!0},columnCellStyle(e){let t=e.initStyle;return e.readonly&&(t=Object.assign(t,this.readonlyStyle)),e.left&&(t=Object.assign(t,{left:e.left})),t},calStickyLeft(){let e=0,t=0;this.leftMost=-1,Array.from(this.labelTr.children).forEach(l=>{e+=l.offsetWidth;const i=this.fields[t++];i&&(i.sticky?i.left=e+"px":-1===this.leftMost&&(this.leftMost=e))}),this.$forceUpdate()},vsMouseDown(t){t.stopPropagation();const e=t.offsetY-this.vScroller.buttonHeight/2;let l=ye(0,e);l=ke(l,this.vScroller.height-this.vScroller.buttonHeight),l/=this.vScroller.height-this.vScroller.buttonHeight,this.noPaging?this.tableContent.scrollTo(this.tableContent.scrollLeft,24*this.table.length*l):(this.vScroller.buttonTop=l*(this.vScroller.height-this.vScroller.buttonHeight),this.$refs.vScrollButton.style.marginTop=this.vScroller.buttonTop+"px",this.pageTop=xe((this.table.length-this.pageSize)*l))},vsbMouseDown(t){t.stopPropagation(),this.vScroller.mouseY||(this.vScroller.saveButtonTop=this.vScroller.buttonTop,this.vScroller.mouseY=t.clientY,window.addEventListener("mousemove",this.vsbMouseMove),this.$refs.vScrollButton.classList.add("focus"))},vsbMouseMove(t){if(0===t.buttons){if(window.removeEventListener("mousemove",this.vsbMouseMove),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus")),this.vScroller.mouseY=0,!this.noPaging){const e=this.vScroller.buttonTop/(this.vScroller.height-this.vScroller.buttonHeight);this.pageTop=xe((this.table.length-this.pageSize)*e)}this.vScroller.runner=""}else{const e=t.clientY-this.vScroller.mouseY;if(this.noPaging){const t=(this.vScroller.saveButtonTop+e)/(this.vScroller.height-this.vScroller.buttonHeight);this.tableContent.scrollTo(this.tableContent.scrollLeft,24*this.table.length*t)}else{this.vScroller.buttonTop=ye(0,ke(this.vScroller.height-this.vScroller.buttonHeight,this.vScroller.saveButtonTop+e)),this.$refs.vScrollButton.style.marginTop=this.vScroller.buttonTop+"px";const t=this.vScroller.buttonTop/(this.vScroller.height-this.vScroller.buttonHeight),l=xe((this.table.length-this.pageSize)*t)+1,i=this.table[l];this.vScroller.runner=l+"<br>"+this.fields.filter((e,t)=>e.keyField||e.sticky||this.sortPos===t).map(e=>i[e.name]).join("<br>"),this.$forceUpdate()}}},ftMouseDown(t){const e=this.footer.getBoundingClientRect(),l=(t.x-e.left-40)/(e.width-40),i=this.systable.getBoundingClientRect().width,a=this.tableContent.getBoundingClientRect().width;this.tableContent.scrollTo(i*l-a/2,this.tableContent.scrollTop)},sbMouseDown(t){if(t.stopPropagation(),!this.hScroller.mouseX){const e=this.$refs.hScroll.getBoundingClientRect().left,l=this.footer.getBoundingClientRect().left+40;this.hScroller.left=e-l,this.hScroller.mouseX=t.clientX,window.addEventListener("mousemove",this.sbMouseMove),this.$refs.hScroll.classList.add("focus")}},sbMouseMove(t){if(0===t.buttons)window.removeEventListener("mousemove",this.sbMouseMove),this.lazy(()=>this.$refs.hScroll.classList.remove("focus")),this.hScroller.mouseX=0;else{const e=t.clientX-this.hScroller.mouseX,l=(this.hScroller.left+e)/this.hScroller.scrollerUnseenWidth;this.tableContent.scrollTo(this.hScroller.tableUnseenWidth*l,this.tableContent.scrollTop)}},tableScroll(){if(this.showDatePicker=!1,this.autocompleteInputs=[],this.focused&&this.currentField&&(this.inputSquare.style.marginLeft=(this.currentField.sticky?this.tableContent.scrollLeft-this.squareSavedLeft:0)+"px"),this.tableContent.scrollTop!==this.vScroller.lastTop&&(this.calVScroll(),this.$refs.vScrollButton&&(this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3))),this.vScroller.lastTop=this.tableContent.scrollTop,this.tableContent.scrollLeft!==this.hScroller.lastLeft&&this.$refs.hScroll&&this.hScroller.tableUnseenWidth){this.$refs.hScroll.classList.add("focus"),this.lazy(()=>this.$refs.hScroll.classList.remove("focus"),1e3);const e=this.tableContent.scrollLeft/this.hScroller.tableUnseenWidth;this.$refs.hScroll.style.left=this.hScroller.scrollerUnseenWidth*e+"px"}this.hScroller.lastLeft=this.tableContent.scrollLeft},importTable(e){this.$refs.importFile.click(),this.importCallback=e},doImport(t){this.processing=!0,this.refresh(),setTimeout(()=>{const e=t.target.files;if(!e||0===e.length)return;const i=e[0],a=new FileReader;a.onload=t=>{try{const e=t.target.result,i=l.read(e,{type:"binary",cellDates:!0,cellStyle:!1}),a=i.SheetNames[0],o=l.utils.sheet_to_row_object_array(i.Sheets[a]),s=new Date().getTime();if(0===o.length)throw new Error("VueExcelEditor: "+this.localizedLabel.noRecordIsRead);if(0<this.fields.filter(e=>e.keyField).filter(e=>"undefined"==typeof o[0][e.name]&&"undefined"==typeof o[0][e.label]).length)throw new Error(`VueExcelEditor: ${this.localizedLabel.missingKeyColumn}`);let r=0,n=0,d=0;for(;2>r;)o.forEach((e,t)=>{let l=this.table.findIndex(t=>0===this.fields.filter(e=>e.keyField).filter(l=>t[l.name]!==e[l.name]&&t[l.name]!==e[l.label]).length),i={$id:"undefined"==typeof e.$id?s+"-"+t:e.$id};this.fields.forEach(l=>{if(l.name.startsWith("$"))return;let a=e[l.name];if("undefined"==typeof a&&(a=e[l.label]),"undefined"==typeof a)a=null;else{if(l.readonly)throw new Error(`VueExcelEditor: [row=${t+1}] `+this.localizedLabel.readonlyColumnDetected);if(l.validate){let e;if(e=l.validate(a))throw new Error(`VueExcelEditor: [row=${t+1}] `+this.localizedLabel.columnHasValidationError(l.name,e))}}null!==a&&(i[l.name]=a)}),1===r&&(0<=l?d++:(l=this.table.push(i)-1,n++),Object.keys(i).forEach(e=>{e.startsWith("$")||this.updateCellByName(l,e,i[e])}))}),r++;2==r&&this.importCallback&&this.importCallback({inserted:n,updated:d,recordAffected:n+d})}catch(t){throw new Error("VueExcelEditor: "+t.stack)}finally{this.processing=!1,this.$refs.importFile.value=""}},a.onerror=t=>{throw this.processing=!1,this.$refs.importFile.value="",new Error("VueExcelEditor: "+t.stack)},a.readAsBinaryString(i)},500)},winScroll(){this.showDatePicker=!1,this.autocompleteInputs=[]},winResize(){this.lazy(this.refreshPageSize,200)},winPaste(t){if("TEXTAREA"===t.target.tagName&&(this.mousein||this.focused)&&this.currentField&&!this.currentField.readonly){if(this.inputBoxShow)return void(this.inputBoxChanged=!0);const e=(t.originalEvent||t).clipboardData.getData("text/plain");this.inputCellWrite(e),t.preventDefault()}},winKeydown(t){if(this.mousein||this.focused)if(t.ctrlKey||t.metaKey)switch(t.keyCode){case 90:this.undoTransaction(),t.preventDefault();break;case 65:this.toggleSelectAllRecords(),t.preventDefault();break;case 67:this.inputBox.value=this.currentCell.innerText,this.inputBox.focus(),this.inputBox.select(),document.execCommand("copy"),t.preventDefault();break;case 70:this.noFinding||(this.$refs.panelFind.showPanel(),t.preventDefault());break;case 71:this.noFindingNext||""===this.inputFind||(this.doFindNext(),t.preventDefault());break;case 76:t.preventDefault(),this.calAutocompleteList(!0);}else{if(0>this.currentRowPos)return;switch(t.keyCode){case 37:// Left Arrow
if(!this.focused)return;this.inputBoxShow?0===this.inputBox.selectionStart&&(this.moveWest(t),t.preventDefault()):(this.moveWest(t),t.preventDefault());break;case 38:// Up Arrow
if(!this.focused)return;t.preventDefault(),0===this.autocompleteInputs.length?this.moveNorth():0<this.autocompleteSelect&&this.autocompleteSelect--;break;case 9:// Tab
case 39:// Right Arrow
if(!this.focused)return;this.inputBoxShow?this.inputBox.selectionEnd===this.inputBox.value.length&&(this.moveEast(t),t.preventDefault()):(this.moveEast(t),t.preventDefault());break;case 40:// Down Arrow
if(!this.focused)return;t.preventDefault(),0===this.autocompleteInputs.length?this.moveSouth(t):this.autocompleteSelect<this.autocompleteInputs.length-1&&this.autocompleteSelect++;break;case 13:// Enter
if(!this.focused)return;if(t.preventDefault(),0===this.autocompleteInputs.length||-1===this.autocompleteSelect)return void(this.moveSouth(t)||(this.inputBoxChanged&&(this.inputCellWrite(this.inputBox.value),this.inputBoxChanged=!1),this.inputBoxShow=0,this.showDatePicker=!1,this.autocompleteInputs=[],this.autocompleteSelect=-1));-1!==this.autocompleteSelect&&this.inputAutocompleteText(this.autocompleteInputs[this.autocompleteSelect]);break;case 27:// Esc
if(!this.focused)return;this.showDatePicker=!1,this.autocompleteInputs=[],this.autocompleteSelect=-1,this.inputBoxShow&&(t.preventDefault(),this.inputBox.value=this.currentCell.innerText,this.inputBoxShow=0,this.inputBoxChanged=!1);break;case 33:this.prevPage(),t.preventDefault();break;case 34:this.nextPage(),t.preventDefault();break;case 8:// Delete
case 46:// BS
if(!this.focused)return;if(this.inputBoxShow)return this.inputBoxChanged=!0,void setTimeout(this.calAutocompleteList);if(this.currentField.readonly)return;if(this.autocompleteInputs.length)return;"select"===this.currentField.type?this.calAutocompleteList(!0):(this.inputBox.value="",this.inputCellWrite(""));break;default:if(!this.focused)return;if(this.currentField.readonly)return;if(t.altKey)return;if("Process"!==t.key&&1<t.key.length)return;if(this.currentField.allowKeys&&-1===this.currentField.allowKeys.indexOf(t.key.toUpperCase()))return t.preventDefault();if(this.currentField.lengthLimit&&this.inputBox.value.length>this.currentField.lengthLimit)return t.preventDefault();if(!this.inputBoxShow){if("select"===this.currentField.type)return void this.calAutocompleteList(!0);if("date"===this.currentField.type)return void this.showDatePickerDiv();this.inputBox.value="",this.inputBoxShow=1,this.inputBox.focus()}this.inputBoxChanged=!0,setTimeout(this.calAutocompleteList);}}},registerColumn(e){let t=this.fields.findIndex(t=>t.pos>e.pos);-1===t&&(t=this.fields.length),this.fields.splice(t,0,e),e.summary&&(this.summaryRow=!0)},moveInputSquare(e,t){if(0>t)return!1;const l=this.recordBody.children[e];if(!l)return e>this.currentRowPos?(this.pageTop+this.pageSize<this.table.length&&(this.pageTop+=1),!1):(0<=this.pageTop-1&&(this.pageTop-=1),!1);// Clear the label markers
this.labelTr.children[this.currentColPos+1].classList.remove("focus"),0<=this.currentRowPos&&this.currentRowPos<this.pagingTable.length&&this.recordBody.children[this.currentRowPos].children[0].classList.remove("focus"),this.inputBoxShow&&(this.inputBoxShow=0),this.inputBoxChanged&&(this.inputCellWrite(this.currentField.toValue(this.inputBox.value)),this.inputBoxChanged=!1);// Relocate the inputSquare
const i=l.children[t+1];if(!i)return!1;this.currentField=this.fields[t];const a=i.getBoundingClientRect(),o=this.systable.getBoundingClientRect();// Adjust the scrolling to display the whole focusing cell
if(this.squareSavedLeft=this.tableContent.scrollLeft,this.inputSquare.style.marginLeft=0,this.inputSquare.style.left=a.left-o.left-1+"px",this.inputSquare.style.top=a.top-o.top-1+"px",this.inputSquare.style.width=a.width+1+"px",this.inputSquare.style.height=a.height+1+"px",this.inputSquare.style.zIndex=this.currentField.sticky?3:1,!this.currentField.sticky){const e=this.$el.getBoundingClientRect();a.right>=e.right-12&&this.tableContent.scrollBy(a.right-e.right+13,0),a.left<=e.left+this.leftMost&&this.tableContent.scrollBy(a.left-e.left-this.leftMost-1,0)}return this.currentRowPos=e,this.currentColPos=t,this.currentCell=i,this.showDatePicker&&(this.showDatePicker=!1),this.autocompleteInputs.length&&(this.autocompleteInputs=[],this.autocompleteSelect=-1),this.recalAutoCompleteList&&clearTimeout(this.recalAutoCompleteList),0<=this.currentRowPos&&this.currentRowPos<this.pagingTable.length&&(this.inputBox.focus(),this.focused=!0,l.children[0].classList.add("focus"),this.labelTr.children[t+1].classList.add("focus")),!0},refresh(){// this.reviseSelectedAfterTableChange()
this.pageTop=0,this.prevSelect=-1,this.calTable(),this.refreshPageSize()},getSelectedRecords(){return this.table.filter((e,t)=>this.selected[t])},deleteSelectedRecords(){this.table=this.table.filter((e,t)=>"undefined"==typeof this.selected[t]),this.selected={},this.selectedCount=0},colSepMouseDown(t){t.preventDefault(),t.stopPropagation(),this.focused=!1;const e=(e,t)=>{window.getComputedStyle(e,null).getPropertyValue(t)};this.sep={},this.sep.curCol=this.colgroupTr.children[Array.from(this.labelTr.children).indexOf(t.target.parentElement)],this.sep.pageX=t.pageX;let l=0;if("border-box"!==e(this.sep.curCol,"box-sizing")){const t=e(this.sep.curCol,"padding-left"),i=e(this.sep.curCol,"padding-right");t&&i&&(l=parseInt(t)+parseInt(i))}// if (this.sep.nxtCol)
//   this.sep.nxtColWidth = this.sep.nxtCol.offsetWidth - padding
this.sep.curColWidth=t.target.parentElement.offsetWidth-l,window.addEventListener("mousemove",this.colSepMouseMove),window.addEventListener("mouseup",this.colSepMouseUp)},colSepMouseOver(t){t.target.style.borderRight="5px solid #cccccc",t.target.style.height=this.systable.getBoundingClientRect().height+"px"},colSepMouseOut(t){t.target.style.borderRight="",t.target.style.height="100%"},colSepMouseMove(t){if(this.sep&&this.sep.curCol){const e=t.pageX-this.sep.pageX;this.sep.curCol.style.width=this.sep.curColWidth+e+"px",this.lazy(this.calStickyLeft)}},colSepMouseUp(t){t.preventDefault(),t.stopPropagation(),delete this.sep,window.removeEventListener("mousemove",this.colSepMouseMove),window.removeEventListener("mouseup",this.colSepMouseUp);const e=this.getSetting();this.remember&&(localStorage[window.location.pathname+"."+this.token]=JSON.stringify(e)),this.$emit("setting",e)},doFindNext(){return this.doFind()},doFind(e){"undefined"==typeof e?e=this.inputFind:this.inputFind=e,e=e.toUpperCase();for(let t=this.currentRowPos+this.pageTop;t<this.table.length;t++){const l=this.table[t];for(let i=t===this.currentRowPos+this.pageTop?this.currentColPos+1:0;i<this.fields.length;i++){const a=this.fields[i].name;if("undefined"!=typeof l[a]&&0<=(l[a]+"").toUpperCase().indexOf(e))return this.pageTop=this.findPageTop(t),setTimeout(()=>{this.moveInputSquare(t-this.pageTop,i),setTimeout(()=>this.inputBox.focus()),this.focused=!0}),!0}}for(let t=0;t<=this.currentRowPos+this.pageTop;t++){const l=this.table[t];for(let i=0;i<(t===this.currentRowPos+this.pageTop?this.currentColPos:this.fields.length);i++){const a=this.fields[i].name;if("undefined"!=typeof l[a]&&0<=(l[a]+"").toUpperCase().indexOf(e))return this.pageTop=this.findPageTop(t),this.moveInputSquare(t-this.pageTop,i),setTimeout(()=>{this.focused=!0}),!0}}return!1},findPageTop(e){for(let t=this.pageTop;t<this.table.length;t+=this.pageSize)if(e>=t&&e<t+this.pageSize)return t;for(let t=this.pageTop;0<t;t-=this.pageSize)if(e>=t&&e<t+this.pageSize)return t;return this.pageTop},headerClick(t,e){1===t.which&&(t.preventDefault(),this.sortPos===e&&0<this.sortDir?this.sort(-1,e):this.sort(1,e))},sort(e,t){this.processing=!0;const l="undefined"==typeof t?this.columnFilterRef.colPos:t,i=this.fields[l].name,a=this.fields[l].type;setTimeout(()=>{"number"===a?this.value.sort((t,l)=>+t[i]>+l[i]?e:+t[i]<+l[i]?-e:0):this.value.sort((t,l)=>t[i]>l[i]?e:t[i]<l[i]?-e:0),this.sortPos=l,this.sortDir=e,this.processing=!1},0)},freezePanelSizeAfterShown(e){const t=e.getBoundingClientRect();e.setAttribute("style",`width:${t.width}px; height:${t.height}px;`)},refreshPageSize(){if(this.$refs.hScroll){const e=this.systable.getBoundingClientRect().width,t=this.tableContent.getBoundingClientRect().width;this.hScroller.tableUnseenWidth=e-t,this.$refs.hScroll.style.width=100*t/e+"%";const l=this.$refs.hScroll.getBoundingClientRect().width;this.hScroller.scrollerUnseenWidth=this.footer.getBoundingClientRect().width-40-l}if(!this.noPaging){const e=this.summaryRow?60:35;this.pageSize=this.page||Ee((window.innerHeight-this.recordBody.getBoundingClientRect().top-e)/24)}else if("auto"===this.height){let e=Ee(window.innerHeight-this.tableContent.getBoundingClientRect().top-25),t=4;this.filterRow&&(t+=29),this.summaryRow&&(t+=25),this.footerRow||(t+=25),e=ke(24*(this.table.length-this.pageTop)+t,e),this.systable.parentNode.style.height=e+"px"}setTimeout(this.calVScroll)},firstPage(t){t&&t.stopPropagation(),this.pageTop=0,this.calVScroll(),setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3)})},lastPage(t){t&&t.stopPropagation(),this.pageTop=0>this.table.length-this.pageSize?0:this.table.length-this.pageSize,this.calVScroll(),setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3)})},prevPage(t){t&&t.stopPropagation(),this.pageTop=this.pageTop<this.pageSize?0:this.pageTop-this.pageSize,this.calVScroll(),setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3)})},nextPage(t){t&&t.stopPropagation(),this.pageTop+this.pageSize<this.table.length&&(this.pageTop=ke(this.pageTop+this.pageSize,this.table.length-this.pageSize)),this.calVScroll(),setTimeout(()=>{this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3)})},rowLabelClick(t){let e=t.target;for(;"TD"!==e.tagName;)e=e.parentNode;const l=+e.getAttribute("pos")+this.pageTop;if(!t.shiftKey){const e=this.selected[l];this.freeSelect||t.ctrlKey||t.metaKey||this.clearAllSelected(),e?this.unSelectRecord(l):this.selectRecord(l)}else if(document.getSelection().removeAllRanges(),-1!==this.prevSelect&&this.prevSelect!==l)if(t.preventDefault(),l>this.prevSelect)for(let e=this.prevSelect;e<=l;e++)this.selectRecord(e);else for(let e=l;e<=this.prevSelect;e++)this.selectRecord(e);this.prevSelect=l},settingClick(){this.$refs.panelSetting.showPanel()},exportTable(e,t){this.processing=!0,setTimeout(()=>{const i=l.utils.book_new();let a=null;a=t?l.utils.json_to_sheet(this.table.filter((e,t)=>this.selected[t]),{header:this.fields.map(e=>e.name)}):l.utils.json_to_sheet(this.table,{header:this.fields.map(e=>e.name)});const o=Array.from(this.labelTr.children).slice(1).map(e=>e.children[0].innerText);l.utils.sheet_add_aoa(a,[o],{origin:0}),a["!cols"]=Array.from(this.labelTr.children).slice(1).map(e=>({width:e.getBoundingClientRect().width/6.5})),l.utils.book_append_sheet(i,a,"Sheet1");"excel"===e?l.writeFile(i,"export.xlsx"):"csv"===e?l.writeFile(i,"export.csv"):void 0;this.processing=!1},500)},selectAllClick(){this.toggleSelectAllRecords()},reviseSelectedAfterTableChange(){this.rowIndex={},this.table.forEach((e,t)=>this.rowIndex[e.$id]=t);const e=Object.assign(this.selected);this.selected={},Object.keys(e).forEach(t=>{const l=e[t];"undefined"!=typeof this.rowIndex[l]&&(this.selected[this.rowIndex[l]]=l)}),this.selectedCount=Object.keys(this.selected).length},toggleSelectRecord(e){"undefined"==typeof this.selected[e]?this.selectRecord(e):this.unSelectRecord(e)},selectRecord(e){"undefined"==typeof this.selected[e]&&(this.selectedCount++,this.selected[e]=this.table[e].$id,this.recordBody.children[e-this.pageTop]&&this.recordBody.children[e-this.pageTop].classList.add("select"),this.lazy(e,e=>{this.$emit("select",e,!0)}))},unSelectRecord(e){"undefined"!=typeof this.selected[e]&&(delete this.selected[e],this.selectedCount--,this.recordBody.children[e-this.pageTop]&&this.recordBody.children[e-this.pageTop].classList.remove("select"),this.lazy(e,e=>{this.$emit("select",e,!1)}))},toggleSelectAllRecords(t){if(t&&t.preventDefault(),this.selectedCount===this.table.length){for(let e=0;e<this.table.length;e++)this.unSelectRecord(e);this.selectedCount=0}else{for(let e=0;e<this.table.length;e++)this.selectRecord(e);this.selectedCount=this.table.length}},clearAllSelected(){// for (let i = 0; i < this.$refs.systable.children[2].children.length; i++)
//  this.unSelectRecord(this.pageTop + i)
this.selected={},this.selectedCount=0},undoTransaction(t){if(t&&t.preventDefault(),0!==this.redo.length){const e=this.redo.pop();e.forEach(e=>{this.updateCell(this.rowIndex[e.$id],e.field,e.oldVal,!0)})}},updateCellByColPos(e,t,l){return this.updateCell(e,this.fields[t],l)},updateCellByName(e,t,l){return this.updateCell(e,this.fields.find(e=>e.name===t),l)},updateCell(e,t,l,i){const a=this.table[e],o=a[t.name],s=this.getKeys(a);a[t.name]=l,setTimeout(()=>{const e={$id:a.$id,keys:this.getKeys(a),oldKeys:s,name:t.name,field:t,oldVal:o,newVal:l,err:""},r=`id-${a.$id}-${t.name}`;null!==t.validate&&(e.err=t.validate(l)),t.mandatory&&""===l&&(e.err+=(e.err?"\n":"")+t.mandatory),""===e.err?delete this.errmsg[r]:(this.errmsg[r]=e.err,this.systable.querySelector("td#"+r).classList.add("error")),this.lazy(e,e=>{this.$emit("update",e),i||this.redo.push(e)},50)})},updateSelectedRows(e,t){this.processing=!0,setTimeout(()=>{Object.keys(this.selected).forEach(l=>this.updateCell(l,e,t)),this.processing=!1},0)},moveTo(e,t){t=t||0,this.moveInputSquare(e,t)},moveWest(){if(this.focused&&0<this.currentColPos){let e=this.currentColPos-1;for(;this.fields[e].invisible&&0<=e;)e--;if(-1==e)return;this.moveInputSquare(this.currentRowPos,e)}},moveEast(){if(this.focused&&this.currentColPos<this.fields.length-1){let e=this.currentColPos+1;for(;this.fields[e].invisible&&e<this.fields.length-1;)e++;if(e===this.fields.length)return;this.moveInputSquare(this.currentRowPos,e)}},moveNorth(){this.focused&&(this.moveInputSquare(this.currentRowPos-1,this.currentColPos),this.calVScroll(),this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3))},moveSouth(){if(this.focused&&this.currentRowPos<this.table.length){const e=this.moveInputSquare(this.currentRowPos+1,this.currentColPos);return this.calVScroll(),this.$refs.vScrollButton.classList.add("focus"),this.lazy(()=>this.$refs.vScrollButton.classList.remove("focus"),1e3),e}return!1},mouseDown(t){if("TBODY"===t.target.parentNode.parentNode.tagName&&!t.target.classList.contains("first-col")){t.preventDefault(),setTimeout(()=>this.inputBox.focus()),this.focused=!0;const e=t.target.parentNode,l=Array.from(e.children).indexOf(t.target)-1,i=Array.from(e.parentNode.children).indexOf(e);if(this.moveInputSquare(i,l),15<t.target.offsetWidth-t.offsetX)return;t.target.classList.contains("select")&&this.calAutocompleteList(!0),t.target.classList.contains("datepick")&&this.showDatePickerDiv()}},cellMouseMove(t){let e="cell";this.inputBoxShow&&(e="default"),!t.target.classList.contains("readonly")&&(t.target.classList.contains("select")||t.target.classList.contains("datepick"))&&15>t.target.offsetWidth-t.offsetX&&(e="pointer"),t.target.style.cursor=e},cellMouseOver(t){const e=t.target;if(e.classList.contains("error")&&(this.tipTimeout&&clearTimeout(this.tipTimeout),""!==(this.tip=this.errmsg[e.getAttribute("id")]))){const t=e.getBoundingClientRect();this.$refs.tooltip.style.top=t.top-14+"px",this.$refs.tooltip.style.left=t.right+8+"px",e.addEventListener("mouseout",this.cellMouseOut)}},cellMouseOut(t){this.tipTimeout=setTimeout(()=>{this.tip=""},1e3),t.target.removeEventListener(t.type,this.cellMouseOut)},mouseOver(){this.mousein=!0},mouseOut(){this.mousein=!1},inputSquareClick(){this.currentField.readonly||this.inputBoxShow||"select"===this.currentField.type||(this.inputBox.value=this.currentCell.innerText,this.inputBoxShow=1,this.inputBox.focus(),this.inputBoxChanged=!1,this.focused=!0)},inputBoxMouseMove(t){let e="text";!this.currentField.readonly&&(this.currentField.options.length||"date"===this.currentField.type)&&15>t.target.offsetWidth-t.offsetX&&(e="pointer"),t.target.style.cursor=e},inputBoxMouseDown(t){15<t.target.offsetWidth-t.offsetX||(this.currentField.options.length&&(t.preventDefault(),this.calAutocompleteList(!0)),"date"===this.currentField.type&&(t.preventDefault(),this.showDatePickerDiv()))},calAutocompleteList(e){!e&&!this.currentField.autocomplete||(e||this.inputBoxChanged&&0<this.inputBox.value.length)&&("undefined"!=typeof this.recalAutoCompleteList&&clearTimeout(this.recalAutoCompleteList),this.recalAutoCompleteList=setTimeout(()=>{if(!e&&(!this.focused||!this.inputBoxShow||!this.inputBoxChanged||!this.inputBox.value.length))return void(this.autocompleteInputs=[]);const t=this.currentField,l=t.name,a=e?"":this.inputBox.value;let o;if(0<t.options.length)o=this.currentField.options;else{o=[];for(let e=0;e<this.table.length;e++){const t=this.table[e];if("undefined"!=typeof t[l]&&t[l].startsWith(a)&&-1===o.indexOf(t[l])&&o.push(t[l]),10<=o.length)break}o.sort()}this.autocompleteSelect=-1,this.autocompleteInputs=o;const s=this.currentCell.getBoundingClientRect();this.$refs.autocomplete.style.top=s.bottom+"px",this.$refs.autocomplete.style.left=s.left+"px",this.$refs.autocomplete.style.minWidth=s.width+"px",this.lazy(()=>{const e=this.$refs.autocomplete.getBoundingClientRect();e.bottom>window.innerHeight&&(this.$refs.autocomplete.style.top=s.top-e.height+"px"),e.right>window.innerWidth&&(this.$refs.autocomplete.style.top=window.innerWidth-e.width+"px")})},e?0:700))},inputAutocompleteText(t,l){l&&l.preventDefault(),setTimeout(()=>{this.inputCellWrite(t),this.autocompleteInputs=[],this.autocompleteSelect=-1,this.inputBoxShow=0,this.inputBoxChanged=!1})},inputCellWrite(e,t,l){let i=this.currentField;"undefined"!=typeof t&&(i=this.fields[t]),"undefined"==typeof l&&(l=this.pageTop+this.currentRowPos),"undefined"==typeof this.selected[l]?this.updateCell(l,i,e):this.updateSelectedRows(i,e)},inputBoxBlur(){this.$refs.dpContainer.querySelector(":hover")||(this.inputBoxChanged&&(this.inputCellWrite(this.inputBox.value),this.inputBoxChanged=!1),this.inputBoxShow=0,this.focused=!1,this.showDatePicker=!1,-1!==this.currentRowPos&&(this.recordBody.children[this.currentRowPos].children[0].classList.remove("focus"),this.labelTr.children[this.currentColPos+1].classList.remove("focus")))},hashCode(e){return e.split("").reduce((e,t)=>e=0|(e<<5)-e+t.charCodeAt(0),0)},lazy(e,t,l){if("function"!=typeof e)return this.lazyBuf(e,t,l);t||(t=20);const i=this.hashCode(e.name+e.toString());this.lazyTimeout[i]&&clearTimeout(this.lazyTimeout[i]),this.lazyTimeout[i]=setTimeout(()=>{e(),delete this.lazyTimeout[i]},t)},lazyBuf(e,t,l){l||(l=20);const i=this.hashCode(t.name+t.toString());this.lazyBuffer[i]?this.lazyBuffer[i].push(e):this.lazyBuffer[i]=[e],this.lazyTimeout[i]&&clearTimeout(this.lazyTimeout[i]),this.lazyTimeout[i]=setTimeout(()=>{t(this.lazyBuffer[i]),delete this.lazyTimeout[i],delete this.lazyBuffer[i]},l)}/*
      selStart (target) {
        this.selTarget = target
        this.selx = Array.from(target.parentNode.children).indexOf(target) - 1
        this.sely = target.parentNode.getAttribute('pos')
      },
      selProcess (target) {
        if (target === null) return
        // const x = Array.from(target.parentNode.children).indexOf(target) - 1
        // const y = target.parentNode.getAttribute('pos')
        this.selEnd(target)
      },
      selEnd (target) {
        if (target !== null && target !== this.selTarget) {
          const st = this.selTarget.getBoundingClientRect()
          const ed = target.getBoundingClientRect()

          if (this.selSquare === null) {
            this.selSquare = document.createElement('div')
            document.body.appendChild(this.selSquare)
          }

          const left = Math.min(st.left, ed.left) - 1
          const top = Math.min(st.top, ed.top) - 1
          const width = Math.max(ed.right - st.left, st.right - ed.left) + 2
          const height = Math.max(ed.bottom - st.top, st.bottom - ed.top) + 2

          this.selSquare.setAttribute('style', `
            left: ${left}px;
            top: ${top}px;
            width: ${width}px;
            height: ${height}px;
            position: absolute;
            border: 2px solid #999966;
            'z-index': 1000;
            background-color: #35456755;
            display: block;
            pointer-events: none;
          `)
        }
      }
      */}};/* script */ /* template */var el=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"vue-excel-editor",style:{display:"inline-block","max-width":e.width}},[l("div",{staticClass:"component-content"},[l("div",{ref:"tableContent",staticClass:"table-content",class:{"no-footer":e.noFooter},on:{scroll:e.tableScroll,mouseover:e.mouseOver,mouseout:e.mouseOut}},[l("table",{ref:"systable",staticClass:"systable",class:{"no-number":e.noNumCol},staticStyle:{"table-layout":"fixed",width:"0"},attrs:{id:"systable",ondragenter:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'",ondragover:"event.preventDefault(); event.dataTransfer.dropEffect = 'none'"}},[l("colgroup",[l("col",{staticStyle:{width:"40px"}}),e._v(" "),e._l(e.fields,function(e,t){return l("col",{key:t,style:{width:e.width}})}),e._v(" "),e.vScroller.buttonHeight<e.vScroller.height?l("col",{staticStyle:{width:"12px"}}):e._e()],2),e._v(" "),l("thead",{staticClass:"center-text"},[l("tr",[l("th",{staticClass:"center-text first-col tl-setting",class:{hide:e.noNumCol},staticStyle:{top:"0"},on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.settingClick(t)}}},[l("span",{staticStyle:{width:"100%"}},[e.processing?l("svg",{staticClass:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}})]):l("svg",{staticClass:"svg-inline--fa fa-bars fa-w-14 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"bars",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"}})])])]),e._v(" "),e._l(e.fields,function(t,i){return l("th",{directives:[{name:"show",rawName:"v-show",value:!t.invisible,expression:"!item.invisible"}],key:"th-"+i,staticClass:"table-col-header",class:{"sort-asc-sign":e.sortPos==i&&1==e.sortDir,"sort-des-sign":e.sortPos==i&&-1==e.sortDir,"sticky-column":t.sticky},style:{left:t.left},attrs:{colspan:i===e.fields.length-1&&e.vScroller.buttonHeight<e.vScroller.height?2:1},on:{mousedown:function(t){return e.headerClick(t,i)}}},[l("div",{class:{"filter-sign":e.columnFilter[i]}},[l("span",{domProps:{innerHTML:e._s(e.headerLabel(t.label,t))}})]),e._v(" "),l("div",{staticClass:"col-sep",on:{mousedown:e.colSepMouseDown,mouseover:e.colSepMouseOver,mouseout:e.colSepMouseOut}})])})],2),e._v(" "),l("tr",{class:{hide:!e.filterRow}},[l("td",{staticClass:"center-text first-col tl-filter",class:{hide:e.noNumCol},style:{top:e.calCellTop2+"px"},on:{click:e.selectAllClick}},[e.selectedCount==e.table.length?l("svg",{staticClass:"svg-inline--fa fa-times-circle fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"times-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"}})]):l("svg",{staticClass:"svg-inline--fa fa-check-circle fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"check-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}})])]),e._v(" "),e._l(e.fields,function(t,i){return l("vue-excel-filter",{directives:[{name:"show",rawName:"v-show",value:!t.invisible,expression:"!item.invisible"}],key:"th2-"+i,staticClass:"column-filter",class:{"sticky-column":t.sticky},style:{left:t.left},attrs:{colspan:i===e.fields.length-1?2:1},model:{value:e.columnFilter[i],callback:function(t){e.$set(e.columnFilter,i,t)},expression:"columnFilter[p]"}})})],2)]),e._v(" "),l("tbody",{on:{mousedown:function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.mouseDown(t)}}},e._l(e.pagingTable,function(t,i){return l("tr",{key:i,class:{select:"undefined"!=typeof e.selected[e.pageTop+i]},style:e.rowStyle(t)},[l("td",{staticClass:"center-text first-col",class:{hide:e.noNumCol},attrs:{pos:i},on:{click:e.rowLabelClick}},[l("span",{domProps:{innerHTML:e._s(e.recordLabel(e.pageTop+i+1,t))}})]),e._v(" "),e._l(e.fields,function(i,a){return[l("td",{directives:[{name:"show",rawName:"v-show",value:!i.invisible,expression:"!item.invisible"}],key:a,class:{readonly:i.readonly,error:e.errmsg["id-"+t.$id+"-"+i.name],select:i.options.length,datepick:"date"==i.type,"sticky-column":i.sticky},style:Object.assign(e.cellStyle(t,i),e.columnCellStyle(i)),attrs:{id:"id-"+t.$id+"-"+i.name},on:{mouseover:e.cellMouseOver,mousemove:e.cellMouseMove}},[e._v(e._s(i.toText(t[i.name])))])]}),e._v(" "),e.vScroller.buttonHeight<e.vScroller.height?l("td",{staticClass:"last-col"}):e._e()],2)}),0),e._v(" "),l("tfoot",[l("tr",{directives:[{name:"show",rawName:"v-show",value:e.summaryRow,expression:"summaryRow"}]},[l("td",{staticClass:"row-summary first-col"},[e._v("\xA0")]),e._v(" "),e._l(e.fields,function(t,i){return[l("td",{directives:[{name:"show",rawName:"v-show",value:!t.invisible,expression:"!field.invisible"}],key:"f"+i,staticClass:"row-summary",class:{"sticky-column":t.sticky,"summary-column1":i+1<e.fields.length&&e.fields[i+1].summary,"summary-column2":t.summary},style:e.columnCellStyle(t),attrs:{colspan:i===e.fields.length-1&&e.vScroller.buttonHeight<e.vScroller.height?2:1}},[e._v(e._s(e.summary(t)))])]})],2)]),e._v(" "),e._t("default")],2),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:e.tip,expression:"tip"}],ref:"tooltip",staticClass:"tool-tip"},[e._v(e._s(e.tip))]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:e.focused,expression:"focused"}],ref:"inputSquare",staticClass:"input-square",on:{mousedown:e.inputSquareClick}},[l("div",{staticStyle:{position:"relative",height:"100%",padding:"2px 2px 1px"}},[l("div",{staticClass:"rb-square"}),e._v(" "),l("textarea",{ref:"inputBox",staticClass:"input-box",style:{opacity:e.inputBoxShow},attrs:{id:"inputBox",trim:"",autocomplete:"off",autocorrect:"off",autocompitaize:"off",spellcheck:"false"},on:{blur:e.inputBoxBlur,mousemove:e.inputBoxMouseMove,mousedown:e.inputBoxMouseDown}})])]),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:e.showDatePicker,expression:"showDatePicker"}],ref:"dpContainer",staticStyle:{"z-index":"20",position:"fixed"}},[l("date-picker",{ref:"datepicker",attrs:{inline:"",valueType:"format"},on:{input:e.dpClick},model:{value:e.inputDateTime,callback:function(t){e.inputDateTime=t},expression:"inputDateTime"}})],1),e._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:e.processing,expression:"processing"}],ref:"frontdrop",staticClass:"front-drop"},[l("svg",{staticClass:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-3x",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}})])])]),e._v(" "),e.vScroller.buttonHeight<e.vScroller.height?l("div",{ref:"vScroll",staticClass:"v-scroll",style:{top:e.vScroller.top+"px",height:e.vScroller.height+"px"},on:{mousedown:e.vsMouseDown}},[l("div",{ref:"vScrollButton",staticClass:"v-scroll-button",style:{marginTop:e.vScroller.buttonTop+"px",height:e.vScroller.buttonHeight+"px"},on:{mousedown:e.vsbMouseDown}},[l("div",{directives:[{name:"show",rawName:"v-show",value:e.vScroller.runner,expression:"vScroller.runner"}],staticClass:"runner",domProps:{innerHTML:e._s(e.vScroller.runner)}})])]):e._e(),e._v(" "),l("ul",{directives:[{name:"show",rawName:"v-show",value:e.focused&&e.autocompleteInputs.length,expression:"focused && autocompleteInputs.length"}],ref:"autocomplete",staticClass:"autocomplete-results"},e._l(e.autocompleteInputs,function(t,a){return l("li",{key:a,staticClass:"autocomplete-result",class:{select:e.autocompleteSelect===a},on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:(t.preventDefault(),e.inputAutocompleteText(t.target.textContent,t))}}},[e._v(e._s(t))])}),0),e._v(" "),l("div",{ref:"footer",staticClass:"footer center-text",class:{hide:e.noFooter},staticStyle:{position:"relative"},on:{mousedown:e.ftMouseDown}},[l("div",{ref:"hScroll",staticClass:"h-scroll",on:{mousedown:e.sbMouseDown}}),e._v(" "),l("span",{staticClass:"left-block"}),e._v(" "),l("span",{directives:[{name:"show",rawName:"v-show",value:!e.noPaging,expression:"!noPaging"}],staticStyle:{position:"absolute",left:"46px"}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerLeft(e.pageTop+1,e.pageBottom,e.table.length))}})]),e._v(" "),l("span",{directives:[{name:"show",rawName:"v-show",value:!e.noPaging&&e.pageBottom-e.pageTop<e.table.length,expression:"!noPaging && pageBottom - pageTop < table.length"}]},[e.processing?[l("svg",{staticClass:"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"spinner",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}})]),e._v("\n          \xA0\n          "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.processing)}})]:[l("a",{class:{disabled:0>=e.pageTop},on:{mousedown:e.firstPage}},[l("svg",{staticClass:"svg-inline--fa fa-step-backward fa-w-14 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"step-backward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"}})]),e._v("\n            \xA0\n            "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.first)}})]),e._v("\n          \xA0|\xA0\n          "),l("a",{class:{disabled:0>=e.pageTop},on:{mousedown:e.prevPage}},[l("svg",{staticClass:"svg-inline--fa fa-backward fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"backward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z"}})]),e._v("\n            \xA0\n            "),l("span",{domProps:{innerHTML:e._s(e.localizedLabel.previous)}})]),e._v("\n          \xA0|\xA0\n          "),l("a",{class:{disabled:e.pageTop+e.pageSize>=e.table.length},on:{mousedown:e.nextPage}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.next)}}),e._v("\n            \xA0\n            "),l("svg",{staticClass:"svg-inline--fa fa-forward fa-w-16 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"forward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[l("path",{attrs:{fill:"currentColor",d:"M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z"}})])]),e._v("\n          \xA0|\xA0\n          "),l("a",{class:{disabled:e.pageTop+e.pageSize>=e.table.length},on:{mousedown:e.lastPage}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.last)}}),e._v("\n            \xA0\n            "),l("svg",{staticClass:"svg-inline--fa fa-step-forward fa-w-14 fa-sm",attrs:{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"step-forward",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"}},[l("path",{attrs:{fill:"currentColor",d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"}})])])]],2),e._v(" "),l("span",{staticStyle:{position:"absolute",right:"6px"}},[l("a",{class:{disabled:!e.showSelectedOnly&&1>=e.selectedCount},on:{mousedown:e.toggleSelectView}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerRight.selected)}}),e._v(" "),l("span",{style:{color:0<e.selectedCount?"red":"inherit"}},[e._v(e._s(e.selectedCount))])]),e._v("\n        \xA0|\xA0\n        "),l("a",{class:{disabled:"{}"===e.columnFilterString},on:{mousedown:e.toggleFilterView}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerRight.filtered)}}),e._v(" "),l("span",{style:{color:e.table.length===e.value.length?"inherit":"red"}},[e._v(e._s(e.table.length))])]),e._v("\n        \xA0|\xA0\n        "),l("a",{class:{disabled:!0}},[l("span",{domProps:{innerHTML:e._s(e.localizedLabel.footerRight.loaded)}}),e._v(" "),l("span",[e._v(e._s(e.value.length))])])])]),e._v(" "),l("input",{ref:"importFile",staticStyle:{width:"0",height:"0",opacity:"0","z-index":"-1"},attrs:{type:"file",accept:".xlsx, .xls, xlsm, .csv"},on:{change:e.doImport}}),e._v(" "),l("panel-filter",{ref:"panelFilter",attrs:{"m-filter-count":e.nFilterCount,"localized-label":e.localizedLabel}}),e._v(" "),l("panel-setting",{ref:"panelSetting",attrs:{"localized-label":e.localizedLabel},model:{value:e.fields,callback:function(t){e.fields=t},expression:"fields"}}),e._v(" "),l("panel-find",{ref:"panelFind",attrs:{"localized-label":e.localizedLabel}})],1)])};el._withStripped=!0;/* style */const tl=a({render:el,staticRenderFns:[]},function(e){e&&e("data-v-b8884846_0",{source:"\ninput[data-v-b8884846]:focus, input[data-v-b8884846]:active:focus, input.active[data-v-b8884846]:focus {\n  outline: none;\n  box-shadow: inset 0 -1px 0 #ddd;\n}\n*[data-v-b8884846], *[data-v-b8884846]::before, *[data-v-b8884846]::after {\n  box-sizing: border-box;\n}\n.input-square[data-v-b8884846] {\n  position: absolute;\n  padding: 0;\n  z-index: 4;\n  border: 2px solid rgb(108, 143, 108);\n  /* transition: all 0.04s linear; */\n}\n.no-transition[data-v-b8884846] {\n  transition: none !important;\n}\n.autocomplete-results[data-v-b8884846] {\n  z-index: 15;\n  position: fixed;\n  padding: 3px;\n  margin: -1px;\n  background-color: lightyellow;\n  border: 1px solid rgb(108, 143, 108);\n  height: fit-content;\n  font-size: 0.88rem;\n  max-width: 300px;\n}\n.autocomplete-result[data-v-b8884846] {\n  list-style: none;\n  text-align: left;\n  padding: 4px 2px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  cursor: pointer\n}\n.autocomplete-result.select[data-v-b8884846] {\n  background-color: lightsteelblue;\n}\n.rb-square[data-v-b8884846] {\n  width: 9px;\n  height: 9px;\n  border-top: 2px solid white;\n  border-left: 2px solid white;\n  border-bottom: 0;\n  border-right: 0;\n  background-color:rgb(108, 143, 108);\n  position: absolute;\n  bottom: -3px;\n  right: -2px;\n  cursor: crosshair;\n}\n.input-box[data-v-b8884846] {\n  opacity: 0;\n  font-family: inherit;\n  color: inherit;\n  text-shadow: inherit;\n  font-size: 0.88rem;\n  width: 100%;\n  height: 100%;\n  border: 0;\n  resize: none;\n  white-space: nowrap;\n  overflow: hidden;\n  background: white;\n}\n.component-content[data-v-b8884846] {\n  display: flex;\n  flex-flow: column;\n  position: relative;\n  max-width:fit-content;\n  word-spacing: 0.02rem;\n  line-height: 1.1;\n  overflow: hidden;\n  border: 1px solid lightgray;\n}\n.center-text[data-v-b8884846] {\n  text-align: center;\n}\n.table-content[data-v-b8884846] {\n  flex: 1 1 auto;\n  font-size: 1rem;\n  text-shadow: 0.3px 0.3px 1px #ccc;\n  overflow: scroll;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  position: relative;\n  width: 100%;\n  scrollbar-width: none;\n}\n.table-content[data-v-b8884846] :focus {\n  outline: none;\n}\n.table-content[data-v-b8884846]::-webkit-scrollbar {\n  background: white;\n  width: 0;\n  height: 0;\n}\n.table-content.no-footer[data-v-b8884846] {\n  border-bottom: 0;\n}\n.table-content.no-footer[data-v-b8884846]::-webkit-scrollbar {\n  height: 0;\n}\n.table-content[data-v-b8884846]::-webkit-scrollbar-thumb {\n  background: #eeee;\n}\n.table-content[data-v-b8884846]::-webkit-scrollbar-thumb:hover {\n  background: #9999;\n}\n.systable[data-v-b8884846] {\n  z-index: -1;\n  width: fit-content;\n  border: 0;\n  border-collapse: separate;\n  border-spacing: 0;\n  margin-bottom: 0;\n  /* margin-left: 40px; */\n}\n.systable .last-col[data-v-b8884846] {\n  width: 12px;\n}\n.systable.no-number[data-v-b8884846] {\n  margin-left: 0 !important;\n}\n.systable tbody tr[data-v-b8884846] {\n  background-color: white;\n  text-align: left;\n}\n.systable tr.select td[data-v-b8884846] {\n  background-color: darkgrey !important;\n}\n.systable th[data-v-b8884846], .systable td[data-v-b8884846] {\n  vertical-align: bottom;\n  padding: 0.2rem 0.3rem;\n  font-size: 0.88rem;\n  height: 24px;\n  border-top: 0;\n  border-left: 0;\n}\n.systable th[data-v-b8884846]:not(:last-child) {\n  border-right: 1px solid lightgray;\n}\n.systable tbody td[data-v-b8884846] {\n  cursor: cell;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  /* animation: fadein 0.2s; */\n}\n.systable tbody td.error[data-v-b8884846] {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAAAGZJREFUOBGlzjsOgDAMA9CwcQSO0PtP3K64Qyugv8S2ZMXTUw5DstmFk8qWAuhEbzSzbQ+oWIPKULAPpGAdxGJDiMGmUBRbQhFsC3kxF+TB3NAOC0ErLAzNMAoaYTT0xyTojclQxR5H5B1HhuS+WAAAAABJRU5ErkJggg==');\n  background-repeat: no-repeat;\n  background-size: 8px 8px;\n  background-position: right 0px top 0px;\n}\n.systable tbody tr:not(:last-child) td[data-v-b8884846] {\n  border-bottom: 1px solid lightgray;\n}\n.systable td[data-v-b8884846]:not(:last-child) {\n  border-right: 1px solid lightgray;\n}\n.systable thead th[data-v-b8884846], .systable thead td[data-v-b8884846] {\n  padding: 0.4rem 0.3rem;\n  font-weight: 400;\n  top: 0;\n  height: 29px;\n  position: sticky;\n  z-index: 5;\n  border-bottom: 1px solid lightgray;\n}\n.systable thead th[data-v-b8884846] {\n  background-color: #e9ecef !important;\n  cursor: s-resize;\n  z-index: 6;\n}\n.systable thead td.column-filter[data-v-b8884846] {\n  text-align: left;\n  background-color: #fffff2;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n}\n.systable th.focus[data-v-b8884846] {\n  border-bottom: 1px solid rgb(61, 85, 61) !important;\n}\n.systable td.first-col.focus[data-v-b8884846] {\n  border-right: 1px solid rgb(61, 85, 61) !important;\n}\n.systable tbody td.select[data-v-b8884846]:not(.readonly) {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC');\n  background-repeat: no-repeat;\n  background-size: 8px 8px;\n  background-position: right 5px top 8px;\n}\n.systable tbody td.datepick[data-v-b8884846]:not(.readonly) {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC');\n  background-repeat: no-repeat;\n  background-size: 8px 8px;\n  background-position: right 5px top 8px;\n}\n.systable .first-col[data-v-b8884846] {\n  background:#e9ecef;\n  width: 40px;\n  position: sticky;\n  left: 0;\n  top: auto;\n  cursor: e-resize !important;\n  text-overflow: inherit !important;\n  text-align: center;\n  overflow: hidden;\n  z-index: 5;\n}\n.systable .sticky-column[data-v-b8884846] {\n  position: sticky;\n  z-index: 2;\n  background-color: white;\n}\n.systable thead th.sticky-column[data-v-b8884846] {\n  z-index: 7;\n}\n.systable thead td.sticky-column[data-v-b8884846] {\n  z-index: 6;\n}\n.systable thead .tl-setting[data-v-b8884846] {\n  /*\n  display: flex;\n  flex-direction: column-reverse;\n  height: 100%;\n  */\n}\n.systable thead td.first-col[data-v-b8884846], .systable thead th.first-col[data-v-b8884846] {\n  cursor: pointer !important;\n  z-index: 10;\n}\n.systable tfoot .row-summary[data-v-b8884846] {\n  height: 25px;\n  border-right: 0;\n  border-top: 1px solid lightgray;\n  position: sticky;\n  bottom: 0;\n  z-index: 4;\n  background: #fffff2;\n}\n.systable tfoot .row-summary.sticky-column[data-v-b8884846] {\n  z-index: 5;\n}\n.systable tfoot .row-summary.summary-column1[data-v-b8884846] {\n  border-right: 1px solid lightgray;\n}\n.systable tfoot .row-summary.summary-column2[data-v-b8884846] {\n  border-right: 1px solid lightgray;\n  background: white;\n}\n.systable tfoot .row-summary[data-v-b8884846]:last-child {\n  border-right: 0 !important;\n}\n.systable tfoot .row-summary.first-col[data-v-b8884846] {\n  height: 25px;\n  border-top: 1px solid lightgray;\n  border-right: 1px solid lightgray;\n  background: #e9ecef;\n  position: sticky;\n  left: 0;\n  top: auto;\n  z-index: 6;\n}\n.footer[data-v-b8884846] {\n  z-index: 5;\n  padding: 0;\n  font-size: 12px;\n  color: dimgray;\n  background-color: white;\n  width: 100%;\n  height: 25px;\n  line-height: 2.3;\n  border-top: 1px solid lightgray;\n  user-select: none;\n}\n.footer .left-block[data-v-b8884846] {\n  position: absolute;\n  left: 0;\n  height: 25px;\n  width: 40px;\n  background-color: #e9ecef;\n  border-right: 1px solid lightgray;\n}\n.h-scroll[data-v-b8884846] {\n  z-index: -1;\n  position: absolute;\n  background-color: #f4f6f9;\n  height: 25px;\n  margin-left: 40px;\n  width: 65%;\n  cursor: pointer;\n}\n.h-scroll[data-v-b8884846]:hover, .h-scroll.focus[data-v-b8884846], .footer:hover .h-scroll[data-v-b8884846] {\n  background-color: lightgray;\n}\n.footer a[data-v-b8884846] {\n  cursor: pointer;\n  color: #007bff;\n}\n.footer a.disabled[data-v-b8884846] {\n  cursor: not-allowed;\n  color: gray;\n  pointer-events: none;\n}\n.footer a[data-v-b8884846]:hover {\n  text-decoration: underline;\n}\n.v-scroll[data-v-b8884846] {\n  display: inline-block;\n  position: absolute;\n  right: 0;\n  width: 13px;\n  z-index: 5;\n  background-color: white;\n  border-left: 1px solid lightgray;\n  user-select: none;\n}\n.v-scroll-button[data-v-b8884846] {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  z-index: 10;\n  background-color: #f4f6f9;\n  cursor: pointer;\n}\n.v-scroll-button.focus[data-v-b8884846], .v-scroll-button[data-v-b8884846]:hover, .v-scroll:hover .v-scroll-button[data-v-b8884846] {\n  background-color: lightgray;\n}\n.runner[data-v-b8884846] {\n  font-size: 0.88rem;\n  padding: 0.5rem;\n  position: absolute;\n  right: 23px;\n  top: 4px;\n  display: inline-block;\n  width: fit-content;\n  z-index: 10;\n  background-color: lightsteelblue;\n  border-radius: 3px;\n  white-space: nowrap;\n}\n.runner[data-v-b8884846]:before {\n  content: '';\n  display: block;\n  width: 0;\n  height: 0;\n  position: absolute;\n  border-top: 4px solid transparent;\n  border-bottom: 8px solid transparent;\n  border-left: 8px solid lightsteelblue;\n  right: -8px;\n  top: 4px;\n}\n.front-drop[data-v-b8884846] {\n  position: fixed;\n  opacity: 0.4;\n  display:flex;\n  justify-content:center;\n  align-items:center;\n  background-color: #55555555;\n  color: white;\n  z-index: 1000;\n}\na[data-v-b8884846]:disabled {\n  cursor: not-allowed;\n  color: gray;\n  pointer-events: none;\n}\n.col-sep[data-v-b8884846] {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 5px;\n  cursor: col-resize;\n  height: 100%;\n  z-index: 15;\n}\n.sort-asc-sign[data-v-b8884846] {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAMAAADzN3VRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAeUExURQAAAK+np6+qqq+rq62pqa+rq6+rq6+srK+rq6+rq2v5ERwAAAAJdFJOUwAgYHCAv8/f71KXockAAAAJcEhZcwAAFxEAABcRAcom8z8AAABNSURBVChT7clRAoAgCATRtTLq/hcuBEN0j9B8zoNV76j6s37hsh+a+NWknQ3l8pGTAk4KlAwIdVgoYKIREmUYaIaPVnBi0IjDS2cA8AC8JAq/VhDqzAAAAABJRU5ErkJggg==');\n  background-repeat: no-repeat;\n  background-size: 9px 9px;\n  background-position: right 5px top 5px;\n}\n.sort-des-sign[data-v-b8884846] {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAYCAMAAAA4a6b0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAkUExURQAAAK+np6+qqq+rq6+pqa+qqq+rq6+rq6+rq6+srK+rq6+rqzDc2iQAAAALdFJOUwAgMEBQYHC/z9/v4u0IugAAAAlwSFlzAAAXEQAAFxEByibzPwAAAFVJREFUKFPtyVEWgCAIRFHC1HL2v98o53SEWELvC+bK0nYor5CeGCkZICUdBhkRjAoX9oLlqCzgyAOwc5caAKgT2gdIGQDNgGfM6Knzv+vcZr8kInIBUrIMxVKQeVsAAAAASUVORK5CYII=');\n  background-repeat: no-repeat;\n  background-size: 9px 9px;\n  background-position: right 5px top 5px;\n}\n.filter-sign[data-v-b8884846] {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAlCAMAAABiU6n+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAhUExURQAAAK+vr6+np6+qqq+pqa+qqq2pqa+srK+srK+rq6+rq01/tHwAAAAKdFJOUwAQIDBQYICv3+8SoWj4AAAACXBIWXMAABcRAAAXEQHKJvM/AAAAiUlEQVQ4T+3OOxaAMAhEUfwmsv8FazLjMRBiZ+er4ExzJelLSSZeUccisvMO2uUq8+nKU5lXfl1bWWWkS1gHuuJCoa66UKCDCwU6ulCnu13I6x4XcrrGhYyudSGjMy7U6KwLPTrvQhwDV42jaueqcVTl7+L4zzaO386Zv+teZ/6u9xXzcK2zXUVOdLIT4IImCksAAAAASUVORK5CYII=');\n  background-repeat: no-repeat;\n  background-size: 9px 9px;\n  background-position: right 0px bottom 0px;\n}\n.hide[data-v-b8884846] {\n  display: none !important;\n}\n@keyframes fadein-data-v-b8884846 {\nfrom {opacity: 0}\nto {opacity: 1}\n}\n.fa-spin[data-v-b8884846] {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14[data-v-b8884846] {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16[data-v-b8884846] {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw[data-v-b8884846] {\n  width: 1.25em;\n}\n.svg-inline--fa[data-v-b8884846] {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw[data-v-b8884846] {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs[data-v-b8884846] {\n  font-size: 0.75em;\n}\n.fa-sm[data-v-b8884846] {\n  font-size: 0.875em;\n}\n.fa-3x[data-v-b8884846] {\n  font-size: 3em;\n}\n.tool-tip[data-v-b8884846] {\n  display: inline-block;\n  position: fixed;\n  color: white;\n  background-color: red;\n  padding: 0.5rem;\n  min-height: 1rem;\n  max-width: 200px;\n  word-wrap: break-word;\n  border-radius: 4px;\n  z-index: 50;\n}\n.tool-tip[data-v-b8884846]:before {\n  content: '';\n  display: block;\n  width: 0;\n  height: 0;\n  position: absolute;\n  border-top: 8px solid transparent;\n  border-bottom: 8px solid transparent;\n  border-right: 8px solid red;\n  left: -8px;\n  top: 8px;\n}\n",map:{version:3,sources:["/Users/can/vuejs/hello-world/plugins/VueExcelEditor/src/VueExcelEditor.vue"],names:[],mappings:";AA80DA;EACA,aAAA;EACA,+BAAA;AACA;AACA;EACA,sBAAA;AACA;AACA;EACA,kBAAA;EACA,UAAA;EACA,UAAA;EACA,oCAAA;EACA,kCAAA;AACA;AACA;EACA,2BAAA;AACA;AACA;EACA,WAAA;EACA,eAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,oCAAA;EACA,mBAAA;EACA,kBAAA;EACA,gBAAA;AACA;AACA;EACA,gBAAA;EACA,gBAAA;EACA,gBAAA;EACA,mBAAA;EACA,gBAAA;EACA,uBAAA;EACA;AACA;AACA;EACA,gCAAA;AACA;AACA;EACA,UAAA;EACA,WAAA;EACA,2BAAA;EACA,4BAAA;EACA,gBAAA;EACA,eAAA;EACA,mCAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,iBAAA;AACA;AACA;EACA,UAAA;EACA,oBAAA;EACA,cAAA;EACA,oBAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,SAAA;EACA,YAAA;EACA,mBAAA;EACA,gBAAA;EACA,iBAAA;AACA;AACA;EACA,aAAA;EACA,iBAAA;EACA,kBAAA;EACA,qBAAA;EACA,qBAAA;EACA,gBAAA;EACA,gBAAA;EACA,2BAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;EACA,eAAA;EACA,iCAAA;EACA,gBAAA;EACA,2BAAA;EACA,yBAAA;EACA,wBAAA;EACA,sBAAA;EACA,qBAAA;EACA,iBAAA;EACA,kBAAA;EACA,WAAA;EACA,qBAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,iBAAA;EACA,QAAA;EACA,SAAA;AACA;AACA;EACA,gBAAA;AACA;AACA;EACA,SAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;EACA,iBAAA;EACA,gBAAA;EACA,uBAAA;AACA;AACA;EACA,WAAA;AACA;AACA;EACA,yBAAA;AACA;AACA;EACA,uBAAA;EACA,gBAAA;AACA;AACA;EACA,qCAAA;AACA;AACA;EACA,sBAAA;EACA,sBAAA;EACA,kBAAA;EACA,YAAA;EACA,aAAA;EACA,cAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;EACA,YAAA;EACA,mBAAA;EACA,kBAAA;EACA,uBAAA;EACA,4BAAA;AACA;AACA;EACA,mTAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,kCAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;EACA,sBAAA;EACA,gBAAA;EACA,MAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;EACA,kCAAA;AACA;AACA;EACA,oCAAA;EACA,gBAAA;EACA,UAAA;AACA;AACA;EACA,gBAAA;EACA,yBAAA;EACA,mBAAA;EACA,kBAAA;EACA,uBAAA;AACA;AACA;EACA,mDAAA;AACA;AACA;EACA,kDAAA;AACA;AACA;EACA,2VAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,2VAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,kBAAA;EACA,WAAA;EACA,gBAAA;EACA,OAAA;EACA,SAAA;EACA,2BAAA;EACA,iCAAA;EACA,kBAAA;EACA,gBAAA;EACA,UAAA;AACA;AACA;EACA,gBAAA;EACA,UAAA;EACA,uBAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA;;;;GAIA;AACA;AACA;EACA,0BAAA;EACA,WAAA;AACA;AACA;EACA,YAAA;EACA,eAAA;EACA,+BAAA;EACA,gBAAA;EACA,SAAA;EACA,UAAA;EACA,mBAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,iCAAA;AACA;AACA;EACA,iCAAA;EACA,iBAAA;AACA;AACA;EACA,0BAAA;AACA;AACA;EACA,YAAA;EACA,+BAAA;EACA,iCAAA;EACA,mBAAA;EACA,gBAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AACA;AACA;EACA,UAAA;EACA,UAAA;EACA,eAAA;EACA,cAAA;EACA,uBAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,+BAAA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;EACA,OAAA;EACA,YAAA;EACA,WAAA;EACA,yBAAA;EACA,iCAAA;AACA;AACA;EACA,WAAA;EACA,kBAAA;EACA,yBAAA;EACA,YAAA;EACA,iBAAA;EACA,UAAA;EACA,eAAA;AACA;AACA;EACA,2BAAA;AACA;AAEA;EACA,eAAA;EACA,cAAA;AACA;AACA;EACA,mBAAA;EACA,WAAA;EACA,oBAAA;AACA;AACA;EACA,0BAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;EACA,UAAA;EACA,uBAAA;EACA,gCAAA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;EACA,qBAAA;EACA,WAAA;EACA,WAAA;EACA,yBAAA;EACA,eAAA;AACA;AACA;EACA,2BAAA;AACA;AACA;EACA,kBAAA;EACA,eAAA;EACA,kBAAA;EACA,WAAA;EACA,QAAA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,gCAAA;EACA,kBAAA;EACA,mBAAA;AACA;AACA;EACA,WAAA;EACA,cAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,iCAAA;EACA,oCAAA;EACA,qCAAA;EACA,WAAA;EACA,QAAA;AACA;AAEA;EACA,eAAA;EACA,YAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,2BAAA;EACA,YAAA;EACA,aAAA;AACA;AACA;EACA,mBAAA;EACA,WAAA;EACA,oBAAA;AACA;AACA;EACA,kBAAA;EACA,MAAA;EACA,QAAA;EACA,UAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;AACA;AACA;EACA,2XAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,+YAAA;EACA,4BAAA;EACA,wBAAA;EACA,sCAAA;AACA;AACA;EACA,+cAAA;EACA,4BAAA;EACA,wBAAA;EACA,yCAAA;AACA;AACA;EACA,wBAAA;AACA;AACA;AACA,MAAA,UAAA;AACA,IAAA,UAAA;AACA;AAEA;EACA,6CAAA;EACA,qCAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,UAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;EACA,iBAAA;EACA,wBAAA;AACA;AACA;EACA,kBAAA;EACA,aAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,cAAA;AACA;AACA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;EACA,qBAAA;EACA,eAAA;EACA,gBAAA;EACA,gBAAA;EACA,qBAAA;EACA,kBAAA;EACA,WAAA;AACA;AACA;EACA,WAAA;EACA,cAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,iCAAA;EACA,oCAAA;EACA,2BAAA;EACA,UAAA;EACA,QAAA;AACA",file:"VueExcelEditor.vue",sourcesContent:["<template>\n  <div class=\"vue-excel-editor\" :style=\"{display: 'inline-block', 'max-width': width}\">\n    <div class=\"component-content\">\n      <div ref=\"tableContent\"\n           class=\"table-content\"\n           :class=\"{'no-footer': noFooter}\"\n           @scroll=\"tableScroll\"\n           @mouseover=\"mouseOver\"\n           @mouseout=\"mouseOut\">\n\n        <!-- Main Table -->\n        <table ref=\"systable\"\n              id=\"systable\"\n              style=\"table-layout: fixed; width: 0\"\n              class=\"systable\"\n              :class=\"{'no-number': noNumCol}\"\n              ondragenter=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\"\n              ondragover=\"event.preventDefault(); event.dataTransfer.dropEffect = 'none'\">\n          <colgroup>\n            <col style=\"width:40px\">\n            <col v-for=\"(item, p) in fields\" :key=\"p\" :style=\"{width: item.width}\">\n            <col v-if=\"vScroller.buttonHeight < vScroller.height\" style=\"width:12px\">\n          </colgroup>\n          <thead class=\"center-text\">\n            <tr>\n              <th class=\"center-text first-col tl-setting\"\n                  :class=\"{hide: noNumCol}\"\n                  style=\"top: 0\"\n                  @mousedown.left=\"settingClick\">\n                <span style=\"width:100%\">\n                  <svg v-if=\"processing\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"spinner\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm\"><path fill=\"currentColor\" d=\"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z\"></path></svg>\n                  <svg v-else aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"bars\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-bars fa-w-14 fa-sm\"><path fill=\"currentColor\" d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"></path></svg>\n                </span>\n              </th>\n              <th v-for=\"(item, p) in fields\"\n                  v-show=\"!item.invisible\"\n                  :key=\"`th-${p}`\"\n                  :colspan=\"p === fields.length - 1 && vScroller.buttonHeight < vScroller.height ? 2: 1\"\n                  :class=\"{'sort-asc-sign': sortPos==p && sortDir==1,\n                          'sort-des-sign': sortPos==p && sortDir==-1,\n                          'sticky-column': item.sticky}\"\n                  class=\"table-col-header\"\n                  :style=\"{left: item.left}\"\n                  @mousedown=\"headerClick($event, p)\">\n                <div :class=\"{'filter-sign': columnFilter[p]}\">\n                  <span v-html=\"headerLabel(item.label, item)\"></span>\n                </div>\n                <div class=\"col-sep\"\n                    @mousedown=\"colSepMouseDown\"\n                    @mouseover=\"colSepMouseOver\"\n                    @mouseout=\"colSepMouseOut\" />\n              </th>\n            </tr>\n            <tr :class=\"{hide: !filterRow}\">\n              <td class=\"center-text first-col tl-filter\"\n                  :class=\"{hide: noNumCol}\"\n                  :style=\"{top: calCellTop2 + 'px'}\"\n                  @click=\"selectAllClick\">\n                <svg v-if=\"selectedCount==table.length\" aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"times-circle\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-times-circle fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z\"></path></svg>\n                <svg v-else aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"check-circle\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-check-circle fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z\"></path></svg>\n              </td>\n              <vue-excel-filter v-for=\"(item, p) in fields\"\n                                v-show=\"!item.invisible\"\n                                :colspan=\"p === fields.length - 1? 2: 1\"\n                                :key=\"`th2-${p}`\"\n                                v-model=\"columnFilter[p]\"\n                                :class=\"{'sticky-column': item.sticky}\"\n                                :style=\"{left: item.left}\"\n                                class=\"column-filter\" />\n            </tr>\n          </thead>\n          <tbody @mousedown.exact=\"mouseDown\">\n            <tr v-for=\"(record, rowPos) in pagingTable\"\n                :key=\"rowPos\"\n                :class=\"{select: typeof selected[pageTop + rowPos] !== 'undefined'}\"\n                :style=\"rowStyle(record)\">\n              <td class=\"center-text first-col\"\n                  :class=\"{hide: noNumCol}\"\n                  :pos=\"rowPos\"\n                  @click=\"rowLabelClick\">\n                <span v-html=\"recordLabel(pageTop + rowPos + 1, record)\"></span>\n              </td>\n              <template v-for=\"(item, p) in fields\">\n                <td v-show=\"!item.invisible\"\n                    :id=\"`id-${record.$id}-${item.name}`\"\n                    :class=\"{\n                      readonly: item.readonly,\n                      error: errmsg[`id-${record.$id}-${item.name}`],\n                      select: item.options.length,\n                      datepick: item.type == 'date',\n                      'sticky-column': item.sticky\n                    }\"\n                    :style=\"Object.assign(cellStyle(record, item), columnCellStyle(item))\"\n                    :key=\"p\"\n                    @mouseover=\"cellMouseOver\"\n                    @mousemove=\"cellMouseMove\">{{ item.toText(record[item.name]) }}</td>\n              </template>\n              <td v-if=\"vScroller.buttonHeight < vScroller.height\" class=\"last-col\"></td>\n            </tr>\n          </tbody>\n          <tfoot>\n            <tr v-show=\"summaryRow\">\n              <td class=\"row-summary first-col\">&nbsp;</td>\n              <template v-for=\"(field, p) in fields\">\n                <td v-show=\"!field.invisible\"\n                    class=\"row-summary\"\n                    :colspan=\"p === fields.length - 1 && vScroller.buttonHeight < vScroller.height ? 2: 1\"\n                    :class=\"{\n                      'sticky-column': field.sticky,\n                      'summary-column1': p+1 < fields.length && fields[p+1].summary,\n                      'summary-column2': field.summary\n                    }\"\n                    :style=\"columnCellStyle(field)\"\n                    :key=\"`f${p}`\">{{ summary(field) }}</td>\n              </template>\n            </tr>\n          </tfoot>\n          <slot></slot>\n        </table>\n\n        <!-- Tool Tip -->\n        <div v-show=\"tip\" ref=\"tooltip\" class=\"tool-tip\">{{ tip }}</div>\n\n        <!-- Editor Square -->\n        <div v-show=\"focused\" ref=\"inputSquare\" class=\"input-square\" @mousedown=\"inputSquareClick\">\n          <div style=\"position: relative; height: 100%; padding: 2px 2px 1px\">\n            <div class=\"rb-square\" />\n            <textarea ref=\"inputBox\"\n                      id=\"inputBox\"\n                      class=\"input-box\"\n                      :style=\"{opacity: inputBoxShow}\"\n                      @blur=\"inputBoxBlur\"\n                      @mousemove=\"inputBoxMouseMove\"\n                      @mousedown=\"inputBoxMouseDown\"\n                      trim\n                      autocomplete=\"off\"\n                      autocorrect=\"off\"\n                      autocompitaize=\"off\"\n                      spellcheck=\"false\"></textarea>\n          </div>\n        </div>\n\n        <!-- Date Picker -->\n        <div ref=\"dpContainer\" v-show=\"showDatePicker\" style=\"z-index:20; position:fixed\">\n          <date-picker ref=\"datepicker\" inline v-model=\"inputDateTime\" @input=\"dpClick\" valueType=\"format\"></date-picker>\n        </div>\n\n        <!-- Waiting scene -->\n        <div v-show=\"processing\" ref=\"frontdrop\" class=\"front-drop\">\n          <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"spinner\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-3x\"><path fill=\"currentColor\" d=\"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z\"></path></svg>\n        </div>\n      </div>\n\n      <!-- Vertical Scroll Bar -->\n      <div v-if=\"vScroller.buttonHeight < vScroller.height\"\n           ref=\"vScroll\"\n           class=\"v-scroll\"\n           :style=\"{top: `${vScroller.top}px`, height: `${vScroller.height}px`}\"\n           @mousedown=\"vsMouseDown\">\n        <div ref=\"vScrollButton\"\n             class=\"v-scroll-button\"\n             :style=\"{marginTop: `${vScroller.buttonTop}px`, height: `${vScroller.buttonHeight}px`}\"\n             @mousedown=\"vsbMouseDown\">\n          <div v-show=\"vScroller.runner\" class=\"runner\" v-html=\"vScroller.runner\" />\n        </div>\n      </div>\n\n      <!-- Autocomplete List -->\n      <ul ref=\"autocomplete\" v-show=\"focused && autocompleteInputs.length\" class=\"autocomplete-results\">\n        <li v-for=\"(item,i) in autocompleteInputs\"\n            :key=\"i\"\n            :class=\"{select: autocompleteSelect === i}\"\n            @mousedown.left.prevent=\"inputAutocompleteText($event.target.textContent, $event)\"\n            class=\"autocomplete-result\">{{ item }}</li>\n      </ul>\n\n      <!-- Footer -->\n      <div ref=\"footer\" class=\"footer center-text\" :class=\"{hide: noFooter}\" style=\"position:relative\" @mousedown=\"ftMouseDown\">\n        <div ref=\"hScroll\" class=\"h-scroll\" @mousedown=\"sbMouseDown\" />\n        <span class=\"left-block\"></span>\n        <span v-show=\"!noPaging\" style=\"position: absolute; left: 46px\">\n          <span v-html=\"localizedLabel.footerLeft(pageTop + 1, pageBottom, table.length)\"></span>\n        </span>\n        <span v-show=\"!noPaging && pageBottom - pageTop < table.length\">\n          <template v-if=\"processing\">\n            <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"spinner\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-spinner fa-w-16 fa-spin fa-sm\"><path fill=\"currentColor\" d=\"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z\"></path></svg>\n            &nbsp;\n            <span v-html=\"localizedLabel.processing\" />\n          </template>\n          <template v-else>\n            <a :class=\"{disabled: pageTop <= 0}\" @mousedown=\"firstPage\">\n              <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"step-backward\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-step-backward fa-w-14 fa-sm\"><path fill=\"currentColor\" d=\"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z\"></path></svg>\n              &nbsp;\n              <span v-html=\"localizedLabel.first\" />\n            </a>\n            &nbsp;|&nbsp;\n            <a :class=\"{disabled: pageTop <= 0}\" @mousedown=\"prevPage\">\n              <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"backward\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-backward fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z\"></path></svg>\n              &nbsp;\n              <span v-html=\"localizedLabel.previous\" />\n            </a>\n            &nbsp;|&nbsp;\n            <a :class=\"{disabled: pageTop + pageSize >= table.length}\" @mousedown=\"nextPage\">\n              <span v-html=\"localizedLabel.next\" />\n              &nbsp;\n              <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"forward\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-inline--fa fa-forward fa-w-16 fa-sm\"><path fill=\"currentColor\" d=\"M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z\"></path></svg>\n            </a>\n            &nbsp;|&nbsp;\n            <a :class=\"{disabled: pageTop + pageSize >= table.length}\" @mousedown=\"lastPage\">\n              <span v-html=\"localizedLabel.last\" />\n              &nbsp;\n              <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"step-forward\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-inline--fa fa-step-forward fa-w-14 fa-sm\"><path fill=\"currentColor\" d=\"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z\"></path></svg>\n            </a>\n          </template>\n        </span>\n        <span style=\"position: absolute; right: 6px\">\n          <!--span v-html=\"localizedLabel.footerRight(Object.keys(selected).length, table.length, value.length)\" /-->\n          <a :class=\"{disabled: !showSelectedOnly && selectedCount <= 1}\" @mousedown=\"toggleSelectView\">\n            <span v-html=\"localizedLabel.footerRight.selected\" />\n            <span :style=\"{color: selectedCount>0 ? 'red': 'inherit'}\">{{ selectedCount }}</span>\n          </a>\n          &nbsp;|&nbsp;\n          <a :class=\"{disabled: columnFilterString === '{}'}\" @mousedown=\"toggleFilterView\">\n            <span v-html=\"localizedLabel.footerRight.filtered\" />\n            <span :style=\"{color: table.length !== value.length ? 'red': 'inherit'}\">{{ table.length }}</span>\n          </a>\n          &nbsp;|&nbsp;\n          <a :class=\"{disabled: true}\">\n            <span v-html=\"localizedLabel.footerRight.loaded\" />\n            <span>{{ value.length }}</span>\n          </a>\n        </span>\n      </div>\n\n      <input type=\"file\"\n             ref=\"importFile\"\n             accept=\".xlsx, .xls, xlsm, .csv\"\n             style=\"width:0; height: 0; opacity:0; z-index:-1\"\n             @change=\"doImport\" />\n\n      <panel-filter ref=\"panelFilter\" :m-filter-count=\"nFilterCount\" :localized-label=\"localizedLabel\" />\n      <panel-setting ref=\"panelSetting\" v-model=\"fields\" :localized-label=\"localizedLabel\" />\n      <panel-find ref=\"panelFind\" :localized-label=\"localizedLabel\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport VueExcelFilter from './VueExcelFilter.vue'\nimport PanelFilter from './PanelFilter.vue'\nimport PanelSetting from './PanelSetting.vue'\nimport PanelFind from './PanelFind.vue'\nimport DatePicker from 'vue2-datepicker'\nimport XLSX from 'xlsx'\n\nimport 'vue2-datepicker/index.css'\n\nexport default {\n  components: {\n    'vue-excel-filter': VueExcelFilter,\n    'panel-filter': PanelFilter,\n    'panel-setting': PanelSetting,\n    'panel-find': PanelFind,\n    'date-picker': DatePicker\n  },\n  props: {\n    value: {type: Array, default () {return []}},\n    rowStyle: {type: Function, default () {return {}}},\n    cellStyle: {type: Function, default () {return {}}},\n    headerLabel: {\n      type: Function,\n      default (label) {\n        return label\n      }\n    },\n    recordLabel: {                                  // return the row header\n      type: Function,\n      default (pos) {\n        return pos\n      }\n    },\n    noFinding: {type: Boolean, default: false},\n    noFindingNext: {type: Boolean, default: false},\n    filterRow: {type: Boolean, default: false},\n    freeSelect: {type: Boolean, default: false},\n    noFooter: {type: Boolean, default: false},\n    noPaging: {type: Boolean, default: false},\n    noNumCol: {type: Boolean, default: false},\n    page: {type: Number, default: 0},               // prefer page size, auto-cal if not provided\n    newRecord: {type: Function, default: null},     // return the new record from caller if provided\n    nFilterCount: {type: Number, default: 200},     // show top n values in filter dialog\n    height: {type: String, default: ''},\n    width: {type: String, default: '100%'},\n    autocomplete: {type: Boolean, default: false},  // Default autocomplete of all columns\n    readonly: {type: Boolean, default: false},\n    readonlyStyle: {type: Object, default () {return {}}},\n    remember: {type: Boolean, default: false},\n    localizedLabel: {\n      type: Object,\n      default () {\n        return {\n          footerLeft: (top, bottom, total) => `Record ${top} to ${bottom} of ${total}`,\n          first: 'First',\n          previous: 'Previous',\n          next: 'Next',\n          last: 'Last',\n          footerRight: {\n            selected: 'Selected:',\n            filtered: 'Filtered:',\n            loaded: 'Loaded:'\n          },\n          processing: 'Processing',\n          tableSetting: 'Table Setting',\n          exportExcel: 'Export Excel',\n          importExcel: 'Import Excel',\n          back: 'Back',\n          sortingAndFiltering: 'Sorting And Filtering',\n          sortAscending: 'Sort Ascending',\n          sortDescending: 'Sort Descending',\n          near: '\u2252 Near',\n          exactMatch: '= Exact Match',\n          greaterThan: '&gt; Greater Than',\n          greaterThanOrEqualTo: '\u2265 Greater Than or Equal To',\n          lessThan: '&lt; Less Than',\n          lessThanOrEqualTo: '\u2264 Less Than Or Equal To',\n          regularExpression: '~ Regular Expression',\n          customFilter: 'Custom Filter',\n          listFirstNValuesOnly: n => `List first ${n} values only`,\n          apply: 'Apply',\n          noRecordIsRead: 'No record is read',\n          readonlyColumnDetected: 'Readonly column detected',\n          columnHasValidationError: (name, err) => `Column ${name} has validation error: ${err}`,\n          noMatchedColumnName: 'No matched column name',\n          invalidInputValue: 'Invalid input value',\n          missingKeyColumn: 'Missing key column'\n        }\n      }\n    }\n  },\n  data () {\n    const pageSize = this.noPaging ? 999999 : 20\n    const dataset = {\n      // selTarget: null,\n      // selSquare: null,\n      // selx: 0,\n      // sely: 0,\n\n      tableContent: null,           // Table parent\n      systable: null,               // TABLE dom node\n      colgroupTr: null,             // colgroup TR dom node\n      labelTr: null,                // THEAD label dom node\n      filterTr: null,               // THEAD filter dom node\n      recordBody: null,             // TBODY dom node\n      footer: null,                 // TFOOTER dom node\n\n      pageSize: pageSize,\n      pageTop: 0,                   // Current page top pos of [table] array\n\n      selected: {},                 // selected storage in hash, key is the pos of [table] array\n      selectedCount: 0,             // selected row count\n      prevSelect: -1,               // previous select pos of [table] array\n      processing: false,            // current general-purpose processing status\n\n      rowIndex: {},                 // index of the record key to pos of [table] array\n\n      currentRecord: null,          // focusing TR dom node\n      currentRowPos: 0,             // focusing array pos of [table] array\n      currentColPos: 0,             // focusing pos of column/field\n      currentField: null,           // focusing field object\n      currentCell: null,\n      inputBox: null,\n      inputBoxShow: 0,\n      inputSquare: null,\n      autocompleteInputs: [],\n      autocompleteSelect: -1,\n\n      errmsg: {},\n      tip: '',\n\n      fields: [],\n      focused: false,\n      mousein: false,\n      inputBoxChanged: false,\n\n      columnFilter: {},             // set filter storage in hash, key is the column pos\n\n      inputFind: '',\n      calCellLeft: 0,\n      calCellTop: 0,\n      calCellTop2: 29,\n\n      frontdrop: null,              // frontdrop dom node\n\n      sortPos: 0,                   // Sort column position\n      sortDir: 0,                   // Sort direction, 1=Ascending, -1=Descending\n      redo: [],                     // redo log\n\n      lazyTimeout: {},\n      lazyBuffer: {},\n      hScroller: {},\n      vScroller: {},\n      leftMost: 0,\n\n      showDatePicker: false,\n      inputDateTime: '',\n\n      table: [],\n      summaryRow: false,\n      showFilteredOnly: true,\n      showSelectedOnly: false\n    }\n    return dataset\n  },\n  computed: {\n    token () {\n      const id = Array.from(document.querySelectorAll('.vue-excel-editor')).indexOf(this.$el)\n      return `vue-excel-editor-${id}`\n    },\n    columnFilterString () {\n      Object.keys(this.columnFilter).forEach((key) => {\n        if (this.columnFilter[key].trim() === '') delete this.columnFilter[key]\n      })\n      return JSON.stringify(this.columnFilter)\n    },\n    pagingTable () {\n      return this.table.slice(this.pageTop, this.pageTop + this.pageSize)\n    },\n    pageBottom () {\n      if (this.value.length === 0) return 0\n      else return this.pageTop + this.pageSize > this.table.length ? this.table.length : this.pageTop + this.pageSize\n    },\n    setting: {\n      get () {\n        return null\n      },\n      set (setter) {\n        if (setter.fields) {\n          // ignore if fields counts are different\n          if (setter.fields.length !== this.fields.length) return\n          let valid = true\n          const newFields = setter.fields.map(field => {\n            const current = this.fields.find(f => f.name === field.name)\n            if (!current) valid = false\n            return Object.assign(current, {\n              invisible: field.invisible,\n              width: field.width\n            })\n          })\n          if (valid) {\n            this.fields = newFields\n            this.$forceUpdate()\n          }\n        }\n      }\n    }\n  },\n  watch: {\n    value () {\n      // detect a loading process, refresh something\n      // this.redo = []\n      // this.errmsg = {}\n      this.lazy(this.refresh)\n    },\n    columnFilterString () {\n      this.processing = true\n      setTimeout(() => {\n        this.refresh()\n        this.processing = false\n      }, 0)\n    },\n    fields: {\n      handler () {\n        this.lazy(() => {\n          const setting = this.getSetting()\n          if (this.remember) localStorage[window.location.pathname + '.' + this.token] = JSON.stringify(setting)\n          this.$emit('setting', setting)\n        })\n      },\n      deep: true\n    },\n    processing (newVal) {\n      if (newVal) {\n        const rect = this.$el.children[0].getBoundingClientRect()\n        this.frontdrop.style.top = rect.top + 'px'\n        this.frontdrop.style.left = rect.left + 'px'\n        this.frontdrop.style.height = rect.height + 'px'\n        this.frontdrop.style.width = rect.width + 'px'\n      }\n    }\n  },\n  beforeDestroy () {\n    window.removeEventListener('resize', this.winResize)\n    window.removeEventListener('paste', this.winPaste)\n    window.removeEventListener('keydown', this.winKeydown)\n    window.removeEventListener('scroll', this.winScroll)\n  },\n  mounted () {\n    this.tableContent = this.$refs.tableContent\n    this.systable = this.$refs.systable\n    this.colgroupTr = this.systable.children[0]\n    this.labelTr = this.systable.children[1].children[0]\n    this.filterTr = this.systable.children[1].children[1]\n    this.recordBody = this.systable.children[2]\n    this.footer = this.$refs.footer\n    this.inputSquare = this.$refs.inputSquare\n    this.inputBox = this.$refs.inputBox\n    this.frontdrop = this.$refs.frontdrop\n\n    if (this.height)\n      this.systable.parentNode.style.height = this.height\n\n    this.reset()\n    this.lazy(() => {\n      this.labelTr.children[0].style.height = this.labelTr.offsetHeight + 'px'\n      this.calCellTop2 = this.labelTr.offsetHeight\n      this.refreshPageSize()\n      this.calStickyLeft()\n    }, 200)\n\n    window.addEventListener('resize', this.winResize)\n    window.addEventListener('paste', this.winPaste)\n    window.addEventListener('keydown', this.winKeydown)\n    window.addEventListener('scroll', this.winScroll)\n\n    if (this.remember && localStorage[window.location.pathname + '.' + this.token])\n      this.setting = JSON.parse(localStorage[window.location.pathname + '.' + this.token])\n  },\n  methods: {\n    getSetting () {\n      const colWidth = Array.from(this.colgroupTr.children).map(col => col.style.width)\n      const fields = this.fields.map((field, i) => {\n        return {\n          name: field.name,\n          invisible: field.invisible,\n          width: colWidth[i + 1]\n        }\n      })\n      return {\n        fields: fields\n      }\n    },\n    calVScroll () {\n      let d = this.labelTr.getBoundingClientRect().height\n      if (this.filterRow) d += 29\n      this.vScroller.top = d\n      if (!this.noFooter) d += 25\n      if (this.summaryRow) d += 27\n      const fullHeight = this.$el.getBoundingClientRect().height\n      this.vScroller.height = fullHeight - d\n      const ratio =  this.vScroller.height / (this.table.length * 24)\n      this.vScroller.buttonHeight = Math.max(24, this.vScroller.height * ratio)\n      const prop = (this.tableContent.scrollTop + this.pageTop * 24) / (this.table.length * 24 - this.vScroller.height)\n      this.vScroller.buttonTop = (this.vScroller.height - this.vScroller.buttonHeight) * prop\n      this.$forceUpdate()\n    },\n    reset () {\n      this.errmsg = {}\n      this.redo = []\n      this.showFilteredOnly = true\n      this.showSelectedOnly = false\n      this.columnFilter = {}\n      this.sortPos = 0\n      this.sortDir = 0\n      this.inputFind = ''\n      this.pageTop = 0\n      this.selected = {}\n      this.selectedCount = 0\n      this.prevSelect = -1\n      this.processing = false\n      this.rowIndex = {}\n      this.refresh()\n    },\n    toggleSelectView (e) {\n      if (e) e.stopPropagation()\n      this.showSelectedOnly = !this.showSelectedOnly\n      return this.refresh()\n    },\n    toggleFilterView (e) {\n      if (e) e.stopPropagation()\n      this.showFilteredOnly = !this.showFilteredOnly\n      return this.refresh()\n    },\n    summary (field) {\n      if (!field.summary) return ''\n      const i = field.name\n      let result = ''\n      switch(field.summary) {\n        case 'sum':\n          result = this.table.reduce((a, b) => (a + Number(b[i])), 0)\n          result = Number(Math.round(result + 'e+5') + 'e-5')  // solve the infinite .9 issue of javascript\n          break\n        case 'avg':\n          result = this.table.reduce((a, b) => (a + Number(b[i])), 0) / this.table.length\n          result = Number(Math.round(result + 'e+5') + 'e-5')  // solve the infinite .9 issue of javascript\n          break\n        case 'max':\n          result = this.table.reduce((a, b) => (a > b[i] ? a : b[i]), Number.MIN_VALUE)\n          break\n        case 'min':\n          result = this.table.reduce((a, b) => (a < b[i] ? a : b[i]), Number.MAX_VALUE)\n          break\n      }\n      return field.toText(result)\n    },\n    calTable () {\n      // add unique key to each row if no key is provided\n      let seed = new Date().getTime() - 1578101000000\n      this.value.forEach((rec,i) => {\n        if (!rec.$id) rec.$id = seed + '-' + i\n      })\n\n      if (this.showFilteredOnly === false) {\n        this.table = this.value\n      }\n      else {\n        const filterColumnList = Object.keys(this.columnFilter)\n        const filter = {}\n        filterColumnList.forEach((k) => {\n          switch (true) {\n            case this.columnFilter[k].startsWith('<='):\n              filter[k] = {type: 1, value: this.columnFilter[k].slice(2).trim().toUpperCase()}\n              if (this.fields[k].type === 'number') filter[k].value = Number(filter[k].value)\n              break\n            case this.columnFilter[k].startsWith('<'):\n              filter[k] = {type: 2, value: this.columnFilter[k].slice(1).trim().toUpperCase()}\n              if (this.fields[k].type === 'number') filter[k].value = Number(filter[k].value)\n              break\n            case this.columnFilter[k].startsWith('>='):\n              filter[k] = {type: 3, value: this.columnFilter[k].slice(2).trim().toUpperCase()}\n              if (this.fields[k].type === 'number') filter[k].value = Number(filter[k].value)\n              break\n            case this.columnFilter[k].startsWith('>'):\n              filter[k] = {type: 4, value: this.columnFilter[k].slice(1).trim().toUpperCase()}\n              if (this.fields[k].type === 'number') filter[k].value = Number(filter[k].value)\n              break\n            case this.columnFilter[k].startsWith('='):\n              filter[k] = {type: 0, value: this.columnFilter[k].slice(1).trim().toUpperCase()}\n              break\n            case this.columnFilter[k].startsWith('*') && this.columnFilter[k].endsWith('*'):\n              filter[k] = {type: 5, value: this.columnFilter[k].slice(1).slice(0, -1).trim().toUpperCase()}\n              break\n            case this.columnFilter[k].startsWith('*') && !this.columnFilter[k].slice(1).includes('*'):\n              filter[k] = {type: 6, value: this.columnFilter[k].slice(1).trim().toUpperCase()}\n              break\n            case this.columnFilter[k].endsWith('*') && !this.columnFilter[k].slice(0, -1).includes('*'):\n              filter[k] = {type: 7, value: this.columnFilter[k].slice(0, -1).trim().toUpperCase()}\n              break\n            case this.columnFilter[k].startsWith('~'):\n              filter[k] = {type: 8, value: this.columnFilter[k].slice(1).trim()}\n              break\n            case this.columnFilter[k].includes('*') || this.columnFilter[k].includes('?'):\n              filter[k] = {type: 8, value: '^' + this.columnFilter[k].replace(/\\*/g, '.*').replace(/\\?/g, '.').trim() + '$'}\n              break\n            default:\n              filter[k] = {type: 5, value: this.columnFilter[k].trim().toUpperCase()}\n              break\n          }\n        })\n        this.table = this.value.filter((record) => {\n          const content = {}\n          filterColumnList.forEach((k) => {\n            const val = record[this.fields[k].name]\n            content[k] = typeof val === 'undefined' ? '' : String(val).toUpperCase()\n          })\n          for (let i = 0; i < filterColumnList.length; i++) {\n            const k = filterColumnList[i]\n            switch (filter[k].type) {\n              case 0:\n                if (`${content[k]}` !== `${filter[k].value}`) return false\n                break\n              case 1:\n                if (this.fields[k].type === 'number') content[k] = Number(content[k])\n                if (filter[k].value < content[k]) return false\n                break\n              case 2:\n                if (this.fields[k].type === 'number') content[k] = Number(content[k])\n                if (filter[k].value <= content[k]) return false\n                break\n              case 3:\n                if (this.fields[k].type === 'number') content[k] = Number(content[k])\n                if (filter[k].value > content[k]) return false\n                break\n              case 4:\n                if (this.fields[k].type === 'number') content[k] = Number(content[k])\n                if (filter[k].value >= content[k]) return false\n                break\n              case 5:\n                if (!content[k].includes(filter[k].value)) return false\n                break\n              case 6:\n                if (!content[k].endsWith(filter[k].value)) return false\n                break\n              case 7:\n                if (!content[k].startsWith(filter[k].value)) return false\n                break\n              case 8:\n                if (!new RegExp(filter[k].value, 'i').test(content[k])) return false\n                break\n            }\n          }\n          return true\n        })\n      }\n\n      this.reviseSelectedAfterTableChange()\n      if (this.showSelectedOnly) {\n        this.table = this.table.filter((rec, i) => this.selected[i])\n        this.reviseSelectedAfterTableChange()\n      }\n    },\n    getKeys (rec) {\n      if (!rec) rec = this.currentRecord\n      const key = this.fields.filter(field => field.keyField).map(field => rec[field.name])\n      if (key.length && key.join() !== '') return key\n      return [rec.$id]\n    },\n    showDatePickerDiv () {\n      const cellRect = this.currentCell.getBoundingClientRect()\n      this.$refs.dpContainer.style.left = (cellRect.left) + 'px'\n      this.$refs.dpContainer.style.top = (cellRect.bottom) + 'px'\n      this.inputDateTime = this.currentCell.textContent\n      this.showDatePicker = true\n      this.lazy(() => {\n        const r = this.$refs.dpContainer.getBoundingClientRect()\n        if (r.bottom > window.innerHeight)\n          this.$refs.dpContainer.style.top = (cellRect.top - r.height) + 'px'\n        if (r.right > window.innerWidth)\n          this.$refs.dpContainer.style.top = (window.innerWidth - r.width) + 'px'\n      })\n    },\n    dpClick () {\n      this.inputBox.value = this.inputDateTime\n      this.inputBoxShow = 0\n      this.inputCellWrite(this.inputDateTime)\n      this.showDatePicker = false\n      this.focused = true\n    },\n    columnCellStyle (field) {\n      let result = field.initStyle\n      if (field.readonly) result = Object.assign(result, this.readonlyStyle)\n      if (field.left) result = Object.assign(result, {left: field.left})\n      return result\n    },\n    calStickyLeft () {\n      let left = 0, n = 0\n      this.leftMost = -1\n      Array.from(this.labelTr.children).forEach(th => {\n        left += th.offsetWidth\n        const field = this.fields[n++]\n        if (field)\n          if (field.sticky) field.left = left + 'px'\n          else if (this.leftMost === -1) this.leftMost = left\n      })\n      this.$forceUpdate()\n    },\n    vsMouseDown (e) {\n      e.stopPropagation()\n      const pos = e.offsetY - this.vScroller.buttonHeight / 2\n      let ratio = Math.max(0, pos)\n      ratio = Math.min(ratio, this.vScroller.height - this.vScroller.buttonHeight)\n      ratio = ratio / (this.vScroller.height - this.vScroller.buttonHeight)\n      if (this.noPaging)\n        this.tableContent.scrollTo(this.tableContent.scrollLeft, this.table.length * 24 * ratio)\n      else {\n        this.vScroller.buttonTop = ratio * (this.vScroller.height - this.vScroller.buttonHeight)\n        this.$refs.vScrollButton.style.marginTop = this.vScroller.buttonTop + 'px'\n        this.pageTop = Math.round((this.table.length - this.pageSize) * ratio)\n      }\n    },\n    vsbMouseDown (e) {\n      e.stopPropagation()\n      if (!this.vScroller.mouseY) {\n        this.vScroller.saveButtonTop = this.vScroller.buttonTop\n        this.vScroller.mouseY = e.clientY\n        window.addEventListener('mousemove', this.vsbMouseMove)\n        this.$refs.vScrollButton.classList.add('focus')\n      }\n    },\n    vsbMouseMove (e) {\n      if (e.buttons === 0) {\n        window.removeEventListener('mousemove', this.vsbMouseMove)\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'))\n        this.vScroller.mouseY = 0\n        if (!this.noPaging) {\n          const ratio = this.vScroller.buttonTop / (this.vScroller.height - this.vScroller.buttonHeight)\n          this.pageTop = Math.round((this.table.length - this.pageSize) * ratio)\n        }\n        this.vScroller.runner = ''\n      }\n      else {\n        const diff = e.clientY - this.vScroller.mouseY\n        if (this.noPaging) {\n          const ratio = (this.vScroller.saveButtonTop + diff) / (this.vScroller.height - this.vScroller.buttonHeight)\n          this.tableContent.scrollTo(this.tableContent.scrollLeft, this.table.length * 24 * ratio)\n        }\n        else {\n          this.vScroller.buttonTop = Math.max(0, Math.min(this.vScroller.height - this.vScroller.buttonHeight, this.vScroller.saveButtonTop + diff))\n          this.$refs.vScrollButton.style.marginTop = this.vScroller.buttonTop + 'px'\n\n          const ratio = this.vScroller.buttonTop / (this.vScroller.height - this.vScroller.buttonHeight)\n          const recPos = Math.round((this.table.length - this.pageSize) * ratio) + 1\n          const rec = this.table[recPos]\n          this.vScroller.runner = recPos + '<br>' + this.fields\n            .filter((field, i) => field.keyField || field.sticky || this.sortPos === i)\n            .map(field => rec[field.name])\n            .join('<br>')\n          this.$forceUpdate()\n        }\n      }\n    },\n    ftMouseDown (e) {\n      const footerRect = this.footer.getBoundingClientRect()\n      const ratio = (e.x - footerRect.left - 40) / (footerRect.width - 40)\n      const fullWidth = this.systable.getBoundingClientRect().width\n      const viewWidth = this.tableContent.getBoundingClientRect().width\n      this.tableContent.scrollTo(fullWidth * ratio - viewWidth / 2, this.tableContent.scrollTop)\n    },\n    sbMouseDown (e) {\n      e.stopPropagation()\n      if (!this.hScroller.mouseX) {\n        const sleft = this.$refs.hScroll.getBoundingClientRect().left\n        const fleft = this.footer.getBoundingClientRect().left + 40\n        this.hScroller.left = sleft - fleft\n        this.hScroller.mouseX = e.clientX\n        window.addEventListener('mousemove', this.sbMouseMove)\n        this.$refs.hScroll.classList.add('focus')\n      }\n    },\n    sbMouseMove (e) {\n      if (e.buttons === 0) {\n        window.removeEventListener('mousemove', this.sbMouseMove)\n        this.lazy(() => this.$refs.hScroll.classList.remove('focus'))\n        this.hScroller.mouseX = 0\n      }\n      else {\n        const diff = e.clientX - this.hScroller.mouseX\n        const ratio = (this.hScroller.left + diff) / this.hScroller.scrollerUnseenWidth\n        this.tableContent.scrollTo(this.hScroller.tableUnseenWidth * ratio, this.tableContent.scrollTop)\n      }\n    },\n    tableScroll () {\n      this.showDatePicker = false\n      this.autocompleteInputs = []\n      if (this.focused && this.currentField)\n        this.inputSquare.style.marginLeft =\n          (this.currentField.sticky ? this.tableContent.scrollLeft - this.squareSavedLeft : 0) + 'px'\n\n      if (this.tableContent.scrollTop !== this.vScroller.lastTop) {\n        this.calVScroll()\n        if (this.$refs.vScrollButton) {\n          this.$refs.vScrollButton.classList.add('focus')\n          this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n        }\n      }\n      this.vScroller.lastTop = this.tableContent.scrollTop\n\n      if (this.tableContent.scrollLeft !== this.hScroller.lastLeft) {\n        if (this.$refs.hScroll && this.hScroller.tableUnseenWidth) {\n          this.$refs.hScroll.classList.add('focus')\n          this.lazy(() => this.$refs.hScroll.classList.remove('focus'), 1000)\n          const ratio = this.tableContent.scrollLeft / this.hScroller.tableUnseenWidth\n          this.$refs.hScroll.style.left = (this.hScroller.scrollerUnseenWidth * ratio) + 'px'\n        }\n      }\n      this.hScroller.lastLeft = this.tableContent.scrollLeft\n    },\n    importTable (cb) {\n      this.$refs.importFile.click()\n      this.importCallback = cb\n    },\n    doImport (e) {\n      this.processing = true\n      this.refresh()\n      setTimeout(() => {\n        const files = e.target.files\n        if (!files || files.length === 0) return\n        const file = files[0]\n\n        const fileReader = new FileReader()\n        fileReader.onload = (e) => {\n          try {\n            const data = e.target.result\n            const wb = XLSX.read(data, {type: 'binary', cellDates: true, cellStyle: false})\n            const sheet = wb.SheetNames[0]\n            const importData = XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheet])\n            const keyStart = new Date().getTime()\n            if (importData.length === 0) throw new Error('VueExcelEditor: ' + this.localizedLabel.noRecordIsRead)\n            if (this.fields\n              .filter(f => f.keyField)\n              .filter(f => typeof importData[0][f.name] === 'undefined' && typeof importData[0][f.label] === 'undefined').length > 0)\n              throw new Error(`VueExcelEditor: ${this.localizedLabel.missingKeyColumn}`)\n\n            let pass = 0\n            let inserted = 0\n            let updated = 0\n            while (pass < 2) {\n              importData.forEach((line, i) => {\n                let rowPos = this.table.findIndex(v => {\n                  return this.fields\n                    .filter(f => f.keyField)\n                    .filter(f => v[f.name] !== line[f.name] && v[f.name] !== line[f.label]).length === 0\n                })\n                let rec = {\n                  $id: typeof line.$id === 'undefined' ? keyStart + '-' + i : line.$id\n                }\n\n                this.fields.forEach((field) => {\n                  if (field.name.startsWith('$')) return\n                  let val = line[field.name]\n                  if (typeof val === 'undefined') val = line[field.label]\n                  if (typeof val === 'undefined') val = null\n                  else {\n                    if (field.readonly) throw new Error(`VueExcelEditor: [row=${i+1}] ` + this.localizedLabel.readonlyColumnDetected)\n                    if (field.validate) {\n                      let err\n                      if ((err = field.validate(val)))\n                        throw new Error(`VueExcelEditor: [row=${i+1}] ` + this.localizedLabel.columnHasValidationError(field.name, err))\n                    }\n                  }\n                  if (val !== null) rec[field.name] = val\n                })\n                if (pass === 1) {\n                  if (rowPos >= 0) {\n                    updated++\n                  }\n                  else {\n                    rowPos = this.table.push(rec) - 1\n                    inserted++\n                  }\n                  Object.keys(rec).forEach(name => {\n                    if (name.startsWith('$')) return\n                    this.updateCellByName(rowPos, name, rec[name])\n                  })\n                }\n              })\n              pass++\n            }\n            if (pass === 2 && this.importCallback) {\n              this.importCallback({\n                inserted: inserted,\n                updated: updated,\n                recordAffected: inserted + updated\n              })\n            }\n          }\n          catch (e) {\n            throw new Error('VueExcelEditor: ' + e.stack)\n          }\n          finally {\n            this.processing = false\n            this.$refs.importFile.value = ''\n          }\n        }\n        fileReader.onerror = (e) => {\n          this.processing = false\n          this.$refs.importFile.value = ''\n          throw new Error('VueExcelEditor: ' + e.stack)\n        }\n        fileReader.readAsBinaryString(file)\n      }, 500)      \n    },\n    winScroll () {\n      this.showDatePicker = false\n      this.autocompleteInputs = []\n    },\n    winResize () {\n      this.lazy(this.refreshPageSize, 200)\n    },\n    winPaste (e) {\n      if (e.target.tagName !== 'TEXTAREA') return\n      if (!this.mousein && !this.focused) return\n      if (!this.currentField || this.currentField.readonly) return\n      if (this.inputBoxShow) {\n        this.inputBoxChanged = true\n        return\n      }\n      const text = (e.originalEvent || e).clipboardData.getData('text/plain')\n      this.inputCellWrite(text)\n      e.preventDefault()\n    },\n    winKeydown (e) {\n      if (!this.mousein && !this.focused) return\n      if (e.ctrlKey || e.metaKey)\n        switch (e.keyCode) {\n          case 90: // z\n            this.undoTransaction()\n            e.preventDefault()\n            break\n          case 65: // a\n            this.toggleSelectAllRecords()\n            e.preventDefault()\n            break\n          case 67: // c\n            this.inputBox.value = this.currentCell.innerText\n            this.inputBox.focus()\n            this.inputBox.select()\n            document.execCommand('copy')\n            e.preventDefault()\n            break\n          case 70: // f\n            if (!this.noFinding) {\n              this.$refs.panelFind.showPanel()\n              e.preventDefault()\n            }\n            break\n          case 71: // g\n            if (!this.noFindingNext && this.inputFind !== '') {\n              this.doFindNext()\n              e.preventDefault()\n            }\n            break\n          case 76: // l\n            e.preventDefault()\n            this.calAutocompleteList(true)\n            break\n        }\n      else {\n        if (this.currentRowPos < 0) return\n        switch (e.keyCode) {\n          case 37:  // Left Arrow\n            if (!this.focused) return\n            if (!this.inputBoxShow) {\n              this.moveWest(e)\n              e.preventDefault()\n            }\n            else {\n              if (this.inputBox.selectionStart === 0) {\n                this.moveWest(e)\n                e.preventDefault()\n              }\n            }\n            break\n          case 38:  // Up Arrow\n            if (!this.focused) return\n            e.preventDefault()\n            if (this.autocompleteInputs.length === 0)\n              this.moveNorth()\n            else\n              if (this.autocompleteSelect > 0) this.autocompleteSelect--\n            break\n          case 9:  // Tab\n          case 39: // Right Arrow\n            if (!this.focused) return\n            if (!this.inputBoxShow) {\n              this.moveEast(e)\n              e.preventDefault()\n            }\n            else {\n              if (this.inputBox.selectionEnd === this.inputBox.value.length) {\n                this.moveEast(e)\n                e.preventDefault()\n              }\n            }\n            break\n          case 40:  // Down Arrow\n            if (!this.focused) return\n            e.preventDefault()\n            if (this.autocompleteInputs.length === 0)\n              this.moveSouth(e)\n            else\n              if (this.autocompleteSelect < this.autocompleteInputs.length - 1) this.autocompleteSelect++\n            break\n          case 13:  // Enter\n            if (!this.focused) return\n            e.preventDefault()\n            if (this.autocompleteInputs.length === 0 || this.autocompleteSelect === -1) {\n              if (!this.moveSouth(e)) {\n                if (this.inputBoxChanged) {\n                  this.inputCellWrite(this.inputBox.value)\n                  this.inputBoxChanged = false\n                }\n                this.inputBoxShow = 0\n                this.showDatePicker = false\n                this.autocompleteInputs = []\n                this.autocompleteSelect = -1\n              }\n              return\n            }\n            else\n              if (this.autocompleteSelect !== -1)\n                this.inputAutocompleteText(this.autocompleteInputs[this.autocompleteSelect])\n            break\n          case 27:  // Esc\n            if (!this.focused) return\n            this.showDatePicker = false\n            this.autocompleteInputs = []\n            this.autocompleteSelect = -1\n            if (this.inputBoxShow) {\n              e.preventDefault()\n              this.inputBox.value = this.currentCell.innerText\n              this.inputBoxShow = 0\n              this.inputBoxChanged = false\n            }\n            break\n          case 33:  // Page Up\n            this.prevPage()\n            e.preventDefault()\n            break\n          case 34:  // Page Down\n            this.nextPage()\n            e.preventDefault()\n            break\n          case 8:   // Delete\n          case 46:  // BS\n            if (!this.focused) return\n            if (this.inputBoxShow) {\n              this.inputBoxChanged = true\n              setTimeout(this.calAutocompleteList)\n              return\n            }\n            if (this.currentField.readonly) return\n            if (this.autocompleteInputs.length) return\n            if (this.currentField.type === 'select') this.calAutocompleteList(true)\n            else {\n              this.inputBox.value = ''\n              this.inputCellWrite('')\n            }\n            break\n          default:\n            if (!this.focused) return\n            if (this.currentField.readonly) return\n            if (e.altKey) return\n            if (e.key !== 'Process' && e.key.length > 1) return\n            if (this.currentField.allowKeys && this.currentField.allowKeys.indexOf(e.key.toUpperCase()) === -1) return e.preventDefault()\n            if (this.currentField.lengthLimit && this.inputBox.value.length > this.currentField.lengthLimit) return e.preventDefault()\n            if (!this.inputBoxShow) {\n              if (this.currentField.type === 'select') {\n                this.calAutocompleteList(true)\n                return\n              }\n              if (this.currentField.type === 'date') {\n                this.showDatePickerDiv()\n                return\n              }\n              this.inputBox.value = ''\n              this.inputBoxShow = 1\n              this.inputBox.focus()\n            }\n            this.inputBoxChanged = true\n            setTimeout(this.calAutocompleteList)\n            break\n        }\n      }\n    },\n    registerColumn (field) {\n      let pos = this.fields.findIndex(item => item.pos > field.pos)\n      if (pos === -1) pos = this.fields.length\n      this.fields.splice(pos, 0, field)\n      if (field.summary) this.summaryRow = true\n    },\n    moveInputSquare (rowPos, colPos) {\n      if (colPos < 0) return false\n\n      const row = this.recordBody.children[rowPos]\n      if (!row) {\n        if (rowPos > this.currentRowPos) {\n          // move the whole page down 1 record\n          if (this.pageTop + this.pageSize < this.table.length)\n            this.pageTop += 1\n          return false\n        }\n        else {\n          // move the whole page up 1 record\n          if (this.pageTop - 1 >= 0)\n            this.pageTop -= 1\n          return false\n        }\n      }\n\n      // Clear the label markers\n      this.labelTr.children[this.currentColPos + 1].classList.remove('focus')\n      if (this.currentRowPos >= 0 && this.currentRowPos < this.pagingTable.length)\n        this.recordBody.children[this.currentRowPos].children[0].classList.remove('focus')\n\n      // Off the textarea when moving, write to value if changed\n      if (this.inputBoxShow) this.inputBoxShow = 0\n      if (this.inputBoxChanged) {\n        this.inputCellWrite(this.currentField.toValue(this.inputBox.value))\n        this.inputBoxChanged = false\n      }\n\n      // Relocate the inputSquare\n      const cell = row.children[colPos + 1]\n      if (!cell) return false\n      this.currentField = this.fields[colPos]\n      const cellRect = cell.getBoundingClientRect()\n      const tableRect = this.systable.getBoundingClientRect()\n      this.squareSavedLeft = this.tableContent.scrollLeft\n      this.inputSquare.style.marginLeft = 0\n      this.inputSquare.style.left = (cellRect.left - tableRect.left - 1) + 'px'\n      this.inputSquare.style.top =  (cellRect.top - tableRect.top - 1) + 'px'\n      this.inputSquare.style.width = (cellRect.width + 1) + 'px'\n      this.inputSquare.style.height = (cellRect.height + 1) + 'px'\n      this.inputSquare.style.zIndex = this.currentField.sticky ? 3 : 1\n\n      // Adjust the scrolling to display the whole focusing cell\n      if (!this.currentField.sticky) {\n        const boundRect = this.$el.getBoundingClientRect()\n        if (cellRect.right >= boundRect.right - 12)\n          this.tableContent.scrollBy(cellRect.right - boundRect.right + 13, 0)\n        if (cellRect.left <= boundRect.left + this.leftMost)\n          this.tableContent.scrollBy(cellRect.left - boundRect.left - this.leftMost - 1, 0)\n      }\n\n      this.currentRowPos = rowPos\n      this.currentColPos = colPos\n      this.currentCell = cell\n\n      // Off all editors\n      if (this.showDatePicker) this.showDatePicker = false\n      if (this.autocompleteInputs.length) {\n        this.autocompleteInputs = []\n        this.autocompleteSelect = -1\n      }\n      if (this.recalAutoCompleteList) clearTimeout(this.recalAutoCompleteList)\n\n      // set the label markers\n      if (this.currentRowPos >= 0 && this.currentRowPos < this.pagingTable.length) {\n        this.inputBox.focus()\n        this.focused = true\n        row.children[0].classList.add('focus')\n        this.labelTr.children[colPos + 1].classList.add('focus')\n      }\n      return true\n    },\n    refresh () {\n      this.pageTop = 0\n      this.prevSelect = -1\n      this.calTable()\n      // this.reviseSelectedAfterTableChange()\n      this.refreshPageSize()\n    },\n    getSelectedRecords () {\n      return this.table.filter((rec, i) => this.selected[i])\n    },\n    deleteSelectedRecords () {\n      this.table = this.table.filter((rec, i) => typeof this.selected[i] === 'undefined')\n      this.selected = {}\n      this.selectedCount = 0\n    },\n    colSepMouseDown (e) {\n      e.preventDefault()\n      e.stopPropagation()\n      this.focused = false\n      const getStyleVal = (elm, css) => {\n        window.getComputedStyle(elm, null).getPropertyValue(css)\n      }\n      this.sep = {}\n      this.sep.curCol = this.colgroupTr.children[Array.from(this.labelTr.children).indexOf(e.target.parentElement)]\n      // this.sep.nxtCol = this.sep.curCol.nextElementSibling\n      this.sep.pageX = e.pageX\n      let padding = 0\n      if (getStyleVal(this.sep.curCol, 'box-sizing') !== 'border-box') {\n        const padLeft = getStyleVal(this.sep.curCol, 'padding-left')\n        const padRight = getStyleVal(this.sep.curCol, 'padding-right')\n        if (padLeft && padRight)\n          padding = parseInt(padLeft) + parseInt(padRight)\n      }\n      this.sep.curColWidth = e.target.parentElement.offsetWidth - padding\n      // if (this.sep.nxtCol)\n      //   this.sep.nxtColWidth = this.sep.nxtCol.offsetWidth - padding\n      window.addEventListener('mousemove', this.colSepMouseMove)\n      window.addEventListener('mouseup', this.colSepMouseUp)\n    },\n    colSepMouseOver (e) {\n      e.target.style.borderRight = '5px solid #cccccc'\n      e.target.style.height = this.systable.getBoundingClientRect().height + 'px'\n    },\n    colSepMouseOut (e) {\n      e.target.style.borderRight = ''\n      e.target.style.height = '100%'\n    },\n    colSepMouseMove (e) {\n      if (!this.sep || !this.sep.curCol) return\n      const diffX = e.pageX - this.sep.pageX\n      this.sep.curCol.style.width = (this.sep.curColWidth + diffX) + 'px'\n      this.lazy(this.calStickyLeft)\n    },\n    colSepMouseUp (e) {\n      e.preventDefault()\n      e.stopPropagation()\n      delete this.sep\n      window.removeEventListener('mousemove', this.colSepMouseMove)\n      window.removeEventListener('mouseup', this.colSepMouseUp)\n      const setting = this.getSetting()\n      if (this.remember) localStorage[window.location.pathname + '.' + this.token] = JSON.stringify(setting)\n      this.$emit('setting', setting)\n    },\n    doFindNext () {\n      return this.doFind()\n    },\n    doFind (s) {\n      if (typeof s === 'undefined') s = this.inputFind\n      else this.inputFind = s\n      s = s.toUpperCase()\n      for(let r = this.currentRowPos + this.pageTop; r < this.table.length; r++) {\n        const rec = this.table[r]\n        for(let c = (r === this.currentRowPos + this.pageTop ? this.currentColPos + 1: 0); c < this.fields.length; c++) {\n          const field = this.fields[c].name\n          if (typeof rec[field] !== 'undefined' && String(rec[field]).toUpperCase().indexOf(s) >= 0) {\n            this.pageTop = this.findPageTop(r)\n            setTimeout(() => {\n              this.moveInputSquare(r - this.pageTop, c)\n              setTimeout(() => this.inputBox.focus())\n              this.focused = true\n            })\n            return true\n          }\n        }\n      }\n      for(let r = 0; r <= this.currentRowPos + this.pageTop; r++) {\n        const rec = this.table[r]\n        for(let c = 0; c < (r === this.currentRowPos + this.pageTop ? this.currentColPos : this.fields.length); c++) {\n          const field = this.fields[c].name\n          if (typeof rec[field] !== 'undefined' && String(rec[field]).toUpperCase().indexOf(s) >= 0) {\n            this.pageTop = this.findPageTop(r)\n            this.moveInputSquare(r - this.pageTop, c)\n            setTimeout(() => {\n              this.focused = true\n            })\n            return true\n          }\n        }\n      }\n      return false\n    },\n    findPageTop (rowPos) {\n      for (let pt = this.pageTop; pt < this.table.length; pt += this.pageSize)\n        if (rowPos >= pt && rowPos < pt + this.pageSize) return pt\n      for (let pt = this.pageTop; pt > 0; pt -= this.pageSize)\n        if (rowPos >= pt && rowPos < pt + this.pageSize) return pt\n      return this.pageTop\n    },\n    headerClick (e, colPos) {\n      if (e.which === 1) {\n        e.preventDefault()\n        if (this.sortPos === colPos && this.sortDir > 0)\n          this.sort(-1, colPos)\n        else\n          this.sort(1, colPos)\n      }\n    },\n    sort (n, pos) {\n      this.processing = true\n      const colPos = typeof pos === 'undefined' ? this.columnFilterRef.colPos : pos\n      const fieldName = this.fields[colPos].name\n      const type = this.fields[colPos].type\n      setTimeout(() => {\n        if (type === 'number')\n          this.value.sort((a, b) => {\n            if (Number(a[fieldName]) > Number(b[fieldName])) return n\n            if (Number(a[fieldName]) < Number(b[fieldName])) return -n\n            return 0\n          })\n        else\n          this.value.sort((a, b) => {\n            if (a[fieldName] > b[fieldName]) return n\n            if (a[fieldName] < b[fieldName]) return -n\n            return 0\n          })\n        this.sortPos = colPos\n        this.sortDir = n\n        this.processing = false\n      }, 0)\n    },\n    freezePanelSizeAfterShown (target) {\n      const rect = target.getBoundingClientRect()\n      target.setAttribute('style', `width:${rect.width}px; height:${rect.height}px;`)\n    },\n    refreshPageSize () {\n      if (this.$refs.hScroll) {\n        const fullWidth = this.systable.getBoundingClientRect().width\n        const viewWidth = this.tableContent.getBoundingClientRect().width\n        this.hScroller.tableUnseenWidth = fullWidth - viewWidth\n        this.$refs.hScroll.style.width = (100 * viewWidth / fullWidth) + '%'\n        const scrollerWidth = this.$refs.hScroll.getBoundingClientRect().width\n        this.hScroller.scrollerUnseenWidth = this.footer.getBoundingClientRect().width - 40 - scrollerWidth\n      }\n      if (!this.noPaging) {\n        const offset = this.summaryRow ? 60 : 35\n        this.pageSize = this.page || Math.floor((window.innerHeight - this.recordBody.getBoundingClientRect().top - offset) / 24)\n      }\n      else if (this.height === 'auto') {\n        let h = Math.floor((window.innerHeight - this.tableContent.getBoundingClientRect().top - 25))\n        let offset = 4\n        if (this.filterRow) offset += 29\n        if (this.summaryRow) offset += 25\n        if (!this.footerRow) offset += 25\n        h = Math.min(24 * (this.table.length - this.pageTop) + offset, h)\n        this.systable.parentNode.style.height = h + 'px'\n      }\n      setTimeout(this.calVScroll)\n    },\n    firstPage (e) {\n      if (e) e.stopPropagation()\n      this.pageTop = 0\n      this.calVScroll()\n      setTimeout(() => {\n        this.$refs.vScrollButton.classList.add('focus')\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n      })\n    },\n    lastPage (e) {\n      if (e) e.stopPropagation()\n      this.pageTop = this.table.length - this.pageSize < 0 ? 0 : this.table.length - this.pageSize\n      this.calVScroll()\n      setTimeout(() => {\n        this.$refs.vScrollButton.classList.add('focus')\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n      })\n    },\n    prevPage (e) {\n      if (e) e.stopPropagation()\n      this.pageTop = this.pageTop < this.pageSize ? 0 : this.pageTop - this.pageSize\n      this.calVScroll()\n      setTimeout(() => {\n        this.$refs.vScrollButton.classList.add('focus')\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n      })\n    },\n    nextPage (e) {\n      if (e) e.stopPropagation()\n      if (this.pageTop + this.pageSize < this.table.length)\n        this.pageTop = Math.min(this.pageTop + this.pageSize, this.table.length - this.pageSize)\n      this.calVScroll()\n      setTimeout(() => {\n        this.$refs.vScrollButton.classList.add('focus')\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n      })\n    },\n    rowLabelClick (e) {\n      let target = e.target\n      while (target.tagName !== 'TD') target = target.parentNode\n      const rowPos = Number(target.getAttribute('pos')) + this.pageTop\n      if (e.shiftKey) {\n        document.getSelection().removeAllRanges()\n        if (this.prevSelect !== -1 && this.prevSelect !== rowPos) {\n          e.preventDefault()\n          if (rowPos > this.prevSelect)\n            for (let i = this.prevSelect; i <= rowPos; i++)\n              this.selectRecord(i)\n          else\n            for (let i = rowPos; i <= this.prevSelect; i++)\n              this.selectRecord(i)\n        }\n      }\n      else {\n        const selected = this.selected[rowPos]\n        if (!this.freeSelect && !(e.ctrlKey || e.metaKey)) this.clearAllSelected()\n        if (!selected) this.selectRecord(rowPos)\n        else this.unSelectRecord(rowPos)\n      }\n      this.prevSelect = rowPos\n    },\n    settingClick () {\n      this.$refs.panelSetting.showPanel()\n    },\n    exportTable (format, selectedOnly) {\n      this.processing = true\n      setTimeout(() => {\n        const wb = XLSX.utils.book_new()\n        let ws1 = null\n        if (selectedOnly)\n          ws1 = XLSX.utils.json_to_sheet(this.table.filter((rec, i) => this.selected[i]), {\n            header: this.fields.map(field => field.name)\n          })\n        else\n          ws1 = XLSX.utils.json_to_sheet(this.table, {\n            header: this.fields.map(field => field.name)\n          })\n        const labels = Array.from(this.labelTr.children).slice(1).map(t => t.children[0].innerText)\n        XLSX.utils.sheet_add_aoa(ws1, [labels], {origin: 0})\n        ws1['!cols'] = Array.from(this.labelTr.children).slice(1).map((t) => {\n          return {\n            width: t.getBoundingClientRect().width / 6.5\n          }\n        })\n        XLSX.utils.book_append_sheet(wb, ws1, 'Sheet1')\n        switch (format) {\n          case 'excel':\n            XLSX.writeFile(wb, 'export.xlsx')\n            break\n          case 'csv':\n            XLSX.writeFile(wb, 'export.csv')\n            break\n        }\n        this.processing = false\n      }, 500)\n    },\n    selectAllClick () {\n      this.toggleSelectAllRecords()\n    },\n    reviseSelectedAfterTableChange () {\n      this.rowIndex = {}\n      this.table.forEach((rec, i) => (this.rowIndex[rec.$id] = i))\n      const temp = Object.assign(this.selected)\n      this.selected = {}\n      Object.keys(temp).forEach((p) => {\n        const id = temp[p]\n        if (typeof this.rowIndex[id] !== 'undefined')\n          this.selected[this.rowIndex[id]] = id\n      })\n      this.selectedCount = Object.keys(this.selected).length\n    },\n    toggleSelectRecord (rowPos) {\n      if (typeof this.selected[rowPos] !== 'undefined') this.unSelectRecord(rowPos)\n      else this.selectRecord(rowPos)\n    },\n    selectRecord (rowPos) {\n      if (typeof this.selected[rowPos] === 'undefined') {\n        this.selectedCount++\n        this.selected[rowPos] = this.table[rowPos].$id\n        if (this.recordBody.children[rowPos - this.pageTop])\n          this.recordBody.children[rowPos - this.pageTop].classList.add('select')\n        this.lazy(rowPos, (buf) => {\n          this.$emit('select', buf, true)\n        })\n      }\n    },\n    unSelectRecord (rowPos) {\n      if (typeof this.selected[rowPos] !== 'undefined') {\n        delete this.selected[rowPos]\n        this.selectedCount--\n        if (this.recordBody.children[rowPos - this.pageTop])\n          this.recordBody.children[rowPos - this.pageTop].classList.remove('select')\n        this.lazy(rowPos, (buf) => {\n          this.$emit('select', buf, false)\n        })\n      }\n    },\n    toggleSelectAllRecords (e) {\n      if (e) e.preventDefault()\n      if (this.selectedCount === this.table.length) {\n        for (let i = 0; i < this.table.length; i++)\n          this.unSelectRecord(i)\n        this.selectedCount = 0\n      }\n      else {\n        for (let i = 0; i < this.table.length; i++)\n          this.selectRecord(i)\n        this.selectedCount = this.table.length\n      }\n    },\n    clearAllSelected () {\n      // for (let i = 0; i < this.$refs.systable.children[2].children.length; i++)\n      //  this.unSelectRecord(this.pageTop + i)\n      this.selected = {}\n      this.selectedCount = 0\n    },\n    undoTransaction (e) {\n      if (e) e.preventDefault()\n      if (this.redo.length === 0) return\n      const transaction = this.redo.pop()\n      transaction.forEach((rec) => {\n        this.updateCell(this.rowIndex[rec.$id], rec.field, rec.oldVal, true)\n      })\n    },\n    updateCellByColPos (recPos, colPos, content) {\n      return this.updateCell(recPos, this.fields[colPos], content)\n    },\n    updateCellByName (recPos, name, content) {\n      return this.updateCell(recPos, this.fields.find(f => f.name === name), content)\n    },\n    updateCell (recPos, field, content, restore) {\n      const tableRow = this.table[recPos]\n      const oldVal = tableRow[field.name]\n      const oldKeys = this.getKeys(tableRow)\n      tableRow[field.name] = content\n\n      setTimeout(() => {\n        const transaction = {\n          $id: tableRow.$id,\n          keys: this.getKeys(tableRow),\n          oldKeys: oldKeys,\n          name: field.name,\n          field: field,\n          oldVal: oldVal,\n          newVal: content,\n          err: ''\n        }\n\n        const id = `id-${tableRow.$id}-${field.name}`\n        if (field.validate !== null) transaction.err = field.validate(content)\n        if (field.mandatory && content === '')\n          transaction.err += (transaction.err ? '\\n' : '') + field.mandatory\n\n        if (transaction.err !== '') {\n          this.errmsg[id] = transaction.err\n          this.systable.querySelector('td#'+id).classList.add('error')\n        }\n        else delete this.errmsg[id]\n\n        this.lazy(transaction, (buf) => {\n          this.$emit('update', buf)\n          if (!restore) this.redo.push(buf)\n        }, 50)\n      })\n    },\n    updateSelectedRows (field, content) {\n      this.processing = true\n      setTimeout(() => {\n        Object.keys(this.selected).forEach(recPos => this.updateCell(recPos, field, content))\n        this.processing = false\n      }, 0)\n    },\n    moveTo (rowPos, colPos) {\n      colPos = colPos || 0\n      this.moveInputSquare(rowPos, colPos)\n    },\n    moveWest () {\n      if (this.focused && this.currentColPos > 0) {\n        let goColPos = this.currentColPos - 1\n        while (this.fields[goColPos].invisible && goColPos >= 0) goColPos--\n        if (goColPos === -1) return\n        this.moveInputSquare(this.currentRowPos, goColPos)\n      }\n    },\n    moveEast () {\n      if (this.focused && this.currentColPos < this.fields.length - 1) {\n        let goColPos = this.currentColPos + 1\n        while (this.fields[goColPos].invisible && goColPos < this.fields.length - 1) goColPos++\n        if (goColPos === this.fields.length) return\n        this.moveInputSquare(this.currentRowPos, goColPos)\n      }\n    },\n    moveNorth () {\n      if (this.focused) {\n        this.moveInputSquare(this.currentRowPos - 1, this.currentColPos)\n        this.calVScroll()\n        this.$refs.vScrollButton.classList.add('focus')\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n      }\n    },\n    moveSouth () {\n      if (this.focused && this.currentRowPos < this.table.length) {\n        const done = this.moveInputSquare(this.currentRowPos + 1, this.currentColPos)\n        this.calVScroll()\n        this.$refs.vScrollButton.classList.add('focus')\n        this.lazy(() => this.$refs.vScrollButton.classList.remove('focus'), 1000)\n        return done\n      }\n      return false\n    },\n    mouseDown (e) {\n      if (e.target.parentNode.parentNode.tagName === 'TBODY' && !e.target.classList.contains('first-col')) {\n        e.preventDefault()\n        setTimeout(() => this.inputBox.focus())\n        this.focused = true\n        const row = e.target.parentNode\n        const colPos = Array.from(row.children).indexOf(e.target) - 1\n        const rowPos = Array.from(row.parentNode.children).indexOf(row)\n        this.moveInputSquare(rowPos, colPos)\n        if (e.target.offsetWidth - e.offsetX > 15) return\n        if (e.target.classList.contains('select')) this.calAutocompleteList(true)\n        if (e.target.classList.contains('datepick')) this.showDatePickerDiv()\n      }\n    },\n    cellMouseMove (e) {\n      let cursor = 'cell'\n      if (this.inputBoxShow) cursor = 'default'\n      if (!e.target.classList.contains('readonly')\n        && (e.target.classList.contains('select') || e.target.classList.contains('datepick'))\n        && e.target.offsetWidth - e.offsetX < 15)\n        cursor = 'pointer'\n      e.target.style.cursor = cursor\n    },\n    cellMouseOver (e) {\n      const cell = e.target\n      if (!cell.classList.contains('error')) return\n      if (this.tipTimeout) clearTimeout(this.tipTimeout)\n      if ((this.tip = this.errmsg[cell.getAttribute('id')]) === '') return\n      const rect = cell.getBoundingClientRect()\n      this.$refs.tooltip.style.top = (rect.top - 14) + 'px';\n      this.$refs.tooltip.style.left = (rect.right + 8) + 'px'\n      cell.addEventListener('mouseout', this.cellMouseOut)\n    },\n    cellMouseOut (e) {\n      this.tipTimeout = setTimeout(() => {\n        this.tip = ''\n      }, 1000)\n      e.target.removeEventListener(e.type, this.cellMouseOut)\n    },\n    mouseOver () {\n      this.mousein = true\n    },\n    mouseOut () {\n      this.mousein = false\n    },\n    inputSquareClick () {\n      if (!this.currentField.readonly && !this.inputBoxShow && this.currentField.type !== 'select') {\n        this.inputBox.value = this.currentCell.innerText\n        this.inputBoxShow = 1\n        this.inputBox.focus()\n        this.inputBoxChanged = false\n        this.focused = true\n      }\n    },\n    inputBoxMouseMove (e) {\n      let cursor = 'text'\n      if (!this.currentField.readonly\n        && (this.currentField.options.length || this.currentField.type === 'date')\n        && e.target.offsetWidth - e.offsetX < 15)\n        cursor = 'pointer'\n      e.target.style.cursor = cursor\n    },\n    inputBoxMouseDown (e) {\n      if (e.target.offsetWidth - e.offsetX > 15) return\n      if (this.currentField.options.length) {\n        e.preventDefault()\n        this.calAutocompleteList(true)\n      }\n      if (this.currentField.type === 'date') {\n        e.preventDefault()\n        this.showDatePickerDiv()\n      }\n    },\n    calAutocompleteList (force) {\n      if (!force && !this.currentField.autocomplete) return\n      if (force || (this.inputBoxChanged && this.inputBox.value.length > 0)) {\n        if (typeof this.recalAutoCompleteList !== 'undefined') clearTimeout(this.recalAutoCompleteList)\n        this.recalAutoCompleteList = setTimeout(() => {\n          if (!force) {\n            if (!this.focused || !this.inputBoxShow || !this.inputBoxChanged || !this.inputBox.value.length) {\n              this.autocompleteInputs = []\n              return\n            }\n          }\n          const field = this.currentField\n          const name = field.name\n          const value = force ? '' : this.inputBox.value\n          let list\n          if (field.options.length > 0) {\n            list = this.currentField.options\n          }\n          else {\n            list = []\n            for(let i=0; i<this.table.length; i++) {\n              const rec = this.table[i]\n              if (typeof rec[name] !== 'undefined' && rec[name].startsWith(value) && list.indexOf(rec[name]) === -1)\n                list.push(rec[name])\n              if (list.length >= 10) break\n            }\n            list.sort()\n          }\n          this.autocompleteSelect = -1\n          this.autocompleteInputs = list\n          const rect = this.currentCell.getBoundingClientRect()\n          this.$refs.autocomplete.style.top = rect.bottom + 'px'\n          this.$refs.autocomplete.style.left = rect.left + 'px'\n          this.$refs.autocomplete.style.minWidth = rect.width + 'px'\n          this.lazy(() => {\n            const r = this.$refs.autocomplete.getBoundingClientRect()\n            if (r.bottom > window.innerHeight)\n              this.$refs.autocomplete.style.top = (rect.top - r.height) + 'px'\n            if (r.right > window.innerWidth)\n              this.$refs.autocomplete.style.top = (window.innerWidth - r.width) + 'px'\n          })\n        }, force ? 0 : 700)\n      }\n    },\n    inputAutocompleteText (text, e) {\n      if (e) e.preventDefault()\n      setTimeout(() => {\n        this.inputCellWrite(text)\n        this.autocompleteInputs = []\n        this.autocompleteSelect = -1\n        this.inputBoxShow = 0\n        this.inputBoxChanged = false\n      })\n    },\n    inputCellWrite (setText, colPos, recPos) {\n      let field = this.currentField\n      if (typeof colPos !== 'undefined') field = this.fields[colPos]\n      if (typeof recPos === 'undefined') recPos = this.pageTop + this.currentRowPos\n      if (typeof this.selected[recPos] !== 'undefined')\n        this.updateSelectedRows(field, setText)\n      else\n        this.updateCell(recPos, field, setText)\n    },\n    inputBoxBlur () {\n      if (this.$refs.dpContainer.querySelector(':hover')) return\n      if (this.inputBoxChanged) {\n        this.inputCellWrite(this.inputBox.value)\n        this.inputBoxChanged = false\n      }\n      this.inputBoxShow = 0\n      this.focused = false\n      this.showDatePicker = false\n      if (this.currentRowPos !== -1) {\n        this.recordBody.children[this.currentRowPos].children[0].classList.remove('focus')\n        this.labelTr.children[this.currentColPos + 1].classList.remove('focus')\n      }\n    },\n    hashCode (s) {\n      return s.split('').reduce((a, b) => {\n        return a = ((a << 5) - a) + b.charCodeAt(0) | 0\n      }, 0)\n    },\n    lazy (p, delay, p1) {\n      if (typeof p !== 'function') return this.lazyBuf(p, delay, p1)\n      if (!delay) delay = 20\n      const hash = this.hashCode(p.name + p.toString())\n      if (this.lazyTimeout[hash]) clearTimeout(this.lazyTimeout[hash])\n      this.lazyTimeout[hash] = setTimeout(() => {\n        p()\n        delete this.lazyTimeout[hash]\n      }, delay)\n    },\n    lazyBuf (item, p, delay) {\n      if (!delay) delay = 20\n      const hash = this.hashCode(p.name + p.toString())\n      if (this.lazyBuffer[hash])\n        this.lazyBuffer[hash].push(item)\n      else\n        this.lazyBuffer[hash] = [item]\n\n      if (this.lazyTimeout[hash]) clearTimeout(this.lazyTimeout[hash])\n      this.lazyTimeout[hash] = setTimeout(() => {\n        p(this.lazyBuffer[hash])\n        delete this.lazyTimeout[hash]\n        delete this.lazyBuffer[hash]\n      }, delay)\n    }\n    /*\n    selStart (target) {\n      this.selTarget = target\n      this.selx = Array.from(target.parentNode.children).indexOf(target) - 1\n      this.sely = target.parentNode.getAttribute('pos')\n    },\n    selProcess (target) {\n      if (target === null) return\n      // const x = Array.from(target.parentNode.children).indexOf(target) - 1\n      // const y = target.parentNode.getAttribute('pos')\n      this.selEnd(target)\n    },\n    selEnd (target) {\n      if (target !== null && target !== this.selTarget) {\n        const st = this.selTarget.getBoundingClientRect()\n        const ed = target.getBoundingClientRect()\n\n        if (this.selSquare === null) {\n          this.selSquare = document.createElement('div')\n          document.body.appendChild(this.selSquare)\n        }\n\n        const left = Math.min(st.left, ed.left) - 1\n        const top = Math.min(st.top, ed.top) - 1\n        const width = Math.max(ed.right - st.left, st.right - ed.left) + 2\n        const height = Math.max(ed.bottom - st.top, st.bottom - ed.top) + 2\n\n        this.selSquare.setAttribute('style', `\n          left: ${left}px;\n          top: ${top}px;\n          width: ${width}px;\n          height: ${height}px;\n          position: absolute;\n          border: 2px solid #999966;\n          'z-index': 1000;\n          background-color: #35456755;\n          display: block;\n          pointer-events: none;\n        `)\n      }\n    }\n    */\n  }\n}\n</script>\n\n<style scoped>\ninput:focus, input:active:focus, input.active:focus {\n  outline: none;\n  box-shadow: inset 0 -1px 0 #ddd;\n}\n*, *::before, *::after {\n  box-sizing: border-box;\n}\n.input-square {\n  position: absolute;\n  padding: 0;\n  z-index: 4;\n  border: 2px solid rgb(108, 143, 108);\n  /* transition: all 0.04s linear; */\n}\n.no-transition {\n  transition: none !important;\n}\n.autocomplete-results {\n  z-index: 15;\n  position: fixed;\n  padding: 3px;\n  margin: -1px;\n  background-color: lightyellow;\n  border: 1px solid rgb(108, 143, 108);\n  height: fit-content;\n  font-size: 0.88rem;\n  max-width: 300px;\n}\n.autocomplete-result {\n  list-style: none;\n  text-align: left;\n  padding: 4px 2px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  cursor: pointer\n}\n.autocomplete-result.select {\n  background-color: lightsteelblue;\n}\n.rb-square {\n  width: 9px;\n  height: 9px;\n  border-top: 2px solid white;\n  border-left: 2px solid white;\n  border-bottom: 0;\n  border-right: 0;\n  background-color:rgb(108, 143, 108);\n  position: absolute;\n  bottom: -3px;\n  right: -2px;\n  cursor: crosshair;\n}\n.input-box {\n  opacity: 0;\n  font-family: inherit;\n  color: inherit;\n  text-shadow: inherit;\n  font-size: 0.88rem;\n  width: 100%;\n  height: 100%;\n  border: 0;\n  resize: none;\n  white-space: nowrap;\n  overflow: hidden;\n  background: white;\n}\n.component-content {\n  display: flex;\n  flex-flow: column;\n  position: relative;\n  max-width:fit-content;\n  word-spacing: 0.02rem;\n  line-height: 1.1;\n  overflow: hidden;\n  border: 1px solid lightgray;\n}\n.center-text {\n  text-align: center;\n}\n.table-content {\n  flex: 1 1 auto;\n  font-size: 1rem;\n  text-shadow: 0.3px 0.3px 1px #ccc;\n  overflow: scroll;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  position: relative;\n  width: 100%;\n  scrollbar-width: none;\n}\n.table-content :focus {\n  outline: none;\n}\n.table-content::-webkit-scrollbar {\n  background: white;\n  width: 0;\n  height: 0;\n}\n.table-content.no-footer {\n  border-bottom: 0;\n}\n.table-content.no-footer::-webkit-scrollbar {\n  height: 0;\n}\n.table-content::-webkit-scrollbar-thumb {\n  background: #eeee;\n}\n.table-content::-webkit-scrollbar-thumb:hover {\n  background: #9999;\n}\n.systable {\n  z-index: -1;\n  width: fit-content;\n  border: 0;\n  border-collapse: separate;\n  border-spacing: 0;\n  margin-bottom: 0;\n  /* margin-left: 40px; */\n}\n.systable .last-col {\n  width: 12px;\n}\n.systable.no-number {\n  margin-left: 0 !important;\n}\n.systable tbody tr {\n  background-color: white;\n  text-align: left;\n}\n.systable tr.select td {\n  background-color: darkgrey !important;\n}\n.systable th, .systable td {\n  vertical-align: bottom;\n  padding: 0.2rem 0.3rem;\n  font-size: 0.88rem;\n  height: 24px;\n  border-top: 0;\n  border-left: 0;\n}\n.systable th:not(:last-child) {\n  border-right: 1px solid lightgray;\n}\n.systable tbody td {\n  cursor: cell;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  /* animation: fadein 0.2s; */\n}\n.systable tbody td.error {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAAAGZJREFUOBGlzjsOgDAMA9CwcQSO0PtP3K64Qyugv8S2ZMXTUw5DstmFk8qWAuhEbzSzbQ+oWIPKULAPpGAdxGJDiMGmUBRbQhFsC3kxF+TB3NAOC0ErLAzNMAoaYTT0xyTojclQxR5H5B1HhuS+WAAAAABJRU5ErkJggg==');\n  background-repeat: no-repeat;\n  background-size: 8px 8px;\n  background-position: right 0px top 0px;\n}\n.systable tbody tr:not(:last-child) td {\n  border-bottom: 1px solid lightgray;\n}\n.systable td:not(:last-child) {\n  border-right: 1px solid lightgray;\n}\n.systable thead th, .systable thead td {\n  padding: 0.4rem 0.3rem;\n  font-weight: 400;\n  top: 0;\n  height: 29px;\n  position: sticky;\n  z-index: 5;\n  border-bottom: 1px solid lightgray;\n}\n.systable thead th {\n  background-color: #e9ecef !important;\n  cursor: s-resize;\n  z-index: 6;\n}\n.systable thead td.column-filter {\n  text-align: left;\n  background-color: #fffff2;\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n}\n.systable th.focus {\n  border-bottom: 1px solid rgb(61, 85, 61) !important;\n}\n.systable td.first-col.focus {\n  border-right: 1px solid rgb(61, 85, 61) !important;\n}\n.systable tbody td.select:not(.readonly) {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC');\n  background-repeat: no-repeat;\n  background-size: 8px 8px;\n  background-position: right 5px top 8px;\n}\n.systable tbody td.datepick:not(.readonly) {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAASUExURQAAANra2tfX19ra2tnZ2dnZ2c8lDs8AAAAFdFJOUwAwQL/PKlwehgAAAAlwSFlzAAAXEQAAFxEByibzPwAAAEdJREFUKFNdyskBACAIA8F49d+yiBEh+9rHYC5poPGiDmUDUGZI2EHCHBV2UWFEiT2UWKBgHwVLiCwjsoKcVeRMkDFFxoiADdH4AyvGhvOPAAAAAElFTkSuQmCC');\n  background-repeat: no-repeat;\n  background-size: 8px 8px;\n  background-position: right 5px top 8px;\n}\n.systable .first-col {\n  background:#e9ecef;\n  width: 40px;\n  position: sticky;\n  left: 0;\n  top: auto;\n  cursor: e-resize !important;\n  text-overflow: inherit !important;\n  text-align: center;\n  overflow: hidden;\n  z-index: 5;\n}\n.systable .sticky-column {\n  position: sticky;\n  z-index: 2;\n  background-color: white;\n}\n.systable thead th.sticky-column {\n  z-index: 7;\n}\n.systable thead td.sticky-column {\n  z-index: 6;\n}\n.systable thead .tl-setting {\n  /*\n  display: flex;\n  flex-direction: column-reverse;\n  height: 100%;\n  */\n}\n.systable thead td.first-col, .systable thead th.first-col {\n  cursor: pointer !important;\n  z-index: 10;\n}\n.systable tfoot .row-summary {\n  height: 25px;\n  border-right: 0;\n  border-top: 1px solid lightgray;\n  position: sticky;\n  bottom: 0;\n  z-index: 4;\n  background: #fffff2;\n}\n.systable tfoot .row-summary.sticky-column {\n  z-index: 5;\n}\n.systable tfoot .row-summary.summary-column1 {\n  border-right: 1px solid lightgray;\n}\n.systable tfoot .row-summary.summary-column2 {\n  border-right: 1px solid lightgray;\n  background: white;\n}\n.systable tfoot .row-summary:last-child {\n  border-right: 0 !important;\n}\n.systable tfoot .row-summary.first-col {\n  height: 25px;\n  border-top: 1px solid lightgray;\n  border-right: 1px solid lightgray;\n  background: #e9ecef;\n  position: sticky;\n  left: 0;\n  top: auto;\n  z-index: 6;\n}\n.footer {\n  z-index: 5;\n  padding: 0;\n  font-size: 12px;\n  color: dimgray;\n  background-color: white;\n  width: 100%;\n  height: 25px;\n  line-height: 2.3;\n  border-top: 1px solid lightgray;\n  user-select: none;\n}\n.footer .left-block {\n  position: absolute;\n  left: 0;\n  height: 25px;\n  width: 40px;\n  background-color: #e9ecef;\n  border-right: 1px solid lightgray;\n}\n.h-scroll {\n  z-index: -1;\n  position: absolute;\n  background-color: #f4f6f9;\n  height: 25px;\n  margin-left: 40px;\n  width: 65%;\n  cursor: pointer;\n}\n.h-scroll:hover, .h-scroll.focus, .footer:hover .h-scroll {\n  background-color: lightgray;\n}\n\n.footer a {\n  cursor: pointer;\n  color: #007bff;\n}\n.footer a.disabled {\n  cursor: not-allowed;\n  color: gray;\n  pointer-events: none;\n}\n.footer a:hover {\n  text-decoration: underline;\n}\n.v-scroll {\n  display: inline-block;\n  position: absolute;\n  right: 0;\n  width: 13px;\n  z-index: 5;\n  background-color: white;\n  border-left: 1px solid lightgray;\n  user-select: none;\n}\n.v-scroll-button {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  z-index: 10;\n  background-color: #f4f6f9;\n  cursor: pointer;\n}\n.v-scroll-button.focus, .v-scroll-button:hover, .v-scroll:hover .v-scroll-button {\n  background-color: lightgray;\n}\n.runner {\n  font-size: 0.88rem;\n  padding: 0.5rem;\n  position: absolute;\n  right: 23px;\n  top: 4px;\n  display: inline-block;\n  width: fit-content;\n  z-index: 10;\n  background-color: lightsteelblue;\n  border-radius: 3px;\n  white-space: nowrap;\n}\n.runner:before {\n  content: '';\n  display: block;\n  width: 0;\n  height: 0;\n  position: absolute;\n  border-top: 4px solid transparent;\n  border-bottom: 8px solid transparent;\n  border-left: 8px solid lightsteelblue;\n  right: -8px;\n  top: 4px;\n}\n\n.front-drop {\n  position: fixed;\n  opacity: 0.4;\n  display:flex;\n  justify-content:center;\n  align-items:center;\n  background-color: #55555555;\n  color: white;\n  z-index: 1000;\n}\na:disabled {\n  cursor: not-allowed;\n  color: gray;\n  pointer-events: none;\n}\n.col-sep {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 5px;\n  cursor: col-resize;\n  height: 100%;\n  z-index: 15;\n}\n.sort-asc-sign {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAMAAADzN3VRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAeUExURQAAAK+np6+qqq+rq62pqa+rq6+rq6+srK+rq6+rq2v5ERwAAAAJdFJOUwAgYHCAv8/f71KXockAAAAJcEhZcwAAFxEAABcRAcom8z8AAABNSURBVChT7clRAoAgCATRtTLq/hcuBEN0j9B8zoNV76j6s37hsh+a+NWknQ3l8pGTAk4KlAwIdVgoYKIREmUYaIaPVnBi0IjDS2cA8AC8JAq/VhDqzAAAAABJRU5ErkJggg==');\n  background-repeat: no-repeat;\n  background-size: 9px 9px;\n  background-position: right 5px top 5px;\n}\n.sort-des-sign {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAYCAMAAAA4a6b0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAkUExURQAAAK+np6+qqq+rq6+pqa+qqq+rq6+rq6+rq6+srK+rq6+rqzDc2iQAAAALdFJOUwAgMEBQYHC/z9/v4u0IugAAAAlwSFlzAAAXEQAAFxEByibzPwAAAFVJREFUKFPtyVEWgCAIRFHC1HL2v98o53SEWELvC+bK0nYor5CeGCkZICUdBhkRjAoX9oLlqCzgyAOwc5caAKgT2gdIGQDNgGfM6Knzv+vcZr8kInIBUrIMxVKQeVsAAAAASUVORK5CYII=');\n  background-repeat: no-repeat;\n  background-size: 9px 9px;\n  background-position: right 5px top 5px;\n}\n.filter-sign {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAlCAMAAABiU6n+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAhUExURQAAAK+vr6+np6+qqq+pqa+qqq2pqa+srK+srK+rq6+rq01/tHwAAAAKdFJOUwAQIDBQYICv3+8SoWj4AAAACXBIWXMAABcRAAAXEQHKJvM/AAAAiUlEQVQ4T+3OOxaAMAhEUfwmsv8FazLjMRBiZ+er4ExzJelLSSZeUccisvMO2uUq8+nKU5lXfl1bWWWkS1gHuuJCoa66UKCDCwU6ulCnu13I6x4XcrrGhYyudSGjMy7U6KwLPTrvQhwDV42jaueqcVTl7+L4zzaO386Zv+teZ/6u9xXzcK2zXUVOdLIT4IImCksAAAAASUVORK5CYII=');\n  background-repeat: no-repeat;\n  background-size: 9px 9px;\n  background-position: right 0px bottom 0px;\n}\n.hide {\n  display: none !important;\n}\n@keyframes fadein {\n  from {opacity: 0}\n  to {opacity: 1}\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n  animation: fa-spin 2s infinite linear;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n.fa-xs {\n  font-size: 0.75em;\n}\n.fa-sm {\n  font-size: 0.875em;\n}\n.fa-3x {\n  font-size: 3em;\n}\n.tool-tip {\n  display: inline-block;\n  position: fixed;\n  color: white;\n  background-color: red;\n  padding: 0.5rem;\n  min-height: 1rem;\n  max-width: 200px;\n  word-wrap: break-word;\n  border-radius: 4px;\n  z-index: 50;\n}\n.tool-tip:before {\n  content: '';\n  display: block;\n  width: 0;\n  height: 0;\n  position: absolute;\n  border-top: 8px solid transparent;\n  border-bottom: 8px solid transparent;\n  border-right: 8px solid red;\n  left: -8px;\n  top: 8px;\n}\n</style>\n"]},media:void 0})},Zt,"data-v-b8884846",!1,void 0,!1,o,void 0,void 0);/* scoped */ //
var ll={props:{field:{type:String,default:""},label:{type:String,default:null},type:{type:String,default:"string"},validate:{type:Function,default:null},initStyle:{type:Object,default(){return{}}},width:{type:String,default:"100px"},invisible:{type:Boolean,default:!1},readonly:{type:Boolean,default:null},textTransform:{type:String,default:null},// replace uppercase prop
textAlign:{type:String,default:null},keyField:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},allowKeys:{type:Array,default(){return null}},mandatory:{type:Boolean,default:!1},lengthLimit:{type:Number,default:0},autocomplete:{type:Boolean,default:null},pos:{type:Number,default:0},options:{type:Array,default(){return[]}},summary:{type:String,default:null},toValue:{type:Function,default(e){switch(this.textTransform){case"uppercase":e=e.toUpperCase();break;case"lowercase":e=e.toLowerCase();}switch(this.type){case"datetick":return i(e,"YY-MM-DD").valueOf();case"datetimetick":return i(e,"YY-MM-DD HH:mm").valueOf();case"datetimesectick":return i(e,"YY-MM-DD HH:mm:ss").valueOf();case"check10":case"checkYN":case"checkTF":return e.toUpperCase();default:return e;}}},toText:{type:Function,default(e){//  magic to hide the temp key
if(this.keyField&&e&&e.startsWith("\xA7"))return"";switch(this.type){case"datetick":return i(+e).format("YY-MM-DD");case"datetimetick":return i(+e).format("YY-MM-DD HH:mm");case"datetimesectick":return i(+e).format("YY-MM-DD HH:mm:ss");default:return e;}}}},created(){let e=this.initStyle,t=this.validate,l=this.allowKeys,a=this.lengthLimit;switch(this.type){case"number":e.textAlign="right",l=l||["0","1","2","3","4","5","6","7","8","9",".","-"];break;case"date":l=l||["0","1","2","3","4","5","6","7","8","9","-"],t||(t=e=>i(e,"YYYY-MM-DD",!0).isValid()?"":this.$parent.localizedLabel.invalidInputValue);break;case"datetime":l=l||["0","1","2","3","4","5","6","7","8","9","-"," ",":"],t||(t=e=>i(e,"YY-MM-DD hh:mm",!0).isValid()?"":this.$parent.localizedLabel.invalidInputValue);break;case"datetimesec":l=l||["0","1","2","3","4","5","6","7","8","9","-"," ",":"],t||(t=e=>i(e,"YY-MM-DD hh:mm:ss",!0).isValid()?"":this.$parent.localizedLabel.invalidInputValue);break;case"datetick":l=l||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"datetimetick":l=l||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"datetimesectick":l=l||["0","1","2","3","4","5","6","7","8","9","-"," ",":"];break;case"check10":e.textAlign="center",e.textTransform="uppercase",l=l||["0","1"],a=a||1;break;case"checkYN":e.textAlign="center",e.textTransform="uppercase",l=l||["Y","N"],a=a||1;break;case"checkTF":e.textAlign="center",e.textTransform="uppercase",l=l||["T","F"],a=a||1;break;case"select":case"string":break;default:throw new Error("VueExcelColumn: Not supported type:"+this.type);}this.textTransform&&(e.textTransform=this.textTransform),this.textAlign&&(e.textAlign=this.textAlign),this.readonly&&this.$parent.readonlyStyle&&(e=Object.assign(e,this.$parent.readonlyStyle)),this.$parent.registerColumn({name:this.field,label:null===this.label?this.field:this.label,type:this.type,width:this.width,validate:t,keyField:this.keyField,sticky:this.sticky,allowKeys:l,mandatory:this.mandatory,lengthLimit:+a,autocomplete:null===this.autocomplete?this.$parent.autocomplete:this.autocomplete,initStyle:e,invisible:this.invisible,readonly:null===this.readonly?this.$parent.readonly:this.readonly,pos:+this.pos,options:this.options,summary:this.summary,toValue:this.toValue,toText:this.toText})}};/* script */ /* template */var il=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div")};il._withStripped=!0;/* style */const al=a({render:il,staticRenderFns:[]},void 0,ll,void 0,!1,void 0,!1,void 0,void 0,void 0);/* scoped */ // index.js
var ol={install(e){e.component("vue-excel-editor",tl),e.component("vue-excel-column",al),e.mixin({created(){// do something you like
}})}};e.default=ol,Object.defineProperty(e,"__esModule",{value:!0})});
